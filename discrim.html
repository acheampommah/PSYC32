<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Discrimimant Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="discrim_files/libs/clipboard/clipboard.min.js"></script>
<script src="discrim_files/libs/quarto-html/quarto.js"></script>
<script src="discrim_files/libs/quarto-html/popper.min.js"></script>
<script src="discrim_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="discrim_files/libs/quarto-html/anchor.min.js"></script>
<link href="discrim_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="discrim_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="discrim_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="discrim_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="discrim_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="discrim.html"><i class="bi bi-file-slides"></i>RevealJS</a></li><li><a href="discrim.pdf"><i class="bi bi-file-pdf"></i>Beamer</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Discrimimant Analysis</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="discriminant-analysis" class="level2">
<h2 class="anchored" data-anchor-id="discriminant-analysis">Discriminant analysis</h2>
<ul>
<li><p>ANOVA and MANOVA: predict a (counted/measured) response from group membership.</p></li>
<li><p>Discriminant analysis: predict group membership based on counted/measured variables.</p></li>
<li><p>Covers same ground as logistic regression (and its variations), but emphasis on classifying observed data into correct groups.</p></li>
<li><p>Does so by searching for linear combination of original variables that best separates data into groups (canonical variables).</p></li>
<li><p>Assumption here that groups are known (for data we have). If trying to “best separate” data into unknown groups, see <em>cluster analysis</em>.</p></li>
</ul>
</section>
<section id="packages" class="level2">
<h2 class="anchored" data-anchor-id="packages">Packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggbiplot)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MVTests) <span class="co"># for Box M test</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(conflicted)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">"arrange"</span>, <span class="st">"dplyr"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">"summarize"</span>, <span class="st">"dplyr"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">"select"</span>, <span class="st">"dplyr"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">"filter"</span>, <span class="st">"dplyr"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">conflict_prefer</span>(<span class="st">"mutate"</span>, <span class="st">"dplyr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>ggrepel</code> allows labelling points on a plot so they don’t overwrite each other.</li>
<li><code>ggbiplot</code> uses <code>plyr</code> rather than <code>dplyr</code>, which has functions by similar names.</li>
</ul>
</section>
<section id="about-select" class="level2">
<h2 class="anchored" data-anchor-id="about-select">About <code>select</code></h2>
<ul>
<li><p>Both <code>dplyr</code> (in <code>tidyverse</code>) and <code>MASS</code> have a function called <code>select</code>, and <em>they do different things</em>.</p></li>
<li><p>How do you know which <code>select</code> is going to get called?</p></li>
<li><p>With <code>library</code>, the one loaded <em>last</em> is visible, and others are not.</p></li>
<li><p>Thus we can access the <code>select</code> in <code>dplyr</code> but not the one in <code>MASS</code>. If we wanted that one, we’d have to say <code>MASS::select</code>.</p></li>
<li><p>Better: load <code>conflicted</code> package. Any time you load two packages containing functions with same name, you get error and have to choose between them.</p></li>
</ul>
</section>
<section id="example-1-seed-yields-and-weights" class="level2">
<h2 class="anchored" data-anchor-id="example-1-seed-yields-and-weights">Example 1: seed yields and weights</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/manova1.txt"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>hilo <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(my_url, <span class="st">" "</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(hilo, <span class="fu">aes</span>(<span class="at">x =</span> yield, <span class="at">y =</span> weight,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">colour =</span> fertilizer)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:40%;">
<p>Recall data from MANOVA: needed a multivariate analysis to find difference in seed yield and weight based on whether they were high or low fertilizer.</p>
</div><div class="column" style="width:60%;">
<div class="cell">
<div class="cell-output-display">
<p><img src="discrim_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="basic-discriminant-analysis" class="level2">
<h2 class="anchored" data-anchor-id="basic-discriminant-analysis">Basic discriminant analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>hilo<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lda</span>(fertilizer <span class="sc">~</span> yield <span class="sc">+</span> weight, <span class="at">data =</span> hilo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>Uses <code>lda</code> from package MASS.</p></li>
<li><p>“Predicting” group membership from measured variables.</p></li>
</ul>
</section>
<section id="output" class="level2">
<h2 class="anchored" data-anchor-id="output">Output</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>hilo<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lda(fertilizer ~ yield + weight, data = hilo)

Prior probabilities of groups:
high  low 
 0.5  0.5 

Group means:
     yield weight
high  35.0  13.25
low   32.5  12.00

Coefficients of linear discriminants:
              LD1
yield  -0.7666761
weight -1.2513563</code></pre>
</div>
</div>
</section>
<section id="things-to-take-from-output" class="level2">
<h2 class="anchored" data-anchor-id="things-to-take-from-output">Things to take from output</h2>
<ul>
<li><p>Group means: high-fertilizer plants have (slightly) higher mean yield and weight than low-fertilizer plants.</p></li>
<li><p>“Coefficients of linear discriminants”: are scores constructed from observed variables that best separate the groups.</p></li>
<li><p>For any plant, get LD1 score by taking <span class="math inline">\(-0.76\)</span> times yield plus <span class="math inline">\(-1.25\)</span> times weight, add up, standardize.</p></li>
<li><p>the LD1 coefficients are like slopes:</p>
<ul>
<li>if yield higher, LD1 score for a plant lower</li>
<li>if weight higher, LD1 score for a plant lower</li>
</ul></li>
<li><p>High-fertilizer plants have higher yield and weight, thus low (negative) LD1 score. Low-fertilizer plants have low yield and weight, thus high (positive) LD1 score.</p></li>
<li><p>One LD1 score for each observation. Plot with actual groups.</p></li>
</ul>
</section>
<section id="how-many-linear-discriminants" class="level2">
<h2 class="anchored" data-anchor-id="how-many-linear-discriminants">How many linear discriminants?</h2>
<ul>
<li><p>Smaller of these:</p>
<ul>
<li><p>Number of variables</p></li>
<li><p>Number of groups <em>minus 1</em></p></li>
</ul></li>
<li><p>Seed yield and weight: 2 variables, 2 groups, <span class="math inline">\(\min(2,2-1)=1\)</span>.</p></li>
</ul>
</section>
<section id="getting-ld-scores" class="level2">
<h2 class="anchored" data-anchor-id="getting-ld-scores">Getting LD scores</h2>
<p>Feed output from LDA into <code>predict</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">predict</span>(hilo<span class="fl">.1</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>hilo<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(hilo, p)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>hilo<span class="fl">.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  fertilizer yield weight class posterior.high posterior.low        LD1
1        low    34     10   low   2.108619e-05  9.999789e-01  3.0931414
2        low    29     14   low   1.245320e-03  9.987547e-01  1.9210963
3        low    35     11   low   2.315016e-02  9.768498e-01  1.0751090
4        low    32     13   low   4.579036e-02  9.542096e-01  0.8724245
5       high    33     14  high   9.817958e-01  1.820422e-02 -1.1456079
6       high    38     12  high   9.998195e-01  1.804941e-04 -2.4762756
7       high    34     13  high   9.089278e-01  9.107216e-02 -0.6609276
8       high    35     14  high   9.999109e-01  8.914534e-05 -2.6789600</code></pre>
</div>
</div>
</section>
<section id="ld1-scores-in-order" class="level2">
<h2 class="anchored" data-anchor-id="ld1-scores-in-order">LD1 scores in order</h2>
<p>Most positive LD1 score is most obviously low fertilizer, most negative is most obviously high:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>hilo<span class="fl">.2</span> <span class="sc">%&gt;%</span> <span class="fu">select</span>(fertilizer, yield, weight, LD1) <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(LD1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  fertilizer yield weight        LD1
1        low    34     10  3.0931414
2        low    29     14  1.9210963
3        low    35     11  1.0751090
4        low    32     13  0.8724245
7       high    34     13 -0.6609276
5       high    33     14 -1.1456079
6       high    38     12 -2.4762756
8       high    35     14 -2.6789600</code></pre>
</div>
</div>
<p>High fertilizer have yield and weight high, negative LD1 scores.</p>
</section>
<section id="plotting-ld1-scores" class="level2">
<h2 class="anchored" data-anchor-id="plotting-ld1-scores">Plotting LD1 scores</h2>
<p>With one LD score, plot against (true) groups, eg. boxplot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(hilo<span class="fl">.2</span>, <span class="fu">aes</span>(<span class="at">x =</span> fertilizer, <span class="at">y =</span> LD1)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="discrim_files/figure-html/bDiscrim-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="what-else-is-in-hilo.2" class="level2">
<h2 class="anchored" data-anchor-id="what-else-is-in-hilo.2">What else is in <code>hilo.2</code>?</h2>
<ul>
<li><p><code>class</code>: predicted fertilizer level (based on values of <code>yield</code> and <code>weight</code>).</p></li>
<li><p><code>posterior</code>: predicted probability of being low or high fertilizer given <code>yield</code> and <code>weight</code>.</p></li>
<li><p><code>LD1</code>: scores for (each) linear discriminant (here is only LD1) on each observation.</p></li>
</ul>
</section>
<section id="predictions-and-predicted-groups" class="level2">
<h2 class="anchored" data-anchor-id="predictions-and-predicted-groups">Predictions and predicted groups</h2>
<p>based on <code>yield</code> and <code>weight</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>hilo<span class="fl">.2</span> <span class="sc">%&gt;%</span> <span class="fu">select</span>(yield, weight, fertilizer, class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  yield weight fertilizer class
1    34     10        low   low
2    29     14        low   low
3    35     11        low   low
4    32     13        low   low
5    33     14       high  high
6    38     12       high  high
7    34     13       high  high
8    35     14       high  high</code></pre>
</div>
</div>
</section>
<section id="count-up-correct-and-incorrect-classification" class="level2">
<h2 class="anchored" data-anchor-id="count-up-correct-and-incorrect-classification">Count up correct and incorrect classification</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(hilo<span class="fl">.2</span>, <span class="fu">table</span>(<span class="at">obs =</span> fertilizer, <span class="at">pred =</span> class))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      pred
obs    high low
  high    4   0
  low     0   4</code></pre>
</div>
</div>
<ul>
<li><p>Each predicted fertilizer level is exactly same as observed one (perfect prediction).</p></li>
<li><p>Table shows no errors: all values on top-left to bottom-right diagonal.</p></li>
</ul>
</section>
<section id="posterior-probabilities" class="level2">
<h2 class="anchored" data-anchor-id="posterior-probabilities">Posterior probabilities</h2>
<p>show how clear-cut the classification decisions were:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>hilo<span class="fl">.2</span> <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"posterior"</span>), \(p) <span class="fu">round</span>(p, <span class="dv">4</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>LD1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  fertilizer yield weight class posterior.high posterior.low
1        low    34     10   low         0.0000        1.0000
2        low    29     14   low         0.0012        0.9988
3        low    35     11   low         0.0232        0.9768
4        low    32     13   low         0.0458        0.9542
5       high    33     14  high         0.9818        0.0182
6       high    38     12  high         0.9998        0.0002
7       high    34     13  high         0.9089        0.0911
8       high    35     14  high         0.9999        0.0001</code></pre>
</div>
</div>
<p>Only obs.&nbsp;7 has any doubt: <code>yield</code> low for a high-fertilizer, but high <code>weight</code> makes up for it.</p>
</section>
<section id="example-2-the-peanuts" class="level2">
<h2 class="anchored" data-anchor-id="example-2-the-peanuts">Example 2: the peanuts</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/peanuts.txt"</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>peanuts <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(my_url, <span class="st">" "</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>peanuts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 6
     obs location variety     y   smk     w
   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1     1        1       5  195.  153.  51.4
 2     2        1       5  194.  168.  53.7
 3     3        2       5  190.  140.  55.5
 4     4        2       5  180.  121.  44.4
 5     5        1       6  203   157.  49.8
 6     6        1       6  196.  166   45.8
 7     7        2       6  203.  166.  60.4
 8     8        2       6  198.  162.  54.1
 9     9        1       8  194.  164.  57.8
10    10        1       8  187   165.  58.6
11    11        2       8  202.  167.  65  
12    12        2       8  200   174.  67.2</code></pre>
</div>
</div>
<ul>
<li>Recall: <code>location</code> and <code>variety</code> both significant in MANOVA. Make combo of them (over):</li>
</ul>
</section>
<section id="location-variety-combos" class="level2">
<h2 class="anchored" data-anchor-id="location-variety-combos">Location-variety combos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>peanuts <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">unite</span>(combo, <span class="fu">c</span>(variety, location)) <span class="ot">-&gt;</span> peanuts.combo</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>peanuts.combo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 5
     obs combo     y   smk     w
   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1     1 5_1    195.  153.  51.4
 2     2 5_1    194.  168.  53.7
 3     3 5_2    190.  140.  55.5
 4     4 5_2    180.  121.  44.4
 5     5 6_1    203   157.  49.8
 6     6 6_1    196.  166   45.8
 7     7 6_2    203.  166.  60.4
 8     8 6_2    198.  162.  54.1
 9     9 8_1    194.  164.  57.8
10    10 8_1    187   165.  58.6
11    11 8_2    202.  167.  65  
12    12 8_2    200   174.  67.2</code></pre>
</div>
</div>
</section>
<section id="discriminant-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="discriminant-analysis-1">Discriminant analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>peanuts<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lda</span>(combo <span class="sc">~</span> y <span class="sc">+</span> smk <span class="sc">+</span> w, <span class="at">data =</span> peanuts.combo)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>peanuts<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lda(combo ~ y + smk + w, data = peanuts.combo)

Prior probabilities of groups:
      5_1       5_2       6_1       6_2       8_1       8_2 
0.1666667 0.1666667 0.1666667 0.1666667 0.1666667 0.1666667 

Group means:
         y    smk     w
5_1 194.80 160.40 52.55
5_2 185.05 130.30 49.95
6_1 199.45 161.40 47.80
6_2 200.15 163.95 57.25
8_1 190.25 164.80 58.20
8_2 200.75 170.30 66.10

Coefficients of linear discriminants:
           LD1         LD2         LD3
y    0.4027356  0.02967881  0.18839237
smk  0.1727459 -0.06794271 -0.09386294
w   -0.5792456 -0.16300221  0.07341123

Proportion of trace:
   LD1    LD2    LD3 
0.8424 0.1317 0.0258 </code></pre>
</div>
</div>
</section>
<section id="comments" class="level2">
<h2 class="anchored" data-anchor-id="comments">Comments</h2>
<ul>
<li><p>Now 3 LDs (3 variables, 6 groups, <span class="math inline">\(\min(3,6-1)=3\)</span>).</p></li>
<li><p>Relationship of LDs to original variables. Look for coeffs far from zero:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>peanuts<span class="fl">.1</span><span class="sc">$</span>scaling</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           LD1         LD2         LD3
y    0.4027356  0.02967881  0.18839237
smk  0.1727459 -0.06794271 -0.09386294
w   -0.5792456 -0.16300221  0.07341123</code></pre>
</div>
</div>
<ul>
<li><p>high <code>LD1</code> mainly high <code>y</code> or low <code>w</code>.</p></li>
<li><p>high <code>LD2</code> mainly low <code>w</code>.</p></li>
<li><p>Proportion of trace values show relative importance of LDs: <code>LD1</code> much more important than <code>LD2</code>; <code>LD3</code> worthless.</p></li>
</ul>
</section>
<section id="the-predictions-and-misclassification" class="level2">
<h2 class="anchored" data-anchor-id="the-predictions-and-misclassification">The predictions and misclassification</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">predict</span>(peanuts<span class="fl">.1</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>peanuts<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(peanuts.combo, p)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(peanuts<span class="fl">.2</span>, <span class="fu">table</span>(<span class="at">obs =</span> combo, <span class="at">pred =</span> class))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     pred
obs   5_1 5_2 6_1 6_2 8_1 8_2
  5_1   2   0   0   0   0   0
  5_2   0   2   0   0   0   0
  6_1   0   0   2   0   0   0
  6_2   1   0   0   1   0   0
  8_1   0   0   0   0   2   0
  8_2   0   0   0   0   0   2</code></pre>
</div>
</div>
<p>Actually classified very well. Only one <code>6_2</code> classified as a <code>5_1</code>, rest all correct.</p>
</section>
<section id="posterior-probabilities-1" class="level2">
<h2 class="anchored" data-anchor-id="posterior-probabilities-1">Posterior probabilities</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>peanuts<span class="fl">.2</span> <span class="sc">%&gt;%</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"posterior"</span>), \(p) <span class="fu">round</span>(p, <span class="dv">2</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(combo,  class, <span class="fu">starts_with</span>(<span class="st">"posterior"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   combo class posterior.5_1 posterior.5_2 posterior.6_1 posterior.6_2
1    5_1   5_1          0.69             0             0          0.31
2    5_1   5_1          0.73             0             0          0.27
3    5_2   5_2          0.00             1             0          0.00
4    5_2   5_2          0.00             1             0          0.00
5    6_1   6_1          0.00             0             1          0.00
6    6_1   6_1          0.00             0             1          0.00
7    6_2   6_2          0.13             0             0          0.87
8    6_2   5_1          0.53             0             0          0.47
9    8_1   8_1          0.02             0             0          0.02
10   8_1   8_1          0.00             0             0          0.00
11   8_2   8_2          0.00             0             0          0.00
12   8_2   8_2          0.00             0             0          0.00
   posterior.8_1 posterior.8_2
1           0.00          0.00
2           0.00          0.00
3           0.00          0.00
4           0.00          0.00
5           0.00          0.00
6           0.00          0.00
7           0.00          0.00
8           0.00          0.00
9           0.75          0.21
10          0.99          0.01
11          0.03          0.97
12          0.06          0.94</code></pre>
</div>
</div>
<p><em>Some</em> doubt about which combo each plant belongs in, but not too much. The one misclassified plant was a close call.</p>
</section>
<section id="discriminant-scores-again" class="level2">
<h2 class="anchored" data-anchor-id="discriminant-scores-again">Discriminant scores, again</h2>
<ul>
<li><p>How are discriminant scores related to original variables?</p></li>
<li><p>Construct data frame with original data and discriminant scores side by side:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>peanuts<span class="fl">.1</span><span class="sc">$</span>scaling</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           LD1         LD2         LD3
y    0.4027356  0.02967881  0.18839237
smk  0.1727459 -0.06794271 -0.09386294
w   -0.5792456 -0.16300221  0.07341123</code></pre>
</div>
</div>
<ul>
<li><p>LD1 positive if <code>y</code> large and/or <code>w</code> small.</p></li>
<li><p>LD2 positive if <code>w</code> small.</p></li>
</ul>
</section>
<section id="discriminant-scores-for-data" class="level2">
<h2 class="anchored" data-anchor-id="discriminant-scores-for-data">Discriminant scores for data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>peanuts<span class="fl">.2</span> <span class="sc">%&gt;%</span> <span class="fu">select</span>(y, w, <span class="fu">starts_with</span>(<span class="st">"x"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       y    w     x.LD1       x.LD2       x.LD3
1  195.3 51.4  1.417354  1.01233393  0.26467918
2  194.3 53.7  2.204444 -0.38421359 -1.12526629
3  189.7 55.5 -5.562217  1.10184441  0.78720394
4  180.4 44.4 -6.056558  3.88530191 -0.05263163
5  203.0 49.8  6.084370  1.25027629  1.25054957
6  195.9 45.8  7.131192  1.06649258 -1.24422021
7  202.7 60.4  1.430084 -1.11831802  1.09926555
8  197.6 54.1  2.282572  0.04938762  0.07958437
9  193.5 57.8 -1.045438 -0.85884902 -0.67463274
10 187.0 58.6 -4.022969 -1.22292871 -1.89677191
11 201.5 65.0 -1.596806 -1.95130266  1.14518230
12 200.0 67.2 -2.266028 -2.83002474  0.36705787</code></pre>
</div>
</div>
<ul>
<li><p>Obs.&nbsp;5 and 6 have most positive <code>LD1</code>: large <code>y</code>, small <code>w</code>.</p></li>
<li><p>Obs.&nbsp;4 has most positive <code>LD2</code>: small <code>w</code>.</p></li>
</ul>
</section>
<section id="plot-ld1-vs.-ld2-labelling-by-combo" class="level2">
<h2 class="anchored" data-anchor-id="plot-ld1-vs.-ld2-labelling-by-combo">Plot LD1 vs.&nbsp;LD2, labelling by combo</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(peanuts<span class="fl">.2</span>, <span class="fu">aes</span>(<span class="at">x =</span> x.LD1, <span class="at">y =</span> x.LD2, <span class="at">colour =</span> combo, </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">label =</span> combo)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>() <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">"none"</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="discrim_files/figure-html/bDiscrim-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="bi-plot-from-ggbiplot" class="level2">
<h2 class="anchored" data-anchor-id="bi-plot-from-ggbiplot">“Bi-plot” from <code>ggbiplot</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbiplot</span>(peanuts<span class="fl">.1</span>, <span class="at">groups =</span> <span class="fu">factor</span>(peanuts.combo<span class="sc">$</span>combo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="discrim_files/figure-html/bDiscrim-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="installing-ggbiplot" class="level2">
<h2 class="anchored" data-anchor-id="installing-ggbiplot">Installing <code>ggbiplot</code></h2>
<ul>
<li><p><code>ggbiplot</code> not on CRAN, so usual <code>install.packages</code> will not work.</p></li>
<li><p>Install package <code>devtools</code> first (once):</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"devtools"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Then install <code>ggbiplot</code> (once):</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">"vqv/ggbiplot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cross-validation" class="level2">
<h2 class="anchored" data-anchor-id="cross-validation">Cross-validation</h2>
<ul>
<li><p>So far, have predicted group membership from same data used to form the groups — dishonest!</p></li>
<li><p>Better: <em>cross-validation</em>: form groups from all observations <em>except one</em>, then predict group membership for that left-out observation.</p></li>
<li><p>No longer cheating!</p></li>
<li><p>Illustrate with peanuts data again.</p></li>
</ul>
</section>
<section id="misclassifications" class="level2">
<h2 class="anchored" data-anchor-id="misclassifications">Misclassifications</h2>
<ul>
<li>Fitting and prediction all in one go:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">lda</span>(combo <span class="sc">~</span> y <span class="sc">+</span> smk <span class="sc">+</span> w,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> peanuts.combo, <span class="at">CV =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>peanuts<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(peanuts.combo, <span class="at">class =</span> p<span class="sc">$</span>class, </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">posterior =</span> p<span class="sc">$</span>posterior)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(peanuts<span class="fl">.3</span>, <span class="fu">table</span>(<span class="at">obs =</span> combo, <span class="at">pred =</span> class))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     pred
obs   5_1 5_2 6_1 6_2 8_1 8_2
  5_1   0   0   0   2   0   0
  5_2   0   1   0   0   1   0
  6_1   0   0   2   0   0   0
  6_2   1   0   0   1   0   0
  8_1   0   1   0   0   0   1
  8_2   0   0   0   0   0   2</code></pre>
</div>
</div>
<ul>
<li>Some more misclassification this time.</li>
</ul>
</section>
<section id="repeat-of-ld-plot" class="level2">
<h2 class="anchored" data-anchor-id="repeat-of-ld-plot">Repeat of LD plot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="discrim_files/figure-html/graziani-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="posterior-probabilities-2" class="level2">
<h2 class="anchored" data-anchor-id="posterior-probabilities-2">Posterior probabilities</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>peanuts<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"posterior"</span>), \(p) <span class="fu">round</span>(p, <span class="dv">3</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(combo, class, <span class="fu">starts_with</span>(<span class="st">"posterior"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   combo class posterior.5_1 posterior.5_2 posterior.6_1 posterior.6_2
1    5_1   6_2         0.162          0.00         0.000         0.838
2    5_1   6_2         0.200          0.00         0.000         0.799
3    5_2   8_1         0.000          0.18         0.000         0.000
4    5_2   5_2         0.000          1.00         0.000         0.000
5    6_1   6_1         0.194          0.00         0.669         0.137
6    6_1   6_1         0.000          0.00         1.000         0.000
7    6_2   6_2         0.325          0.00         0.000         0.667
8    6_2   5_1         0.821          0.00         0.000         0.179
9    8_1   8_2         0.000          0.00         0.000         0.000
10   8_1   5_2         0.000          1.00         0.000         0.000
11   8_2   8_2         0.001          0.00         0.000         0.004
12   8_2   8_2         0.000          0.00         0.000         0.000
   posterior.8_1 posterior.8_2
1          0.000         0.000
2          0.000         0.000
3          0.820         0.000
4          0.000         0.000
5          0.000         0.000
6          0.000         0.000
7          0.001         0.008
8          0.000         0.000
9          0.000         1.000
10         0.000         0.000
11         0.083         0.913
12         0.167         0.833</code></pre>
</div>
</div>
</section>
<section id="why-more-misclassification" class="level2">
<h2 class="anchored" data-anchor-id="why-more-misclassification">Why more misclassification?</h2>
<ul>
<li><p>When predicting group membership for one observation, only uses the <em>other one</em> in that group.</p></li>
<li><p>So if two in a pair are far apart, or if two groups overlap, great potential for misclassification.</p></li>
<li><p>Groups <code>5_1</code> and <code>6_2</code> overlap.</p></li>
<li><p><code>5_2</code> closest to <code>8_1</code>s looks more like an <code>8_1</code> than a <code>5_2</code> (other one far away).</p></li>
<li><p><code>8_1</code>s relatively far apart and close to other things, so one appears to be a <code>5_2</code> and the other an <code>8_2</code>.</p></li>
</ul>
</section>
<section id="example-3-professions-and-leisure-activities" class="level2">
<h2 class="anchored" data-anchor-id="example-3-professions-and-leisure-activities">Example 3: professions and leisure activities</h2>
<ul>
<li><p>15 individuals from three different professions (politicians, administrators and belly dancers) each participate in four different leisure activities: reading, dancing, TV watching and skiing. After each activity they rate it on a 0–10 scale.</p></li>
<li><p>How can we best use the scores on the activities to predict a person’s profession?</p></li>
<li><p>Or, what combination(s) of scores best separate data into profession groups?</p></li>
</ul>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">The data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/profile.txt"</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>active <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(my_url, <span class="st">" "</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>active</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 5
   job         reading dance    tv   ski
   &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 bellydancer       7    10     6     5
 2 bellydancer       8     9     5     7
 3 bellydancer       5    10     5     8
 4 bellydancer       6    10     6     8
 5 bellydancer       7     8     7     9
 6 politician        4     4     4     4
 7 politician        6     4     5     3
 8 politician        5     5     5     6
 9 politician        6     6     6     7
10 politician        4     5     6     5
11 admin             3     1     1     2
12 admin             5     3     1     5
13 admin             4     2     2     5
14 admin             7     1     2     4
15 admin             6     3     3     3</code></pre>
</div>
</div>
</section>
<section id="discriminant-analysis-2" class="level2">
<h2 class="anchored" data-anchor-id="discriminant-analysis-2">Discriminant analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>active<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lda</span>(job <span class="sc">~</span> reading <span class="sc">+</span> dance <span class="sc">+</span> tv <span class="sc">+</span> ski, <span class="at">data =</span> active)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>active<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lda(job ~ reading + dance + tv + ski, data = active)

Prior probabilities of groups:
      admin bellydancer  politician 
  0.3333333   0.3333333   0.3333333 

Group means:
            reading dance  tv ski
admin           5.0   2.0 1.8 3.8
bellydancer     6.6   9.4 5.8 7.4
politician      5.0   4.8 5.2 5.0

Coefficients of linear discriminants:
                LD1        LD2
reading -0.01297465 -0.4748081
dance   -0.95212396 -0.4614976
tv      -0.47417264  1.2446327
ski      0.04153684 -0.2033122

Proportion of trace:
   LD1    LD2 
0.8917 0.1083 </code></pre>
</div>
</div>
</section>
<section id="comments-1" class="level2">
<h2 class="anchored" data-anchor-id="comments-1">Comments</h2>
<ul>
<li><p>Two discriminants, first fair bit more important than second.</p></li>
<li><p><code>LD1</code> depends (negatively) most on <code>dance</code>, a bit on <code>tv</code>.</p></li>
<li><p><code>LD2</code> depends mostly (negatively) on <code>tv</code>.</p></li>
</ul>
</section>
<section id="misclassification" class="level2">
<h2 class="anchored" data-anchor-id="misclassification">Misclassification</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">predict</span>(active<span class="fl">.1</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>active<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(active, p)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(active<span class="fl">.2</span>, <span class="fu">table</span>(<span class="at">obs =</span> job, <span class="at">pred =</span> class))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             pred
obs           admin bellydancer politician
  admin           5           0          0
  bellydancer     0           5          0
  politician      0           0          5</code></pre>
</div>
</div>
<p>Everyone correctly classified.</p>
</section>
<section id="plotting-lds" class="level2">
<h2 class="anchored" data-anchor-id="plotting-lds">Plotting LDs</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(active<span class="fl">.2</span>, <span class="fu">aes</span>(<span class="at">x =</span> x.LD1, <span class="at">y =</span> x.LD2, <span class="at">colour =</span> job, <span class="at">label =</span> job)) <span class="sc">+</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_text_repel</span>() <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">"none"</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="discrim_files/figure-html/bDiscrim-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="biplot" class="level2">
<h2 class="anchored" data-anchor-id="biplot">Biplot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbiplot</span>(active<span class="fl">.1</span>, <span class="at">groups =</span> active<span class="sc">$</span>job)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="discrim_files/figure-html/bDiscrim-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="comments-on-plot" class="level2">
<h2 class="anchored" data-anchor-id="comments-on-plot">Comments on plot</h2>
<ul>
<li><p>Groups well separated: bellydancers top left, administrators top right, politicians lower middle.</p></li>
<li><p>Bellydancers most negative on <code>LD1</code>: like dancing most.</p></li>
<li><p>Administrators most positive on <code>LD1</code>: like dancing least.</p></li>
<li><p>Politicians most negative on <code>LD2</code>: like TV-watching most.</p></li>
</ul>
</section>
<section id="plotting-individual-persons" class="level2">
<h2 class="anchored" data-anchor-id="plotting-individual-persons">Plotting individual <code>persons</code></h2>
<p>Make <code>label</code> be identifier of person. Now need legend:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>active<span class="fl">.2</span> <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">person =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x.LD1, <span class="at">y =</span> x.LD2,  <span class="at">colour =</span> job, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">label =</span> person)) <span class="sc">+</span> </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_text_repel</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="discrim_files/figure-html/bDiscrim-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="posterior-probabilities-3" class="level2">
<h2 class="anchored" data-anchor-id="posterior-probabilities-3">Posterior probabilities</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>active<span class="fl">.2</span> <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"posterior"</span>), \(p) <span class="fu">round</span>(p, <span class="dv">3</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(job, class, <span class="fu">starts_with</span>(<span class="st">"posterior"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           job       class posterior.admin posterior.bellydancer
1  bellydancer bellydancer           0.000                 1.000
2  bellydancer bellydancer           0.000                 1.000
3  bellydancer bellydancer           0.000                 1.000
4  bellydancer bellydancer           0.000                 1.000
5  bellydancer bellydancer           0.000                 0.997
6   politician  politician           0.003                 0.000
7   politician  politician           0.000                 0.000
8   politician  politician           0.000                 0.000
9   politician  politician           0.000                 0.002
10  politician  politician           0.000                 0.000
11       admin       admin           1.000                 0.000
12       admin       admin           1.000                 0.000
13       admin       admin           1.000                 0.000
14       admin       admin           1.000                 0.000
15       admin       admin           0.982                 0.000
   posterior.politician
1                 0.000
2                 0.000
3                 0.000
4                 0.000
5                 0.003
6                 0.997
7                 1.000
8                 1.000
9                 0.998
10                1.000
11                0.000
12                0.000
13                0.000
14                0.000
15                0.018</code></pre>
</div>
</div>
<p>Not much doubt.</p>
</section>
<section id="cross-validating-the-jobs-activities-data" class="level2">
<h2 class="anchored" data-anchor-id="cross-validating-the-jobs-activities-data">Cross-validating the jobs-activities data</h2>
<p>Recall: no need for <code>predict</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">lda</span>(job <span class="sc">~</span> reading <span class="sc">+</span> dance <span class="sc">+</span> tv <span class="sc">+</span> ski, <span class="at">data =</span> active, <span class="at">CV =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>active<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(active, <span class="at">class =</span> p<span class="sc">$</span>class, <span class="at">posterior =</span> p<span class="sc">$</span>posterior)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(active<span class="fl">.3</span>, <span class="fu">table</span>(<span class="at">obs =</span> job, <span class="at">pred =</span> class))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             pred
obs           admin bellydancer politician
  admin           5           0          0
  bellydancer     0           4          1
  politician      0           0          5</code></pre>
</div>
</div>
<p>This time one of the bellydancers was classified as a politician.</p>
</section>
<section id="and-look-at-the-posterior-probabilities" class="level2">
<h2 class="anchored" data-anchor-id="and-look-at-the-posterior-probabilities">and look at the posterior probabilities</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>active<span class="fl">.3</span> <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"posterior"</span>), \(p) <span class="fu">round</span>(p, <span class="dv">3</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(job, class, <span class="fu">starts_with</span>(<span class="st">"post"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           job       class posterior.admin posterior.bellydancer
1  bellydancer bellydancer           0.000                 1.000
2  bellydancer bellydancer           0.000                 1.000
3  bellydancer bellydancer           0.000                 1.000
4  bellydancer bellydancer           0.000                 1.000
5  bellydancer  politician           0.000                 0.001
6   politician  politician           0.006                 0.000
7   politician  politician           0.001                 0.000
8   politician  politician           0.000                 0.000
9   politician  politician           0.000                 0.009
10  politician  politician           0.000                 0.000
11       admin       admin           1.000                 0.000
12       admin       admin           1.000                 0.000
13       admin       admin           1.000                 0.000
14       admin       admin           1.000                 0.000
15       admin       admin           0.819                 0.000
   posterior.politician
1                 0.000
2                 0.000
3                 0.000
4                 0.000
5                 0.999
6                 0.994
7                 0.999
8                 1.000
9                 0.991
10                1.000
11                0.000
12                0.000
13                0.000
14                0.000
15                0.181</code></pre>
</div>
</div>
</section>
<section id="comments-2" class="level2">
<h2 class="anchored" data-anchor-id="comments-2">Comments</h2>
<ul>
<li><p>Bellydancer was “definitely” a politician!</p></li>
<li><p>One of the administrators might have been a politician too.</p></li>
</ul>
</section>
<section id="why-did-things-get-misclassified" class="level2">
<h2 class="anchored" data-anchor-id="why-did-things-get-misclassified">Why did things get misclassified?</h2>
<div class="columns">
<div class="column" style="width:40%;">
<p>Go back to plot of discriminant scores:</p>
<ul>
<li><p>one bellydancer much closer to the politicians,</p></li>
<li><p>one administrator a bit closer to the politicians.</p></li>
</ul>
</div><div class="column" style="width:60%;">
<div class="cell">
<div class="cell-output-display">
<p><img src="discrim_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="example-4-remote-sensing-data" class="level2">
<h2 class="anchored" data-anchor-id="example-4-remote-sensing-data">Example 4: remote-sensing data</h2>
<ul>
<li><p>View 25 crops from air, measure 4 variables <code>x1-x4</code>.</p></li>
<li><p>Go back and record what each crop was.</p></li>
<li><p>Can we use the 4 variables to distinguish crops?</p></li>
</ul>
</section>
<section id="the-data-1" class="level2">
<h2 class="anchored" data-anchor-id="the-data-1">The data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/remote-sensing.txt"</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>crops <span class="ot">&lt;-</span> <span class="fu">read_table</span>(my_url)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>crops <span class="sc">%&gt;%</span> <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 × 6
   crop          x1    x2    x3    x4 cr   
   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
 1 Corn          16    27    31    33 r    
 2 Corn          15    23    30    30 r    
 3 Corn          16    27    27    26 r    
 4 Corn          18    20    25    23 r    
 5 Corn          15    15    31    32 r    
 6 Corn          15    32    32    15 r    
 7 Corn          12    15    16    73 r    
 8 Soybeans      20    23    23    25 y    
 9 Soybeans      24    24    25    32 y    
10 Soybeans      21    25    23    24 y    
11 Soybeans      27    45    24    12 y    
12 Soybeans      12    13    15    42 y    
13 Soybeans      22    32    31    43 y    
14 Cotton        31    32    33    34 t    
15 Cotton        29    24    26    28 t    
16 Cotton        34    32    28    45 t    
17 Cotton        26    25    23    24 t    
18 Cotton        53    48    75    26 t    
19 Cotton        34    35    25    78 t    
20 Sugarbeets    22    23    25    42 g    
21 Sugarbeets    25    25    24    26 g    
22 Sugarbeets    34    25    16    52 g    
23 Sugarbeets    54    23    21    54 g    
24 Sugarbeets    25    43    32    15 g    
25 Sugarbeets    26    54     2    54 g    </code></pre>
</div>
</div>
</section>
<section id="discriminant-analysis-3" class="level2">
<h2 class="anchored" data-anchor-id="discriminant-analysis-3">Discriminant analysis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>crops<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lda</span>(crop <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x3 <span class="sc">+</span> x4, <span class="at">data =</span> crops)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>crops<span class="fl">.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
lda(crop ~ x1 + x2 + x3 + x4, data = crops)

Prior probabilities of groups:
      Corn     Cotton   Soybeans Sugarbeets 
      0.28       0.24       0.24       0.24 

Group means:
                 x1       x2       x3       x4
Corn       15.28571 22.71429 27.42857 33.14286
Cotton     34.50000 32.66667 35.00000 39.16667
Soybeans   21.00000 27.00000 23.50000 29.66667
Sugarbeets 31.00000 32.16667 20.00000 40.50000

Coefficients of linear discriminants:
           LD1          LD2           LD3
x1  0.14077479  0.007780184 -0.0312610362
x2  0.03006972  0.007318386  0.0085401510
x3 -0.06363974 -0.099520895 -0.0005309869
x4 -0.00677414 -0.035612707  0.0577718649

Proportion of trace:
   LD1    LD2    LD3 
0.8044 0.1832 0.0124 </code></pre>
</div>
</div>
</section>
<section id="assessing" class="level2">
<h2 class="anchored" data-anchor-id="assessing">Assessing</h2>
<ul>
<li><p>3 LDs (four variables, four groups).</p></li>
<li><p>1st two important.</p></li>
<li><p><code>LD1</code> mostly <code>x1</code> (minus)</p></li>
<li><p><code>LD2</code> <code>x3</code> (minus)</p></li>
</ul>
</section>
<section id="predictions" class="level2">
<h2 class="anchored" data-anchor-id="predictions">Predictions</h2>
<ul>
<li>Thus:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">predict</span>(crops<span class="fl">.1</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>crops<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">cbind</span>(crops, p)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(crops<span class="fl">.2</span>, <span class="fu">table</span>(<span class="at">obs =</span> crop, <span class="at">pred =</span> class))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            pred
obs          Corn Cotton Soybeans Sugarbeets
  Corn          6      0        1          0
  Cotton        0      4        2          0
  Soybeans      2      0        3          1
  Sugarbeets    0      0        3          3</code></pre>
</div>
</div>
<ul>
<li>Not very good, eg. only half the Soybeans and Sugarbeets classified correctly.</li>
</ul>
</section>
<section id="plotting-the-lds" class="level2">
<h2 class="anchored" data-anchor-id="plotting-the-lds">Plotting the LDs</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(crops<span class="fl">.2</span>, <span class="fu">aes</span>(<span class="at">x =</span> x.LD1, <span class="at">y =</span> x.LD2, <span class="at">colour =</span> crop)) <span class="sc">+</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="discrim_files/figure-html/piacentini-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Corn (red) mostly left, cotton (green) sort of right, soybeans and sugarbeets (blue and purple) mixed up.</p>
</section>
<section id="biplot-1" class="level2">
<h2 class="anchored" data-anchor-id="biplot-1">Biplot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbiplot</span>(crops<span class="fl">.1</span>, <span class="at">groups =</span> crops<span class="sc">$</span>crop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="discrim_files/figure-html/bDiscrim-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="comments-3" class="level2">
<h2 class="anchored" data-anchor-id="comments-3">Comments</h2>
<ul>
<li><p>Corn low on LD1 (left), hence low on <code>x1</code></p></li>
<li><p>Cotton tends to be high on LD1 (high <code>x1</code>)</p></li>
<li><p>one cotton very low on LD2 (high <code>x3</code>?)</p></li>
<li><p>Rather mixed up.</p></li>
</ul>
</section>
<section id="posterior-probs-some" class="level2">
<h2 class="anchored" data-anchor-id="posterior-probs-some">Posterior probs (some)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>crops<span class="fl">.2</span> <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">starts_with</span>(<span class="st">"posterior"</span>), \(p) <span class="fu">round</span>(p, <span class="dv">3</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(crop <span class="sc">!=</span> class) <span class="sc">%&gt;%</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(crop, class, <span class="fu">starts_with</span>(<span class="st">"posterior"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         crop      class posterior.Corn posterior.Cotton posterior.Soybeans
4        Corn   Soybeans          0.443            0.034              0.494
11   Soybeans Sugarbeets          0.010            0.107              0.299
12   Soybeans       Corn          0.684            0.009              0.296
13   Soybeans       Corn          0.467            0.199              0.287
15     Cotton   Soybeans          0.056            0.241              0.379
17     Cotton   Soybeans          0.066            0.138              0.489
20 Sugarbeets   Soybeans          0.381            0.146              0.395
21 Sugarbeets   Soybeans          0.106            0.144              0.518
24 Sugarbeets   Soybeans          0.088            0.207              0.489
   posterior.Sugarbeets
4                 0.029
11                0.584
12                0.011
13                0.047
15                0.324
17                0.306
20                0.078
21                0.232
24                0.216</code></pre>
</div>
</div>
</section>
<section id="comments-4" class="level2">
<h2 class="anchored" data-anchor-id="comments-4">Comments</h2>
<ul>
<li><p>These were the misclassified ones, but the posterior probability of being correct was not usually too low.</p></li>
<li><p>The correctly-classified ones are not very clear-cut either.</p></li>
</ul>
</section>
<section id="manova" class="level2">
<h2 class="anchored" data-anchor-id="manova">MANOVA</h2>
<p>Began discriminant analysis as a followup to MANOVA. Do our variables significantly separate the crops?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="fu">with</span>(crops, <span class="fu">cbind</span>(x1, x2, x3, x4))</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>crops.manova <span class="ot">&lt;-</span> <span class="fu">manova</span>(response <span class="sc">~</span> crop, <span class="at">data =</span> crops)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(crops.manova)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Df Pillai approx F num Df den Df  Pr(&gt;F)  
crop       3 0.9113   2.1815     12     60 0.02416 *
Residuals 21                                        
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="boxs-m-test" class="level2">
<h2 class="anchored" data-anchor-id="boxs-m-test">Box’s M test</h2>
<p>We should also run Box’s M test to check for equal variance of each variable across crops:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">BoxM</span>(response, crops<span class="sc">$</span>crop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Box's M Test 

Chi-Squared Value = 69.42634 , df = 30  and p-value: 5.79e-05 </code></pre>
</div>
</div>
<ul>
<li><p>The P-value for the M test is smaller even than our guideline of 0.001. So we should not take the MANOVA seriously.</p></li>
<li><p><em>Apparently</em> at least one of the crops differs (in means) from the others. So it is worth doing this analysis.</p></li>
<li><p>We did this the wrong way around, though!</p></li>
</ul>
</section>
<section id="the-right-way-around" class="level2">
<h2 class="anchored" data-anchor-id="the-right-way-around">The right way around</h2>
<ul>
<li><p><em>First</em>, do a MANOVA to see whether any of the groups differ significantly on any of the variables.</p></li>
<li><p>Check that the MANOVA is believable by using Box’s M test.</p></li>
<li><p><em>If the MANOVA is significant</em>, do a discriminant analysis in the hopes of understanding how the groups are different.</p></li>
<li><p>For remote-sensing data (without Clover):</p>
<ul>
<li><p>LD1 a fair bit more important than LD2 (definitely ignore LD3).</p></li>
<li><p>LD1 depends mostly on <code>x1</code>, on which Cotton was high and Corn was low.</p></li>
</ul></li>
<li><p>Discriminant analysis in MANOVA plays the same kind of role that Tukey does in ANOVA.</p></li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>