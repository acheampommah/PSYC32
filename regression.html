<!DOCTYPE html>
<html lang="en"><head>
<script src="regression_files/libs/clipboard/clipboard.min.js"></script>
<script src="regression_files/libs/quarto-html/tabby.min.js"></script>
<script src="regression_files/libs/quarto-html/popper.min.js"></script>
<script src="regression_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="regression_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="regression_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="regression_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="regression_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.340">

  <title>Regression revisited</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="regression_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="regression_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="regression_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="regression_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="regression_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="regression_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="regression_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  
  <link href="regression_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
  <script src="regression_files/libs/pagedtable-1.1/js/pagedtable.js"></script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Regression revisited</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="regression" class="slide level2">
<h2>Regression</h2>
<ul>
<li><p>Use regression when one variable is an outcome (<em>response</em>, <span class="math inline">\(y\)</span>).</p></li>
<li><p>See if/how response depends on other variable(s), <em>explanatory</em>, <span class="math inline">\(x_1, x_2,\ldots\)</span>.</p></li>
<li><p>Can have <em>one</em> or <em>more than one</em> explanatory variable, but always one response.</p></li>
<li><p>Assumes a <em>straight-line</em> relationship between response and explanatory.</p></li>
<li><p>Ask:</p>
<ul>
<li><em>is there</em> a relationship between <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span>’s, and if so, which ones?</li>
<li>what does the relationship look like?</li>
</ul></li>
</ul>
</section>
<section id="packages" class="slide level2">
<h2>Packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(MASS) <span class="co"># for Box-Cox, later</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(conflicted)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">conflict_prefer</span>(<span class="st">"select"</span>, <span class="st">"dplyr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="a-regression-with-one-x" class="slide level2">
<h2>A regression with one <span class="math inline">\(x\)</span></h2>
<p>13 children, measure average total sleep time (ATST, mins) and age (years) for each. See if ATST depends on age. Data in <code>sleep.txt</code>, ATST then age. Read in data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/sleep.txt"</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>sleep <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(my_url, <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="check-data" class="slide level2">
<h2>Check data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">summary</span>(sleep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      atst            age        
 Min.   :461.8   Min.   : 4.400  
 1st Qu.:491.1   1st Qu.: 7.200  
 Median :528.3   Median : 8.900  
 Mean   :519.3   Mean   : 9.058  
 3rd Qu.:532.5   3rd Qu.:11.100  
 Max.   :586.0   Max.   :14.000  </code></pre>
</div>
</div>
<p>Make scatter plot of ATST (response) vs.&nbsp;age (explanatory) using code overleaf:</p>
</section>
<section id="the-scatterplot" class="slide level2">
<h2>The scatterplot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">ggplot</span>(sleep, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> atst)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="regression_files/figure-revealjs/suggo-1.png" width="960" class="r-stretch"></section>
<section id="correlation" class="slide level2">
<h2>Correlation</h2>
<ul>
<li>Measures how well a straight line fits the data:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">with</span>(sleep, <span class="fu">cor</span>(atst, age))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9515469</code></pre>
</div>
</div>
<ul>
<li><p><span class="math inline">\(1\)</span> is perfect upward trend, <span class="math inline">\(-1\)</span> is perfect downward trend, 0 is no trend.</p></li>
<li><p>This one close to perfect downward trend.</p></li>
<li><p>Can do correlations of all pairs of variables:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="fu">cor</span>(sleep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           atst        age
atst  1.0000000 -0.9515469
age  -0.9515469  1.0000000</code></pre>
</div>
</div>
</section>
<section id="lowess-curve" class="slide level2">
<h2>Lowess curve</h2>
<ul>
<li><p>Sometimes nice to guide the eye: is the trend straight, or not?</p></li>
<li><p>Idea: <em>lowess curve</em>. “Locally weighted least squares”, not affected by outliers, not constrained to be linear.</p></li>
<li><p>Lowess is a <em>guide</em>: even if straight line appropriate, may wiggle/bend a little. Looking for <em>serious</em> problems with linearity.</p></li>
<li><p>Add lowess curve to plot using <code>geom_smooth</code>:</p></li>
</ul>
</section>
<section id="plot-with-lowess-curve" class="slide level2">
<h2>Plot with lowess curve</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">ggplot</span>(sleep, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> atst)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="regression_files/figure-revealjs/icko-1.png" width="960" class="r-stretch"></section>
<section id="the-regression" class="slide level2">
<h2>The regression</h2>
<p>Scatterplot shows no obvious curve, and a pretty clear downward trend. So we can run the regression:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>sleep<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(atst <span class="sc">~</span> age, <span class="at">data =</span> sleep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-output" class="slide level2">
<h2>The output</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">summary</span>(sleep<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = atst ~ age, data = sleep)

Residuals:
    Min      1Q  Median      3Q     Max 
-23.011  -9.365   2.372   6.770  20.411 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  646.483     12.918   50.05 2.49e-14 ***
age          -14.041      1.368  -10.26 5.70e-07 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 13.15 on 11 degrees of freedom
Multiple R-squared:  0.9054,    Adjusted R-squared:  0.8968 
F-statistic: 105.3 on 1 and 11 DF,  p-value: 5.7e-07</code></pre>
</div>
</div>
</section>
<section id="conclusions" class="slide level2">
<h2>Conclusions</h2>
<ul>
<li><p>The relationship appears to be a straight line, with a downward trend.</p></li>
<li><p><span class="math inline">\(F\)</span>-tests for model as a whole and <span class="math inline">\(t\)</span>-test for slope (same) both confirm this (P-value <span class="math inline">\(5.7\times 10^{-7}=0.00000057\)</span>).</p></li>
<li><p>Slope is <span class="math inline">\(-14\)</span>, so a 1-year increase in age goes with a 14-minute decrease in ATST on average.</p></li>
<li><p>R-squared is correlation squared (when one <span class="math inline">\(x\)</span> anyway), between 0 and 1 (1 good, 0 bad).</p></li>
<li><p>Here R-squared is 0.9054, pleasantly high.</p></li>
</ul>
</section>
<section id="doing-things-with-the-regression-output" class="slide level2">
<h2>Doing things with the regression output</h2>
<ul>
<li><p>Output from regression (and eg. <span class="math inline">\(t\)</span>-test) is all right to look at, but hard to extract and re-use information from.</p></li>
<li><p>Package <code>broom</code> extracts info from model output in way that can be used in pipe (later):</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">tidy</span>(sleep<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"646.48334","3":"12.917726","4":"50.04622","5":"2.490578e-14"},{"1":"age","2":"-14.04105","3":"1.368116","4":"-10.26305","5":"5.700014e-07"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="also-one-line-summary-of-model" class="slide level2">
<h2>also one-line summary of model:</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">glance</span>(sleep<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["r.squared"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["adj.r.squared"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sigma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["df.residual"],"name":[11],"type":["int"],"align":["right"]},{"label":["nobs"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"0.9054416","2":"0.8968454","3":"13.15238","4":"105.3302","5":"5.700014e-07","6":"1","7":"-50.85618","8":"107.7124","9":"109.4072","10":"1902.835","11":"11","12":"13"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="broom-part-2" class="slide level2">
<h2>Broom part 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>sleep<span class="fl">.1</span> <span class="sc">%&gt;%</span> <span class="fu">augment</span>(sleep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["atst"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[2],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"586.00","2":"4.40","3":"584.7027","4":"1.297271","5":"0.31165883","6":"13.78546","7":"0.003199595","8":"0.1188843"},{"1":"461.75","2":"14.00","3":"449.9087","4":"11.841335","5":"0.34122311","6":"12.99996","7":"0.318657829","8":"1.1092444"},{"1":"491.10","2":"10.10","3":"504.6688","4":"-13.568753","5":"0.08867826","6":"13.04151","7":"0.056821825","8":"-1.0806868"},{"1":"565.00","2":"6.70","3":"552.4083","4":"12.591682","5":"0.13706979","6":"13.11145","7":"0.084356677","8":"1.0306037"},{"1":"462.00","2":"11.50","3":"485.0113","4":"-23.011286","5":"0.14146448","6":"11.34048","7":"0.293747511","8":"-1.8882414"},{"1":"532.10","2":"9.60","3":"511.6893","4":"20.410722","5":"0.08010529","6":"12.04143","7":"0.113989080","8":"1.6180245"},{"1":"477.60","2":"12.40","3":"472.3743","4":"5.225658","5":"0.19779641","6":"13.67039","7":"0.024260104","8":"0.4436029"},{"1":"515.20","2":"8.90","3":"521.5180","4":"-6.318011","5":"0.07719214","6":"13.63664","7":"0.010458584","8":"-0.5000582"},{"1":"493.00","2":"11.10","3":"490.6277","4":"2.372295","5":"0.12205460","6":"13.77107","7":"0.002575835","8":"0.1925000"},{"1":"528.30","2":"7.75","3":"537.6652","4":"-9.365217","5":"0.09542636","6":"13.43829","7":"0.029564990","8":"-0.7486721"},{"1":"575.90","2":"5.50","3":"569.2576","4":"6.642424","5":"0.21387698","6":"13.58937","7":"0.044136490","8":"0.5696094"},{"1":"532.50","2":"8.60","3":"525.7303","4":"6.769674","5":"0.07918973","6":"13.61273","7":"0.012371593","8":"0.5363873"},{"1":"530.50","2":"7.20","3":"545.3878","4":"-14.887794","5":"0.11426401","6":"12.85533","7":"0.093308912","8":"-1.2027461"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Useful for plotting residuals against an <span class="math inline">\(x\)</span>-variable.</p>
</section>
<section id="ci-for-mean-response-and-prediction-intervals" class="slide level2">
<h2>CI for mean response and prediction intervals</h2>
<p>Once useful regression exists, use it for prediction:</p>
<ul>
<li><p>To get a single number for prediction at a given <span class="math inline">\(x\)</span>, substitute into regression equation, eg. age 10: predicted ATST is <span class="math inline">\(646.48-14.04(10)=506\)</span> minutes.</p></li>
<li><p>To express uncertainty of this prediction:</p></li>
<li><p><em>CI for mean response</em> expresses uncertainty about mean ATST for all children aged 10, based on data.</p></li>
<li><p><em>Prediction interval</em> expresses uncertainty about predicted ATST for a new child aged 10 whose ATST not known. More uncertain.</p></li>
<li><p>Also do above for a child aged 5.</p></li>
</ul>
</section>
<section id="the-marginaleffects-package-12" class="slide level2">
<h2>The <code>marginaleffects</code> package 1/2</h2>
<p>To get predictions for specific values, set up a dataframe with those values first:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>new <span class="ot">&lt;-</span> <span class="fu">datagrid</span>(<span class="at">model =</span> sleep<span class="fl">.1</span>, <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb17-2"><a href="#cb17-2"></a>new</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["atst"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"519.3038","2":"10"},{"1":"519.3038","2":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Any variables in the dataframe that you don’t specify are set to their mean values (quantitative) or most common category (categorical).</p>
</section>
<section id="the-marginaleffects-package-22" class="slide level2">
<h2>The <code>marginaleffects</code> package 2/2</h2>
<p>Then feed into <code>newdata</code> in <code>predictions</code>. This contains a lot of columns, so you probably want only to display the ones you care about:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">cbind</span>(<span class="fu">predictions</span>(sleep<span class="fl">.1</span>, <span class="at">newdata =</span> new)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2"></a>  <span class="fu">select</span>(estimate, conf.low, conf.high, age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["estimate"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["conf.low"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["conf.high"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["age"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"506.0729","2":"498.4899","3":"513.6558","4":"10"},{"1":"576.2781","2":"563.2588","3":"589.2974","4":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The confidence limits are a 95% confidence interval for the mean response at that <code>age</code>.</p>
</section>
<section id="prediction-intervals" class="slide level2">
<h2>Prediction intervals</h2>
<p>These are obtained (instead) with <code>predict</code> as below. Use the same dataframe <code>new</code> as before:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">predict</span>(sleep<span class="fl">.1</span>, new, <span class="at">interval =</span> <span class="st">"p"</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="fu">cbind</span>(new, pp) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>atst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["age"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["fit"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["lwr"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["upr"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"10","2":"506.0729","3":"475.8982","4":"536.2475","_rn_":"1"},{"1":"5","2":"576.2781","3":"543.8474","4":"608.7088","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="comments" class="slide level2">
<h2>Comments</h2>
<ul>
<li><p>Age 10 closer to centre of data, so intervals are both narrower than those for age 5.</p></li>
<li><p>Prediction intervals bigger than CI for mean (additional uncertainty).</p></li>
<li><p>Technical note: output from <code>predict</code> is R <code>matrix</code>, not data frame, so Tidyverse <code>bind_cols</code> does not work. Use base R <code>cbind</code>.</p></li>
</ul>
</section>
<section id="that-grey-envelope" class="slide level2">
<h2>That grey envelope</h2>
<p>Marks confidence interval for mean for all <span class="math inline">\(x\)</span>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">ggplot</span>(sleep, <span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> atst)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">420</span>, <span class="dv">600</span>, <span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="regression_files/figure-revealjs/bRegression-15-1.png" width="960" class="r-stretch"></section>
<section id="diagnostics" class="slide level2">
<h2>Diagnostics</h2>
<p>How to tell whether a straight-line regression is appropriate?</p>
<ul>
<li><p>Before: check scatterplot for straight trend.</p></li>
<li><p>After: plot <em>residuals</em> (observed minus predicted response) against predicted values. Aim: a plot with no pattern.</p></li>
</ul>
</section>
<section id="residual-plot" class="slide level2">
<h2>Residual plot</h2>
<p>Not much pattern here — regression appropriate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">ggplot</span>(sleep<span class="fl">.1</span>, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="regression_files/figure-revealjs/akjhkadjfhjahnkkk-1.png" width="960" class="r-stretch"></section>
<section id="an-inappropriate-regression" class="slide level2">
<h2>An inappropriate regression</h2>
<p>Different data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/curvy.txt"</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>curvy <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(my_url, <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="scatterplot" class="slide level2">
<h2>Scatterplot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">ggplot</span>(curvy, <span class="fu">aes</span>(<span class="at">x =</span> xx, <span class="at">y =</span> yy)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="regression_files/figure-revealjs/bRegression-16-1.png" width="960" class="r-stretch"></section>
<section id="regression-line-anyway" class="slide level2">
<h2>Regression line, anyway</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>curvy<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(yy <span class="sc">~</span> xx, <span class="at">data =</span> curvy)</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="fu">summary</span>(curvy<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = yy ~ xx, data = curvy)

Residuals:
   Min     1Q Median     3Q    Max 
-3.582 -2.204  0.000  1.514  3.509 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)   7.5818     1.5616   4.855  0.00126 **
xx            0.9818     0.2925   3.356  0.00998 **
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.657 on 8 degrees of freedom
Multiple R-squared:  0.5848,    Adjusted R-squared:  0.5329 
F-statistic: 11.27 on 1 and 8 DF,  p-value: 0.009984</code></pre>
</div>
</div>
</section>
<section id="residual-plot-1" class="slide level2">
<h2>Residual plot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="fu">ggplot</span>(curvy<span class="fl">.1</span>, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="regression_files/figure-revealjs/altoadige-1.png" width="960" class="r-stretch"></section>
<section id="no-good-fixing-it-up" class="slide level2">
<h2>No good: fixing it up</h2>
<ul>
<li><p>Residual plot has <em>curve</em>: middle residuals positive, high and low ones negative. Bad.</p></li>
<li><p>Fitting a curve would be better. Try this:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>curvy<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(yy <span class="sc">~</span> xx <span class="sc">+</span> <span class="fu">I</span>(xx<span class="sc">^</span><span class="dv">2</span>), <span class="at">data =</span> curvy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>Adding <code>xx</code>-squared term, to allow for curve.</p></li>
<li><p>Another way to do same thing: specify how model <em>changes</em>:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>curvy<span class="fl">.2</span>a <span class="ot">&lt;-</span> <span class="fu">update</span>(curvy<span class="fl">.1</span>, . <span class="sc">~</span> . <span class="sc">+</span> <span class="fu">I</span>(xx<span class="sc">^</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="regression-2" class="slide level2">
<h2>Regression 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">tidy</span>(curvy<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"3.9000000","3":"0.77311678","4":"5.044516","5":"1.488933e-03"},{"1":"xx","2":"3.7431818","3":"0.40006056","4":"9.356538","5":"3.310959e-05"},{"1":"I(xx^2)","2":"-0.3068182","3":"0.04279273","4":"-7.169866","5":"1.821731e-04"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="fu">glance</span>(curvy<span class="fl">.2</span>) <span class="co">#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["r.squared"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["adj.r.squared"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sigma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["df.residual"],"name":[11],"type":["int"],"align":["right"]},{"label":["nobs"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"0.950234","2":"0.9360151","3":"0.9833021","4":"66.82908","5":"2.749577e-05","6":"2","7":"-12.23762","8":"32.47524","9":"33.68558","10":"6.768182","11":"7","12":"10"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="comments-1" class="slide level2">
<h2>Comments</h2>
<ul>
<li><p><code>xx</code>-squared term definitely significant (P-value 0.000182), so need this curve to describe relationship.</p></li>
<li><p>Adding squared term has made R-squared go up from 0.5848 to 0.9502: great improvement.</p></li>
<li><p>This is a definite curve!</p></li>
</ul>
</section>
<section id="the-residual-plot-now" class="slide level2">
<h2>The residual plot now</h2>
<p>No problems any more:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">ggplot</span>(curvy<span class="fl">.2</span>, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="regression_files/figure-revealjs/bRegression-21-1.png" width="960" class="r-stretch"></section>
<section id="another-way-to-handle-curves" class="slide level2">
<h2>Another way to handle curves</h2>
<ul>
<li><p>Above, saw that changing <span class="math inline">\(x\)</span> (adding <span class="math inline">\(x^2\)</span>) was a way of handling curved relationships.</p></li>
<li><p>Another way: change <span class="math inline">\(y\)</span> (transformation).</p></li>
<li><p>Can guess how to change <span class="math inline">\(y\)</span>, or might be theory:</p></li>
<li><p>example: relationship <span class="math inline">\(y=ae^{bx}\)</span> (exponential growth):</p></li>
<li><p>take logs to get <span class="math inline">\(\ln y=\ln a + bx\)</span>.</p></li>
<li><p>Taking logs has made relationship linear (<span class="math inline">\(\ln y\)</span> as response).</p></li>
<li><p>Or, <em>estimate</em> transformation, using Box-Cox method.</p></li>
</ul>
</section>
<section id="box-cox" class="slide level2">
<h2>Box-Cox</h2>
<ul>
<li><p>Install package <code>MASS</code> via <code>install.packages("MASS")</code> (only need to do <em>once</em>)</p></li>
<li><p>Every R session you want to use something in <code>MASS</code>, type <code>library(MASS)</code></p></li>
</ul>
</section>
<section id="some-made-up-data" class="slide level2">
<h2>Some made-up data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/madeup2.csv"</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>madeup <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(my_url)</span>
<span id="cb32-3"><a href="#cb32-3"></a>madeup</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["...1"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["x"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"0","3":"17.92576"},{"1":"2","2":"1","3":"33.58480"},{"1":"3","2":"2","3":"82.69371"},{"1":"4","2":"3","3":"31.19415"},{"1":"5","2":"4","3":"177.07919"},{"1":"6","2":"5","3":"358.70001"},{"1":"7","2":"6","3":"469.30232"},{"1":"8","2":"7","3":"283.24106"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Seems to be faster-than-linear growth, maybe exponential growth.</p>
</section>
<section id="scatterplot-faster-than-linear-growth" class="slide level2">
<h2>Scatterplot: faster than linear growth</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">ggplot</span>(madeup, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="regression_files/figure-revealjs/dsljhsdjlhf-1.png" width="960" class="r-stretch"></section>
<section id="running-box-cox" class="slide level2">
<h2>Running Box-Cox</h2>
<ul>
<li><p><code>library(MASS)</code> first.</p></li>
<li><p>Feed <code>boxcox</code> a model formula with a squiggle in it, such as you would use for <code>lm</code>.</p></li>
<li><p>Output: a graph (next page):</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu">boxcox</span>(y <span class="sc">~</span> x, <span class="at">data =</span> madeup)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-box-cox-output" class="slide level2">
<h2>The Box-Cox output</h2>

<img data-src="regression_files/figure-revealjs/trento-1.png" width="960" class="r-stretch"></section>
<section id="comments-2" class="slide level2">
<h2>Comments</h2>
<ul>
<li><p><span class="math inline">\(\lambda\)</span> (lambda) is the power by which you should transform <span class="math inline">\(y\)</span> to get the relationship straight (straighter). Power 0 is “take logs”</p></li>
<li><p>Middle dotted line marks best single value of <span class="math inline">\(\lambda\)</span> (here about 0.1).</p></li>
<li><p>Outer dotted lines mark 95% CI for <span class="math inline">\(\lambda\)</span>, here <span class="math inline">\(-0.3\)</span> to 0.7, approx. (Rather uncertain about best transformation.)</p></li>
<li><p>Any power transformation within the CI supported by data. In this case, log (<span class="math inline">\(\lambda=0\)</span>) and square root (<span class="math inline">\(\lambda=0.5\)</span>) good, but no transformation (<span class="math inline">\(\lambda=1\)</span>) not.</p></li>
<li><p>Pick a “round-number” value of <span class="math inline">\(\lambda\)</span> like <span class="math inline">\(2,1,0.5,0,-0.5,-1\)</span>. Here 0 and 0.5 good values to pick.</p></li>
</ul>
</section>
<section id="did-transformation-straighten-things" class="slide level2">
<h2>Did transformation straighten things?</h2>
<ul>
<li>Plot transformed <span class="math inline">\(y\)</span> against <span class="math inline">\(x\)</span>. Here, log:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">ggplot</span>(madeup, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="fu">log</span>(y))) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>  <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="regression_files/figure-revealjs/bRegression-24-1.png" width="960" class="r-stretch"><p>Looks much straighter.</p>
</section>
<section id="regression-with-transformed-y" class="slide level2">
<h2>Regression with transformed <span class="math inline">\(y\)</span></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>madeup<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x, <span class="at">data =</span> madeup)</span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="fu">glance</span>(madeup<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["r.squared"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["adj.r.squared"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sigma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["df.residual"],"name":[11],"type":["int"],"align":["right"]},{"label":["nobs"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"0.8109538","2":"0.7794461","3":"0.587686","4":"25.73828","5":"0.002280572","6":"1","7":"-5.94828","8":"17.89656","9":"18.13488","10":"2.072249","11":"6","12":"8"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">tidy</span>(madeup<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"3.0288444","3":"0.37934967","4":"7.984307","5":"0.0002056931"},{"1":"x","2":"0.4600557","3":"0.09068191","4":"5.073291","5":"0.0022805720"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>R-squared now decently high.</p>
</section>
<section id="multiple-regression" class="slide level2">
<h2>Multiple regression</h2>
<ul>
<li><p>What if more than one <span class="math inline">\(x\)</span>? Extra issues:</p>
<ul>
<li><p>Now one intercept and a slope for each <span class="math inline">\(x\)</span>: how to interpret?</p></li>
<li><p>Which <span class="math inline">\(x\)</span>-variables actually help to predict <span class="math inline">\(y\)</span>?</p></li>
<li><p>Different interpretations of “global” <span class="math inline">\(F\)</span>-test and individual <span class="math inline">\(t\)</span>-tests.</p></li>
<li><p>R-squared no longer correlation squared, but still interpreted as “higher better”.</p></li>
<li><p>In <code>lm</code> line, add extra <span class="math inline">\(x\)</span>s after <code>~</code>.</p></li>
<li><p>Interpretation not so easy (and other problems that can occur).</p></li>
</ul></li>
</ul>
</section>
<section id="multiple-regression-example" class="slide level2">
<h2>Multiple regression example</h2>
<p>Study of women and visits to health professionals, and how the number of visits might be related to other variables:</p>
<p><code>timedrs</code> response, others explanatory.</p>
</section>
<section id="the-data" class="slide level2">
<h2>The data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>my_url <span class="ot">&lt;-</span> </span>
<span id="cb38-2"><a href="#cb38-2"></a>  <span class="st">"http://ritsokiguess.site/datafiles/regressx.txt"</span></span>
<span id="cb38-3"><a href="#cb38-3"></a>visits <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(my_url, <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="check-data-1" class="slide level2">
<h2>Check data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>visits</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["subjno"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["timedrs"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["phyheal"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["menheal"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["stress"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"1","3":"5","4":"8","5":"265"},{"1":"2","2":"3","3":"4","4":"6","5":"415"},{"1":"3","2":"0","3":"3","4":"4","5":"92"},{"1":"4","2":"13","3":"2","4":"2","5":"241"},{"1":"5","2":"15","3":"3","4":"6","5":"86"},{"1":"6","2":"3","3":"5","4":"5","5":"247"},{"1":"7","2":"2","3":"5","4":"6","5":"13"},{"1":"8","2":"0","3":"4","4":"5","5":"12"},{"1":"9","2":"7","3":"5","4":"4","5":"269"},{"1":"10","2":"4","3":"3","4":"9","5":"391"},{"1":"11","2":"15","3":"6","4":"3","5":"237"},{"1":"12","2":"0","3":"3","4":"5","5":"13"},{"1":"13","2":"2","3":"3","4":"10","5":"84"},{"1":"14","2":"13","3":"6","4":"9","5":"144"},{"1":"15","2":"2","3":"3","4":"2","5":"135"},{"1":"16","2":"2","3":"3","4":"4","5":"291"},{"1":"21","2":"1","3":"3","4":"1","5":"98"},{"1":"22","2":"2","3":"7","4":"8","5":"233"},{"1":"23","2":"5","3":"4","4":"6","5":"147"},{"1":"24","2":"5","3":"7","4":"13","5":"308"},{"1":"25","2":"3","3":"4","4":"12","5":"122"},{"1":"26","2":"4","3":"2","4":"3","5":"307"},{"1":"27","2":"2","3":"3","4":"4","5":"248"},{"1":"28","2":"0","3":"5","4":"14","5":"122"},{"1":"29","2":"13","3":"7","4":"10","5":"384"},{"1":"30","2":"7","3":"8","4":"11","5":"433"},{"1":"31","2":"2","3":"6","4":"9","5":"260"},{"1":"32","2":"12","3":"9","4":"12","5":"313"},{"1":"33","2":"2","3":"3","4":"8","5":"400"},{"1":"34","2":"5","3":"7","4":"9","5":"328"},{"1":"35","2":"4","3":"8","4":"4","5":"266"},{"1":"36","2":"6","3":"8","4":"14","5":"422"},{"1":"37","2":"2","3":"6","4":"16","5":"101"},{"1":"38","2":"3","3":"4","4":"11","5":"168"},{"1":"39","2":"14","3":"9","4":"12","5":"402"},{"1":"40","2":"7","3":"8","4":"10","5":"302"},{"1":"45","2":"0","3":"6","4":"0","5":"83"},{"1":"46","2":"1","3":"2","4":"7","5":"244"},{"1":"47","2":"3","3":"3","4":"6","5":"171"},{"1":"48","2":"60","3":"7","4":"6","5":"271"},{"1":"49","2":"5","3":"2","4":"0","5":"53"},{"1":"50","2":"3","3":"5","4":"4","5":"59"},{"1":"51","2":"0","3":"7","4":"6","5":"85"},{"1":"52","2":"3","3":"5","4":"10","5":"64"},{"1":"53","2":"2","3":"2","4":"0","5":"338"},{"1":"54","2":"1","3":"2","4":"4","5":"134"},{"1":"55","2":"1","3":"2","4":"1","5":"70"},{"1":"56","2":"13","3":"8","4":"12","5":"320"},{"1":"57","2":"2","3":"2","4":"1","5":"91"},{"1":"65","2":"5","3":"8","4":"6","5":"270"},{"1":"66","2":"12","3":"7","4":"12","5":"136"},{"1":"67","2":"12","3":"10","4":"18","5":"142"},{"1":"68","2":"1","3":"2","4":"4","5":"259"},{"1":"69","2":"20","3":"3","4":"6","5":"174"},{"1":"70","2":"0","3":"2","4":"3","5":"13"},{"1":"71","2":"5","3":"5","4":"3","5":"390"},{"1":"72","2":"0","3":"3","4":"3","5":"242"},{"1":"73","2":"8","3":"6","4":"3","5":"103"},{"1":"74","2":"9","3":"5","4":"5","5":"338"},{"1":"75","2":"10","3":"9","4":"8","5":"436"},{"1":"76","2":"1","3":"4","4":"3","5":"120"},{"1":"77","2":"5","3":"4","4":"7","5":"361"},{"1":"78","2":"5","3":"4","4":"4","5":"293"},{"1":"79","2":"23","3":"12","4":"4","5":"237"},{"1":"80","2":"7","3":"8","4":"15","5":"244"},{"1":"81","2":"1","3":"2","4":"4","5":"181"},{"1":"82","2":"39","3":"4","4":"7","5":"265"},{"1":"83","2":"2","3":"2","4":"1","5":"38"},{"1":"84","2":"7","3":"5","4":"5","5":"157"},{"1":"85","2":"9","3":"4","4":"10","5":"197"},{"1":"86","2":"0","3":"6","4":"11","5":"159"},{"1":"87","2":"4","3":"5","4":"5","5":"75"},{"1":"88","2":"16","3":"10","4":"5","5":"207"},{"1":"89","2":"0","3":"4","4":"4","5":"83"},{"1":"90","2":"16","3":"3","4":"11","5":"222"},{"1":"91","2":"33","3":"4","4":"6","5":"200"},{"1":"95","2":"4","3":"6","4":"11","5":"251"},{"1":"97","2":"2","3":"3","4":"6","5":"218"},{"1":"98","2":"38","3":"12","4":"11","5":"237"},{"1":"99","2":"8","3":"4","4":"7","5":"139"},{"1":"101","2":"2","3":"8","4":"12","5":"464"},{"1":"102","2":"2","3":"3","4":"5","5":"128"},{"1":"103","2":"0","3":"2","4":"1","5":"0"},{"1":"104","2":"15","3":"8","4":"8","5":"334"},{"1":"105","2":"0","3":"3","4":"0","5":"55"},{"1":"106","2":"1","3":"2","4":"2","5":"169"},{"1":"107","2":"5","3":"5","4":"9","5":"77"},{"1":"108","2":"7","3":"4","4":"3","5":"112"},{"1":"109","2":"10","3":"6","4":"3","5":"164"},{"1":"110","2":"22","3":"7","4":"8","5":"172"},{"1":"111","2":"10","3":"4","4":"7","5":"271"},{"1":"112","2":"0","3":"3","4":"2","5":"69"},{"1":"113","2":"11","3":"3","4":"2","5":"106"},{"1":"114","2":"9","3":"3","4":"1","5":"214"},{"1":"115","2":"0","3":"2","4":"1","5":"10"},{"1":"116","2":"34","3":"10","4":"15","5":"321"},{"1":"117","2":"3","3":"3","4":"4","5":"172"},{"1":"118","2":"1","3":"2","4":"8","5":"320"},{"1":"119","2":"0","3":"4","4":"0","5":"26"},{"1":"120","2":"10","3":"8","4":"11","5":"194"},{"1":"121","2":"4","3":"2","4":"1","5":"122"},{"1":"122","2":"27","3":"6","4":"13","5":"565"},{"1":"123","2":"7","3":"8","4":"18","5":"433"},{"1":"124","2":"1","3":"3","4":"2","5":"314"},{"1":"125","2":"7","3":"6","4":"4","5":"129"},{"1":"126","2":"3","3":"5","4":"10","5":"209"},{"1":"127","2":"2","3":"4","4":"10","5":"417"},{"1":"128","2":"11","3":"6","4":"13","5":"427"},{"1":"129","2":"9","3":"5","4":"5","5":"179"},{"1":"130","2":"11","3":"8","4":"15","5":"174"},{"1":"131","2":"11","3":"5","4":"12","5":"361"},{"1":"132","2":"8","3":"6","4":"5","5":"107"},{"1":"133","2":"2","3":"7","4":"18","5":"338"},{"1":"134","2":"4","3":"4","4":"8","5":"197"},{"1":"135","2":"4","3":"5","4":"1","5":"44"},{"1":"136","2":"6","3":"5","4":"6","5":"345"},{"1":"137","2":"30","3":"11","4":"9","5":"238"},{"1":"138","2":"7","3":"6","4":"11","5":"225"},{"1":"139","2":"15","3":"9","4":"8","5":"531"},{"1":"140","2":"6","3":"11","4":"12","5":"206"},{"1":"141","2":"7","3":"7","4":"6","5":"68"},{"1":"142","2":"2","3":"5","4":"3","5":"12"},{"1":"143","2":"1","3":"2","4":"2","5":"155"},{"1":"144","2":"5","3":"5","4":"8","5":"220"},{"1":"145","2":"1","3":"3","4":"16","5":"377"},{"1":"146","2":"11","3":"7","4":"1","5":"241"},{"1":"148","2":"16","3":"8","4":"7","5":"165"},{"1":"149","2":"2","3":"2","4":"1","5":"356"},{"1":"150","2":"14","3":"6","4":"5","5":"81"},{"1":"151","2":"8","3":"5","4":"9","5":"81"},{"1":"152","2":"17","3":"8","4":"15","5":"169"},{"1":"153","2":"1","3":"2","4":"6","5":"168"},{"1":"154","2":"0","3":"2","4":"2","5":"72"},{"1":"155","2":"1","3":"2","4":"0","5":"105"},{"1":"156","2":"1","3":"3","4":"2","5":"41"},{"1":"157","2":"10","3":"7","4":"16","5":"334"},{"1":"158","2":"7","3":"6","4":"13","5":"282"},{"1":"159","2":"2","3":"3","4":"0","5":"93"},{"1":"160","2":"5","3":"4","4":"5","5":"227"},{"1":"166","2":"6","3":"4","4":"12","5":"310"},{"1":"167","2":"1","3":"3","4":"1","5":"265"},{"1":"183","2":"16","3":"9","4":"12","5":"272"},{"1":"184","2":"0","3":"6","4":"5","5":"207"},{"1":"185","2":"17","3":"11","4":"17","5":"534"},{"1":"187","2":"0","3":"4","4":"1","5":"169"},{"1":"190","2":"10","3":"3","4":"8","5":"577"},{"1":"192","2":"6","3":"8","4":"2","5":"236"},{"1":"202","2":"20","3":"7","4":"5","5":"62"},{"1":"203","2":"1","3":"3","4":"3","5":"64"},{"1":"204","2":"25","3":"4","4":"6","5":"160"},{"1":"205","2":"3","3":"5","4":"3","5":"130"},{"1":"206","2":"6","3":"3","4":"0","5":"270"},{"1":"208","2":"0","3":"2","4":"0","5":"50"},{"1":"210","2":"8","3":"5","4":"10","5":"149"},{"1":"212","2":"9","3":"9","4":"4","5":"312"},{"1":"213","2":"19","3":"7","4":"10","5":"303"},{"1":"214","2":"2","3":"2","4":"0","5":"133"},{"1":"225","2":"2","3":"3","4":"7","5":"278"},{"1":"226","2":"3","3":"2","4":"0","5":"441"},{"1":"227","2":"7","3":"4","4":"5","5":"253"},{"1":"228","2":"2","3":"4","4":"16","5":"256"},{"1":"229","2":"8","3":"6","4":"5","5":"127"},{"1":"230","2":"49","3":"10","4":"9","5":"113"},{"1":"231","2":"2","3":"3","4":"7","5":"221"},{"1":"232","2":"1","3":"2","4":"6","5":"279"},{"1":"233","2":"5","3":"6","4":"7","5":"189"},{"1":"234","2":"5","3":"3","4":"13","5":"282"},{"1":"235","2":"60","3":"6","4":"11","5":"529"},{"1":"236","2":"10","3":"4","4":"2","5":"236"},{"1":"237","2":"27","3":"3","4":"8","5":"392"},{"1":"238","2":"7","3":"6","4":"8","5":"216"},{"1":"239","2":"8","3":"5","4":"8","5":"13"},{"1":"240","2":"12","3":"5","4":"0","5":"245"},{"1":"241","2":"2","3":"3","4":"1","5":"194"},{"1":"242","2":"2","3":"3","4":"3","5":"74"},{"1":"243","2":"4","3":"4","4":"2","5":"306"},{"1":"244","2":"6","3":"7","4":"9","5":"235"},{"1":"245","2":"27","3":"12","4":"12","5":"304"},{"1":"246","2":"0","3":"2","4":"5","5":"352"},{"1":"247","2":"9","3":"10","4":"8","5":"98"},{"1":"248","2":"3","3":"2","4":"5","5":"75"},{"1":"249","2":"0","3":"4","4":"4","5":"128"},{"1":"250","2":"2","3":"3","4":"4","5":"171"},{"1":"251","2":"3","3":"3","4":"4","5":"82"},{"1":"252","2":"5","3":"4","4":"1","5":"268"},{"1":"253","2":"5","3":"6","4":"9","5":"100"},{"1":"254","2":"1","3":"4","4":"6","5":"271"},{"1":"255","2":"7","3":"6","4":"4","5":"112"},{"1":"258","2":"4","3":"6","4":"5","5":"301"},{"1":"259","2":"3","3":"5","4":"4","5":"174"},{"1":"260","2":"7","3":"6","4":"7","5":"336"},{"1":"261","2":"1","3":"2","4":"6","5":"63"},{"1":"262","2":"52","3":"6","4":"6","5":"225"},{"1":"263","2":"6","3":"6","4":"6","5":"421"},{"1":"264","2":"18","3":"8","4":"7","5":"597"},{"1":"265","2":"14","3":"5","4":"2","5":"13"},{"1":"266","2":"0","3":"3","4":"6","5":"71"},{"1":"267","2":"8","3":"8","4":"17","5":"88"},{"1":"268","2":"16","3":"5","4":"1","5":"20"},{"1":"269","2":"2","3":"4","4":"3","5":"94"},{"1":"270","2":"12","3":"6","4":"5","5":"174"},{"1":"271","2":"3","3":"6","4":"1","5":"214"},{"1":"272","2":"24","3":"8","4":"8","5":"147"},{"1":"273","2":"0","3":"3","4":"2","5":"80"},{"1":"274","2":"0","3":"4","4":"1","5":"69"},{"1":"276","2":"57","3":"11","4":"4","5":"268"},{"1":"277","2":"11","3":"8","4":"13","5":"138"},{"1":"278","2":"1","3":"4","4":"6","5":"196"},{"1":"279","2":"18","3":"9","4":"10","5":"546"},{"1":"280","2":"1","3":"2","4":"1","5":"112"},{"1":"289","2":"11","3":"4","4":"7","5":"265"},{"1":"290","2":"0","3":"4","4":"2","5":"254"},{"1":"291","2":"52","3":"6","4":"2","5":"156"},{"1":"292","2":"12","3":"7","4":"8","5":"257"},{"1":"293","2":"6","3":"5","4":"6","5":"170"},{"1":"294","2":"0","3":"2","4":"7","5":"160"},{"1":"295","2":"2","3":"3","4":"2","5":"426"},{"1":"299","2":"2","3":"5","4":"12","5":"159"},{"1":"300","2":"13","3":"5","4":"13","5":"104"},{"1":"301","2":"2","3":"3","4":"0","5":"59"},{"1":"302","2":"3","3":"5","4":"1","5":"63"},{"1":"303","2":"2","3":"5","4":"3","5":"185"},{"1":"304","2":"2","3":"6","4":"10","5":"211"},{"1":"305","2":"1","3":"8","4":"11","5":"358"},{"1":"306","2":"2","3":"2","4":"0","5":"69"},{"1":"307","2":"3","3":"5","4":"1","5":"488"},{"1":"308","2":"1","3":"3","4":"4","5":"89"},{"1":"309","2":"5","3":"4","4":"6","5":"330"},{"1":"310","2":"6","3":"6","4":"9","5":"67"},{"1":"311","2":"1","3":"4","4":"3","5":"76"},{"1":"312","2":"2","3":"3","4":"3","5":"391"},{"1":"313","2":"3","3":"4","4":"1","5":"202"},{"1":"314","2":"7","3":"6","4":"13","5":"126"},{"1":"315","2":"7","3":"6","4":"5","5":"82"},{"1":"316","2":"0","3":"2","4":"1","5":"164"},{"1":"317","2":"7","3":"5","4":"13","5":"81"},{"1":"318","2":"8","3":"9","4":"1","5":"143"},{"1":"319","2":"9","3":"7","4":"4","5":"204"},{"1":"320","2":"8","3":"2","4":"5","5":"97"},{"1":"321","2":"1","3":"3","4":"7","5":"152"},{"1":"322","2":"14","3":"7","4":"13","5":"160"},{"1":"323","2":"2","3":"4","4":"4","5":"79"},{"1":"324","2":"4","3":"3","4":"6","5":"102"},{"1":"325","2":"8","3":"3","4":"11","5":"520"},{"1":"326","2":"3","3":"4","4":"5","5":"88"},{"1":"327","2":"10","3":"5","4":"9","5":"162"},{"1":"328","2":"21","3":"9","4":"16","5":"191"},{"1":"329","2":"6","3":"6","4":"7","5":"380"},{"1":"330","2":"58","3":"5","4":"6","5":"328"},{"1":"335","2":"12","3":"9","4":"7","5":"215"},{"1":"336","2":"5","3":"3","4":"4","5":"183"},{"1":"337","2":"2","3":"3","4":"4","5":"444"},{"1":"338","2":"2","3":"6","4":"11","5":"122"},{"1":"339","2":"4","3":"7","4":"10","5":"197"},{"1":"340","2":"2","3":"4","4":"4","5":"153"},{"1":"341","2":"5","3":"6","4":"9","5":"178"},{"1":"342","2":"0","3":"2","4":"0","5":"0"},{"1":"343","2":"3","3":"2","4":"5","5":"177"},{"1":"344","2":"7","3":"5","4":"3","5":"371"},{"1":"345","2":"1","3":"6","4":"10","5":"308"},{"1":"346","2":"2","3":"2","4":"5","5":"33"},{"1":"347","2":"1","3":"3","4":"7","5":"278"},{"1":"348","2":"4","3":"3","4":"7","5":"356"},{"1":"349","2":"4","3":"5","4":"4","5":"191"},{"1":"355","2":"4","3":"2","4":"6","5":"234"},{"1":"357","2":"2","3":"3","4":"6","5":"101"},{"1":"358","2":"0","3":"3","4":"10","5":"186"},{"1":"359","2":"13","3":"5","4":"3","5":"275"},{"1":"361","2":"3","3":"7","4":"9","5":"139"},{"1":"362","2":"1","3":"3","4":"7","5":"37"},{"1":"363","2":"4","3":"5","4":"8","5":"364"},{"1":"365","2":"1","3":"3","4":"0","5":"25"},{"1":"367","2":"3","3":"4","4":"3","5":"226"},{"1":"369","2":"1","3":"4","4":"6","5":"180"},{"1":"370","2":"57","3":"6","4":"13","5":"85"},{"1":"372","2":"1","3":"2","4":"4","5":"49"},{"1":"374","2":"17","3":"15","4":"10","5":"258"},{"1":"378","2":"11","3":"8","4":"5","5":"99"},{"1":"379","2":"43","3":"4","4":"9","5":"567"},{"1":"380","2":"6","3":"7","4":"1","5":"13"},{"1":"381","2":"6","3":"6","4":"5","5":"282"},{"1":"382","2":"1","3":"3","4":"1","5":"171"},{"1":"383","2":"0","3":"3","4":"6","5":"114"},{"1":"384","2":"10","3":"11","4":"7","5":"266"},{"1":"385","2":"3","3":"6","4":"1","5":"159"},{"1":"386","2":"37","3":"4","4":"14","5":"263"},{"1":"387","2":"6","3":"3","4":"1","5":"236"},{"1":"392","2":"11","3":"6","4":"2","5":"129"},{"1":"397","2":"4","3":"3","4":"0","5":"98"},{"1":"398","2":"75","3":"9","4":"12","5":"244"},{"1":"399","2":"7","3":"6","4":"12","5":"547"},{"1":"400","2":"3","3":"6","4":"15","5":"347"},{"1":"401","2":"3","3":"6","4":"13","5":"309"},{"1":"402","2":"3","3":"5","4":"9","5":"264"},{"1":"403","2":"4","3":"4","4":"5","5":"66"},{"1":"404","2":"5","3":"5","4":"7","5":"330"},{"1":"405","2":"2","3":"5","4":"0","5":"90"},{"1":"406","2":"4","3":"6","4":"3","5":"462"},{"1":"407","2":"2","3":"2","4":"4","5":"77"},{"1":"413","2":"11","3":"7","4":"15","5":"432"},{"1":"414","2":"0","3":"3","4":"8","5":"212"},{"1":"417","2":"2","3":"7","4":"6","5":"228"},{"1":"418","2":"4","3":"4","4":"2","5":"326"},{"1":"420","2":"6","3":"8","4":"10","5":"594"},{"1":"421","2":"0","3":"5","4":"4","5":"87"},{"1":"424","2":"2","3":"4","4":"5","5":"440"},{"1":"425","2":"5","3":"7","4":"7","5":"77"},{"1":"434","2":"2","3":"5","4":"8","5":"63"},{"1":"435","2":"10","3":"7","4":"12","5":"389"},{"1":"436","2":"29","3":"9","4":"14","5":"333"},{"1":"437","2":"3","3":"7","4":"9","5":"99"},{"1":"438","2":"0","3":"3","4":"7","5":"241"},{"1":"439","2":"21","3":"3","4":"8","5":"476"},{"1":"440","2":"0","3":"3","4":"6","5":"41"},{"1":"441","2":"3","3":"3","4":"4","5":"17"},{"1":"442","2":"1","3":"3","4":"6","5":"122"},{"1":"443","2":"9","3":"4","4":"3","5":"337"},{"1":"444","2":"3","3":"4","4":"10","5":"188"},{"1":"445","2":"3","3":"3","4":"3","5":"228"},{"1":"446","2":"5","3":"11","4":"7","5":"263"},{"1":"447","2":"6","3":"4","4":"2","5":"139"},{"1":"448","2":"4","3":"5","4":"4","5":"208"},{"1":"451","2":"16","3":"5","4":"5","5":"101"},{"1":"452","2":"3","3":"5","4":"2","5":"278"},{"1":"453","2":"13","3":"8","4":"8","5":"331"},{"1":"454","2":"3","3":"3","4":"5","5":"151"},{"1":"455","2":"2","3":"4","4":"4","5":"135"},{"1":"456","2":"2","3":"4","4":"1","5":"0"},{"1":"457","2":"3","3":"5","4":"1","5":"208"},{"1":"458","2":"7","3":"3","4":"2","5":"181"},{"1":"459","2":"2","3":"3","4":"0","5":"104"},{"1":"460","2":"2","3":"3","4":"1","5":"76"},{"1":"461","2":"2","3":"2","4":"0","5":"211"},{"1":"462","2":"2","3":"3","4":"3","5":"39"},{"1":"463","2":"5","3":"5","4":"1","5":"150"},{"1":"464","2":"3","3":"4","4":"3","5":"210"},{"1":"465","2":"2","3":"3","4":"0","5":"15"},{"1":"466","2":"4","3":"6","4":"4","5":"131"},{"1":"467","2":"1","3":"2","4":"0","5":"0"},{"1":"469","2":"3","3":"3","4":"0","5":"205"},{"1":"472","2":"6","3":"4","4":"2","5":"163"},{"1":"473","2":"4","3":"5","4":"2","5":"201"},{"1":"474","2":"30","3":"6","4":"1","5":"224"},{"1":"476","2":"0","3":"2","4":"0","5":"69"},{"1":"479","2":"25","3":"2","4":"2","5":"62"},{"1":"480","2":"0","3":"5","4":"1","5":"62"},{"1":"481","2":"5","3":"3","4":"3","5":"204"},{"1":"482","2":"3","3":"4","4":"5","5":"162"},{"1":"483","2":"2","3":"2","4":"5","5":"221"},{"1":"484","2":"2","3":"2","4":"2","5":"221"},{"1":"485","2":"9","3":"12","4":"6","5":"348"},{"1":"486","2":"2","3":"3","4":"0","5":"341"},{"1":"487","2":"13","3":"3","4":"3","5":"336"},{"1":"488","2":"1","3":"3","4":"6","5":"343"},{"1":"489","2":"4","3":"6","4":"6","5":"177"},{"1":"490","2":"4","3":"3","4":"8","5":"274"},{"1":"491","2":"3","3":"4","4":"4","5":"290"},{"1":"492","2":"7","3":"10","4":"2","5":"174"},{"1":"493","2":"7","3":"5","4":"5","5":"111"},{"1":"494","2":"14","3":"3","4":"2","5":"246"},{"1":"495","2":"4","3":"4","4":"7","5":"181"},{"1":"496","2":"15","3":"6","4":"10","5":"336"},{"1":"497","2":"37","3":"7","4":"5","5":"55"},{"1":"498","2":"2","3":"4","4":"8","5":"178"},{"1":"499","2":"4","3":"3","4":"6","5":"98"},{"1":"500","2":"6","3":"5","4":"12","5":"85"},{"1":"501","2":"10","3":"5","4":"1","5":"66"},{"1":"502","2":"56","3":"8","4":"2","5":"316"},{"1":"503","2":"3","3":"4","4":"4","5":"139"},{"1":"504","2":"0","3":"2","4":"2","5":"28"},{"1":"505","2":"18","3":"10","4":"15","5":"421"},{"1":"506","2":"3","3":"4","4":"5","5":"237"},{"1":"507","2":"18","3":"14","4":"16","5":"494"},{"1":"508","2":"7","3":"4","4":"8","5":"66"},{"1":"509","2":"29","3":"9","4":"3","5":"93"},{"1":"510","2":"0","3":"2","4":"7","5":"90"},{"1":"511","2":"5","3":"6","4":"8","5":"227"},{"1":"512","2":"4","3":"5","4":"6","5":"273"},{"1":"513","2":"3","3":"5","4":"11","5":"171"},{"1":"514","2":"6","3":"6","4":"8","5":"76"},{"1":"515","2":"21","3":"13","4":"12","5":"404"},{"1":"516","2":"1","3":"2","4":"5","5":"12"},{"1":"517","2":"3","3":"2","4":"8","5":"380"},{"1":"518","2":"3","3":"3","4":"3","5":"101"},{"1":"519","2":"0","3":"2","4":"2","5":"68"},{"1":"520","2":"13","3":"7","4":"12","5":"282"},{"1":"521","2":"5","3":"3","4":"5","5":"0"},{"1":"522","2":"5","3":"4","4":"5","5":"277"},{"1":"523","2":"37","3":"9","4":"15","5":"392"},{"1":"524","2":"2","3":"4","4":"1","5":"49"},{"1":"525","2":"11","3":"13","4":"16","5":"372"},{"1":"526","2":"13","3":"6","4":"12","5":"482"},{"1":"527","2":"2","3":"2","4":"1","5":"81"},{"1":"528","2":"4","3":"5","4":"5","5":"76"},{"1":"529","2":"21","3":"7","4":"11","5":"329"},{"1":"530","2":"2","3":"4","4":"6","5":"12"},{"1":"533","2":"4","3":"4","4":"10","5":"158"},{"1":"534","2":"3","3":"4","4":"5","5":"15"},{"1":"535","2":"3","3":"8","4":"5","5":"105"},{"1":"536","2":"12","3":"5","4":"7","5":"266"},{"1":"538","2":"1","3":"2","4":"2","5":"0"},{"1":"539","2":"4","3":"3","4":"2","5":"396"},{"1":"540","2":"13","3":"9","4":"7","5":"920"},{"1":"547","2":"2","3":"3","4":"4","5":"153"},{"1":"548","2":"81","3":"5","4":"7","5":"731"},{"1":"549","2":"12","3":"4","4":"3","5":"364"},{"1":"550","2":"2","3":"2","4":"3","5":"33"},{"1":"551","2":"16","3":"6","4":"8","5":"386"},{"1":"552","2":"27","3":"9","4":"6","5":"79"},{"1":"553","2":"2","3":"6","4":"10","5":"320"},{"1":"554","2":"2","3":"4","4":"1","5":"178"},{"1":"555","2":"8","3":"6","4":"5","5":"108"},{"1":"556","2":"2","3":"3","4":"1","5":"157"},{"1":"557","2":"4","3":"4","4":"6","5":"12"},{"1":"558","2":"3","3":"3","4":"3","5":"25"},{"1":"559","2":"19","3":"6","4":"6","5":"104"},{"1":"560","2":"4","3":"3","4":"3","5":"91"},{"1":"567","2":"1","3":"2","4":"4","5":"291"},{"1":"568","2":"3","3":"2","4":"8","5":"85"},{"1":"569","2":"15","3":"7","4":"4","5":"25"},{"1":"570","2":"4","3":"5","4":"6","5":"130"},{"1":"571","2":"4","3":"3","4":"3","5":"147"},{"1":"572","2":"13","3":"10","4":"12","5":"155"},{"1":"573","2":"6","3":"3","4":"4","5":"108"},{"1":"574","2":"1","3":"5","4":"9","5":"523"},{"1":"575","2":"3","3":"7","4":"8","5":"53"},{"1":"576","2":"3","3":"5","4":"6","5":"306"},{"1":"577","2":"0","3":"5","4":"6","5":"171"},{"1":"578","2":"22","3":"7","4":"5","5":"158"},{"1":"579","2":"4","3":"3","4":"3","5":"25"},{"1":"580","2":"14","3":"6","4":"4","5":"398"},{"1":"581","2":"6","3":"6","4":"13","5":"252"},{"1":"582","2":"16","3":"5","4":"14","5":"538"},{"1":"583","2":"6","3":"5","4":"7","5":"124"},{"1":"584","2":"0","3":"3","4":"7","5":"75"},{"1":"585","2":"8","3":"5","4":"15","5":"237"},{"1":"586","2":"0","3":"3","4":"4","5":"118"},{"1":"587","2":"4","3":"5","4":"7","5":"302"},{"1":"588","2":"5","3":"8","4":"10","5":"170"},{"1":"589","2":"2","3":"2","4":"1","5":"171"},{"1":"590","2":"6","3":"4","4":"7","5":"73"},{"1":"591","2":"11","3":"4","4":"10","5":"176"},{"1":"592","2":"1","3":"4","4":"3","5":"176"},{"1":"593","2":"23","3":"8","4":"11","5":"643"},{"1":"683","2":"4","3":"4","4":"12","5":"179"},{"1":"685","2":"4","3":"6","4":"2","5":"0"},{"1":"686","2":"16","3":"8","4":"14","5":"132"},{"1":"687","2":"6","3":"4","4":"3","5":"159"},{"1":"688","2":"1","3":"2","4":"4","5":"110"},{"1":"689","2":"2","3":"3","4":"6","5":"75"},{"1":"690","2":"6","3":"9","4":"10","5":"272"},{"1":"691","2":"6","3":"6","4":"5","5":"152"},{"1":"706","2":"3","3":"4","4":"12","5":"119"},{"1":"707","2":"1","3":"2","4":"0","5":"52"},{"1":"708","2":"15","3":"6","4":"12","5":"252"},{"1":"709","2":"3","3":"4","4":"9","5":"234"},{"1":"710","2":"7","3":"7","4":"4","5":"214"},{"1":"711","2":"9","3":"4","4":"1","5":"183"},{"1":"717","2":"18","3":"6","4":"10","5":"166"},{"1":"724","2":"14","3":"8","4":"9","5":"331"},{"1":"754","2":"3","3":"3","4":"6","5":"73"},{"1":"755","2":"4","3":"4","4":"0","5":"66"},{"1":"756","2":"15","3":"9","4":"6","5":"142"},{"1":"757","2":"4","3":"6","4":"4","5":"87"},{"1":"758","2":"3","3":"5","4":"2","5":"149"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="fit-multiple-regression" class="slide level2">
<h2>Fit multiple regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>visits<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(timedrs <span class="sc">~</span> phyheal <span class="sc">+</span> menheal <span class="sc">+</span> stress,</span>
<span id="cb40-2"><a href="#cb40-2"></a>  <span class="at">data =</span> visits)</span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="fu">summary</span>(visits<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = timedrs ~ phyheal + menheal + stress, data = visits)

Residuals:
    Min      1Q  Median      3Q     Max 
-14.792  -4.353  -1.815   0.902  65.886 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -3.704848   1.124195  -3.296 0.001058 ** 
phyheal      1.786948   0.221074   8.083  5.6e-15 ***
menheal     -0.009666   0.129029  -0.075 0.940318    
stress       0.013615   0.003612   3.769 0.000185 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.708 on 461 degrees of freedom
Multiple R-squared:  0.2188,    Adjusted R-squared:  0.2137 
F-statistic: 43.03 on 3 and 461 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="the-slopes" class="slide level2">
<h2>The slopes</h2>
<ul>
<li><p>Model as a whole strongly significant even though R-sq not very big (lots of data). At least one of the <span class="math inline">\(x\)</span>’s predicts <code>timedrs</code>.</p></li>
<li><p>The physical health and stress variables definitely help to predict the number of visits, but <em>with those in the model</em> we don’t need <code>menheal</code>. However, look at prediction of <code>timedrs</code> from <code>menheal</code> by itself:</p></li>
</ul>
</section>
<section id="just-menheal" class="slide level2">
<h2>Just <code>menheal</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>visits<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(timedrs <span class="sc">~</span> menheal, <span class="at">data =</span> visits)</span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="fu">summary</span>(visits<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = timedrs ~ menheal, data = visits)

Residuals:
    Min      1Q  Median      3Q     Max 
-13.826  -5.150  -2.818   1.177  72.513 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   3.8159     0.8702   4.385 1.44e-05 ***
menheal       0.6672     0.1173   5.688 2.28e-08 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 10.6 on 463 degrees of freedom
Multiple R-squared:  0.06532,   Adjusted R-squared:  0.0633 
F-statistic: 32.35 on 1 and 463 DF,  p-value: 2.279e-08</code></pre>
</div>
</div>
</section>
<section id="menheal-by-itself" class="slide level2">
<h2><code>menheal</code> by itself</h2>
<ul>
<li><p><code>menheal</code> by itself <em>does</em> significantly help to predict <code>timedrs</code>.</p></li>
<li><p>But the R-sq is much less (6.5% vs.&nbsp;22%).</p></li>
<li><p>So other two variables do a better job of prediction.</p></li>
<li><p>With those variables in the regression (<code>phyheal</code> and <code>stress</code>), don’t need <code>menheal</code> <em>as well</em>.</p></li>
</ul>
</section>
<section id="investigating-via-correlation" class="slide level2">
<h2>Investigating via correlation</h2>
<p>Leave out first column (<code>subjno</code>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>visits <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>subjno) <span class="sc">%&gt;%</span> <span class="fu">cor</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          timedrs   phyheal   menheal    stress
timedrs 1.0000000 0.4395293 0.2555703 0.2865951
phyheal 0.4395293 1.0000000 0.5049464 0.3055517
menheal 0.2555703 0.5049464 1.0000000 0.3697911
stress  0.2865951 0.3055517 0.3697911 1.0000000</code></pre>
</div>
</div>
<ul>
<li><p><code>phyheal</code> most strongly correlated with <code>timedrs</code>.</p></li>
<li><p>Not much to choose between other two.</p></li>
<li><p>But <code>menheal</code> has higher correlation with <code>phyheal</code>, so not as much to <em>add</em> to prediction as <code>stress</code>.</p></li>
<li><p>Goes to show things more complicated in multiple regression.</p></li>
</ul>
</section>
<section id="residual-plot-from-timedrs-on-all" class="slide level2">
<h2>Residual plot (from <code>timedrs</code> on all)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">ggplot</span>(visits<span class="fl">.1</span>, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="regression_files/figure-revealjs/iffy8-1.png" width="960" class="r-stretch"><p>Apparently random. But…</p>
</section>
<section id="normal-quantile-plot-of-residuals" class="slide level2">
<h2>Normal quantile plot of residuals</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="fu">ggplot</span>(visits<span class="fl">.1</span>, <span class="fu">aes</span>(<span class="at">sample =</span> .resid)) <span class="sc">+</span> <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="regression_files/figure-revealjs/bRegression-32-1.png" width="960" class="r-stretch"><p>Not normal at all; upper tail is way too long.</p>
</section>
<section id="absolute-residuals" class="slide level2">
<h2>Absolute residuals</h2>
<p>Is there trend in <em>size</em> of residuals (fan-out)? Plot <em>absolute value</em> of residual against fitted value:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">ggplot</span>(visits<span class="fl">.1</span>, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> <span class="fu">abs</span>(.resid))) <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="regression_files/figure-revealjs/bRegression-33-1.png" width="960" class="r-stretch"></section>
<section id="comments-3" class="slide level2">
<h2>Comments</h2>
<ul>
<li><p>On the normal quantile plot:</p>
<ul>
<li><p>highest (most positive) residuals are <em>way</em> too high</p></li>
<li><p>distribution of residuals skewed to right (not normal at all)</p></li>
</ul></li>
<li><p>On plot of absolute residuals:</p>
<ul>
<li><p>size of residuals getting bigger as fitted values increase</p></li>
<li><p>predictions getting more variable as fitted values increase</p></li>
<li><p>that is, predictions getting <em>less accurate</em> as fitted values increase, but predictions should be equally accurate all way along.</p></li>
</ul></li>
<li><p>Both indicate problems with regression, of kind that transformation of response often fixes: that is, predict <em>function</em> of response <code>timedrs</code> instead of <code>timedrs</code> itself.</p></li>
</ul>
</section>
<section id="box-cox-transformations" class="slide level2">
<h2>Box-Cox transformations</h2>
<ul>
<li><p>Taking log of <code>timedrs</code> and having it work: lucky guess. How to find good transformation?</p></li>
<li><p>Box-Cox again.</p></li>
<li><p>Extra problem: some of <code>timedrs</code> values are 0, but Box-Cox expects all +. Note response for <code>boxcox</code>:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">boxcox</span>(timedrs <span class="sc">+</span> <span class="dv">1</span> <span class="sc">~</span> phyheal <span class="sc">+</span> menheal <span class="sc">+</span> stress, <span class="at">data =</span> visits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="try-1" class="slide level2">
<h2>Try 1</h2>

<img data-src="regression_files/figure-revealjs/bRegression-36-1.png" width="960" class="r-stretch"></section>
<section id="comments-on-try-1" class="slide level2">
<h2>Comments on try 1</h2>
<ul>
<li><p>Best: <span class="math inline">\(\lambda\)</span> just less than zero.</p></li>
<li><p>Hard to see scale.</p></li>
<li><p>Focus on <span class="math inline">\(\lambda\)</span> in <span class="math inline">\((-0.3,0.1)\)</span>:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>my.lambda <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span>)</span>
<span id="cb50-2"><a href="#cb50-2"></a>my.lambda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -0.30 -0.29 -0.28 -0.27 -0.26 -0.25 -0.24 -0.23 -0.22
[10] -0.21 -0.20 -0.19 -0.18 -0.17 -0.16 -0.15 -0.14 -0.13
[19] -0.12 -0.11 -0.10 -0.09 -0.08 -0.07 -0.06 -0.05 -0.04
[28] -0.03 -0.02 -0.01  0.00  0.01  0.02  0.03  0.04  0.05
[37]  0.06  0.07  0.08  0.09  0.10</code></pre>
</div>
</div>
</section>
<section id="try-2" class="slide level2">
<h2>Try 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="fu">boxcox</span>(timedrs <span class="sc">+</span> <span class="dv">1</span> <span class="sc">~</span> phyheal <span class="sc">+</span> menheal <span class="sc">+</span> stress,</span>
<span id="cb52-2"><a href="#cb52-2"></a>  <span class="at">lambda =</span> my.lambda,</span>
<span id="cb52-3"><a href="#cb52-3"></a>  <span class="at">data =</span> visits</span>
<span id="cb52-4"><a href="#cb52-4"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="regression_files/figure-revealjs/bRegression-38-1.png" width="960" class="r-stretch"></section>
<section id="comments-4" class="slide level2">
<h2>Comments</h2>
<ul>
<li><p>Best: <span class="math inline">\(\lambda\)</span> just about <span class="math inline">\(-0.07\)</span>.</p></li>
<li><p>CI for <span class="math inline">\(\lambda\)</span> about <span class="math inline">\((-0.14,0.01)\)</span>.</p></li>
<li><p>Only nearby round number: <span class="math inline">\(\lambda=0\)</span>, log transformation.</p></li>
</ul>
</section>
<section id="fixing-the-problems" class="slide level2">
<h2>Fixing the problems</h2>
<ul>
<li><p>Try regression again, with transformed response instead of original one.</p></li>
<li><p>Then check residual plot to see that it is OK now.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>visits<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(timedrs <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> phyheal <span class="sc">+</span> menheal <span class="sc">+</span> stress,</span>
<span id="cb53-2"><a href="#cb53-2"></a>  <span class="at">data =</span> visits</span>
<span id="cb53-3"><a href="#cb53-3"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p><code>timedrs+1</code> because some <code>timedrs</code> values 0, can’t take log of 0.</p></li>
<li><p>Won’t usually need to worry about this, but when response could be zero/negative, fix that before transformation.</p></li>
</ul>
</section>
<section id="output" class="slide level2">
<h2>Output</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="fu">summary</span>(visits<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(timedrs + 1) ~ phyheal + menheal + stress, data = visits)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.95865 -0.44076 -0.02331  0.42304  2.36797 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 0.3903862  0.0882908   4.422 1.22e-05 ***
phyheal     0.2019361  0.0173624  11.631  &lt; 2e-16 ***
menheal     0.0071442  0.0101335   0.705    0.481    
stress      0.0013158  0.0002837   4.638 4.58e-06 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7625 on 461 degrees of freedom
Multiple R-squared:  0.3682,    Adjusted R-squared:  0.3641 
F-statistic: 89.56 on 3 and 461 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="comments-5" class="slide level2">
<h2>Comments</h2>
<ul>
<li><p>Model as a whole strongly significant again</p></li>
<li><p>R-sq higher than before (37% vs.&nbsp;22%) suggesting things more linear now</p></li>
<li><p>Same conclusion re <code>menheal</code>: can take out of regression.</p></li>
<li><p>Should look at residual plots (next pages). Have we fixed problems?</p></li>
</ul>
</section>
<section id="residuals-against-fitted-values" class="slide level2">
<h2>Residuals against fitted values</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="fu">ggplot</span>(visits<span class="fl">.3</span>, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="regression_files/figure-revealjs/bRegression-41-1.png" width="960" class="r-stretch"></section>
<section id="normal-quantile-plot-of-residuals-1" class="slide level2">
<h2>Normal quantile plot of residuals</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">ggplot</span>(visits<span class="fl">.3</span>, <span class="fu">aes</span>(<span class="at">sample =</span> .resid)) <span class="sc">+</span> <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="regression_files/figure-revealjs/bRegression-42-1.png" width="960" class="r-stretch"></section>
<section id="absolute-residuals-against-fitted" class="slide level2">
<h2>Absolute residuals against fitted</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">ggplot</span>(visits<span class="fl">.3</span>, <span class="fu">aes</span>(<span class="at">x =</span> .fitted, <span class="at">y =</span> <span class="fu">abs</span>(.resid))) <span class="sc">+</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="regression_files/figure-revealjs/bRegression-43-1.png" width="960" class="r-stretch"></section>
<section id="comments-6" class="slide level2">
<h2>Comments</h2>
<ul>
<li><p>Residuals vs.&nbsp;fitted looks a lot more random.</p></li>
<li><p>Normal quantile plot looks a lot more normal (though still a little right-skewness)</p></li>
<li><p>Absolute residuals: not so much trend (though still some).</p></li>
<li><p>Not perfect, but much improved.</p></li>
</ul>
</section>
<section id="testing-more-than-one-x-at-once" class="slide level2">
<h2>Testing more than one <span class="math inline">\(x\)</span> at once</h2>
<ul>
<li>The <span class="math inline">\(t\)</span>-tests test only whether one variable could be taken out of the regression you’re looking at.</li>
<li>To test significance of more than one variable at once, fit model with and without variables
<ul>
<li>then use <code>anova</code> to compare fit of models:</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>visits<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(timedrs <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> phyheal <span class="sc">+</span> menheal <span class="sc">+</span> stress, </span>
<span id="cb59-2"><a href="#cb59-2"></a>               <span class="at">data =</span> visits)</span>
<span id="cb59-3"><a href="#cb59-3"></a>visits<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(timedrs <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">~</span> stress, <span class="at">data =</span> visits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="results-of-tests" class="slide level2">
<h2>Results of tests</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">anova</span>(visits<span class="fl">.6</span>, visits<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"463","2":"371.4729","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"461","2":"268.0087","3":"2","4":"103.4642","5":"88.98405","6":"2.08984e-33","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li><p>Models don’t fit equally well, so bigger one fits better.</p></li>
<li><p>Or “taking both variables out makes the fit worse, so don’t do it”.</p></li>
<li><p>Taking out those <span class="math inline">\(x\)</span>’s is a mistake. Or putting them in is a good idea.</p></li>
</ul>
</section>
<section id="the-punting-data" class="slide level2">
<h2>The punting data</h2>
<p>Data set <code>punting.txt</code> contains 4 variables for 13 right-footed football kickers (punters): left leg and right leg strength (lbs), distance punted (ft), another variable called “fred”. Predict punting distance from other variables:</p>
<pre><code>left            right               punt         fred
170               170                162.50       171 
130               140                144.0        136   
170               180                174.50       174 
160               160                163.50       161 
150               170                192.0        159 
150               150                171.75       151 
180               170                162.0        174 
110               110                104.83       111 
110               120                105.67       114 
120               130                117.58       126 
140               120                140.25       129  
130               140                150.17       136 
150               160                165.17       154 
</code></pre>
</section>
<section id="reading-in" class="slide level2">
<h2>Reading in</h2>
<ul>
<li>Separated by <em>multiple spaces</em> with <em>columns lined up</em>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/punting.txt"</span></span>
<span id="cb62-2"><a href="#cb62-2"></a>punting <span class="ot">&lt;-</span> <span class="fu">read_table</span>(my_url)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-data-1" class="slide level2">
<h2>The data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>punting</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["left"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["right"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["punt"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["fred"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"170","2":"170","3":"162.50","4":"171"},{"1":"130","2":"140","3":"144.00","4":"136"},{"1":"170","2":"180","3":"174.50","4":"174"},{"1":"160","2":"160","3":"163.50","4":"161"},{"1":"150","2":"170","3":"192.00","4":"159"},{"1":"150","2":"150","3":"171.75","4":"151"},{"1":"180","2":"170","3":"162.00","4":"174"},{"1":"110","2":"110","3":"104.83","4":"111"},{"1":"110","2":"120","3":"105.67","4":"114"},{"1":"120","2":"130","3":"117.58","4":"126"},{"1":"140","2":"120","3":"140.25","4":"129"},{"1":"130","2":"140","3":"150.17","4":"136"},{"1":"150","2":"160","3":"165.17","4":"154"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="regression-and-output" class="slide level2">
<h2>Regression and output</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a>punting<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(punt <span class="sc">~</span> left <span class="sc">+</span> right <span class="sc">+</span> fred, <span class="at">data =</span> punting)</span>
<span id="cb64-2"><a href="#cb64-2"></a><span class="fu">glance</span>(punting<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["r.squared"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["adj.r.squared"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["sigma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["df"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["logLik"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["BIC"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["deviance"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["df.residual"],"name":[11],"type":["int"],"align":["right"]},{"label":["nobs"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"0.7781401","2":"0.7041867","3":"14.6752","4":"10.52204","5":"0.002670231","6":"3","7":"-50.97606","8":"111.9521","9":"114.7769","10":"1938.254","11":"9","12":"13"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="fu">tidy</span>(punting<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"-4.6855434","3":"29.117224","4":"-0.16091999","5":"0.8757106"},{"1":"left","2":"0.2678651","3":"2.111096","4":"0.12688441","5":"0.9018215"},{"1":"right","2":"1.0524055","3":"2.147710","4":"0.49001292","5":"0.6358478"},{"1":"fred","2":"-0.2672438","3":"4.226613","4":"-0.06322883","5":"0.9509663"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="comments-7" class="slide level2">
<h2>Comments</h2>
<ul>
<li><p>Overall regression strongly significant, R-sq high.</p></li>
<li><p>None of the <span class="math inline">\(x\)</span>’s significant! Why?</p></li>
<li><p><span class="math inline">\(t\)</span>-tests only say that you could take any one of the <span class="math inline">\(x\)</span>’s out without damaging the fit; doesn’t matter which one.</p></li>
<li><p>Explanation: look at <em>correlations</em>.</p></li>
</ul>
</section>
<section id="the-correlations" class="slide level2">
<h2>The correlations</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="fu">cor</span>(punting)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           left     right      punt      fred
left  1.0000000 0.8957224 0.8117368 0.9722632
right 0.8957224 1.0000000 0.8805469 0.9728784
punt  0.8117368 0.8805469 1.0000000 0.8679507
fred  0.9722632 0.9728784 0.8679507 1.0000000</code></pre>
</div>
</div>
<ul>
<li><p><em>All</em> correlations are high: <span class="math inline">\(x\)</span>’s with <code>punt</code> (good) and with each other (bad, at least confusing).</p></li>
<li><p>What to do? Probably do just as well to pick one variable, say <code>right</code> since kickers are right-footed.</p></li>
</ul>
</section>
<section id="just-right" class="slide level2">
<h2>Just <code>right</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>punting<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(punt <span class="sc">~</span> right, <span class="at">data =</span> punting)</span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="fu">anova</span>(punting<span class="fl">.2</span>, punting<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Res.Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"11","2":"1962.516","3":"NA","4":"NA","5":"NA","6":"NA","_rn_":"1"},{"1":"9","2":"1938.254","3":"2","4":"24.26262","5":"0.05632997","6":"0.9455577","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>No significant loss by dropping other two variables.</p>
</section>
<section id="comparing-r-squareds" class="slide level2">
<h2>Comparing R-squareds</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="fu">summary</span>(punting<span class="fl">.1</span>)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7781401</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="fu">summary</span>(punting<span class="fl">.2</span>)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7753629</code></pre>
</div>
</div>
<p>Basically no difference. In regression (over), <code>right</code> significant:</p>
</section>
<section id="regression-results" class="slide level2">
<h2>Regression results</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="fu">tidy</span>(punting<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"-3.693037","3":"25.2648659","4":"-0.1461728","5":"8.864293e-01"},{"1":"right","2":"1.042672","3":"0.1692152","4":"6.1618066","5":"7.088001e-05"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="but" class="slide level2">
<h2>But</h2>
<ul>
<li><p>Maybe we got the <em>form</em> of the relationship with <code>left</code> wrong.</p></li>
<li><p>Check: plot <em>residuals</em> from previous regression (without <code>left</code>) against <code>left</code>.</p></li>
<li><p>Residuals here are “punting distance adjusted for right leg strength”.</p></li>
<li><p>If there is some kind of relationship with <code>left</code>, we should include in model.</p></li>
<li><p>Plot of residuals against original variable: <code>augment</code> from <code>broom</code>.</p></li>
</ul>
</section>
<section id="augmenting-punting.2" class="slide level2">
<h2>Augmenting <code>punting.2</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>punting<span class="fl">.2</span> <span class="sc">%&gt;%</span> <span class="fu">augment</span>(punting) <span class="ot">-&gt;</span> punting.<span class="fl">2.</span>aug</span>
<span id="cb74-2"><a href="#cb74-2"></a>punting.<span class="fl">2.</span>aug </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["left"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["right"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["punt"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["fred"],"name":[4],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[5],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[6],"type":["dbl"],"align":["right"]},{"label":[".hat"],"name":[7],"type":["dbl"],"align":["right"]},{"label":[".sigma"],"name":[8],"type":["dbl"],"align":["right"]},{"label":[".cooksd"],"name":[9],"type":["dbl"],"align":["right"]},{"label":[".std.resid"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"170","2":"170","3":"162.50","4":"171","5":"173.5611","6":"-11.0611358","7":"0.15679012","8":"13.48116","9":"7.561295e-02","10":"-0.90182354"},{"1":"130","2":"140","3":"144.00","4":"136","5":"142.2810","6":"1.7190123","7":"0.08641975","8":"13.99744","9":"8.574859e-04","10":"0.13464658"},{"1":"170","2":"180","3":"174.50","4":"174","5":"183.9879","6":"-9.4878519","7":"0.24444444","8":"13.57709","9":"1.080271e-01","10":"-0.81719251"},{"1":"160","2":"160","3":"163.50","4":"161","5":"163.1344","6":"0.3655802","7":"0.10123457","8":"14.00845","9":"4.694085e-05","10":"0.02887016"},{"1":"150","2":"170","3":"192.00","4":"159","5":"173.5611","6":"18.4388642","7":"0.15679012","8":"12.48721","9":"2.101189e-01","10":"1.50333583"},{"1":"150","2":"150","3":"171.75","4":"151","5":"152.7077","6":"19.0422963","7":"0.07777778","8":"12.52727","9":"9.293352e-02","10":"1.48453763"},{"1":"180","2":"170","3":"162.00","4":"174","5":"173.5611","6":"-11.5611358","7":"0.15679012","8":"13.43132","9":"8.260336e-02","10":"-0.94258895"},{"1":"110","2":"110","3":"104.83","4":"111","5":"111.0008","6":"-6.1708395","7":"0.30493827","8":"13.81206","9":"6.736015e-02","10":"-0.55414351"},{"1":"110","2":"120","3":"105.67","4":"114","5":"121.4276","6":"-15.7575556","7":"0.20000000","8":"12.85356","9":"2.174589e-01","10":"-1.31896581"},{"1":"120","2":"130","3":"117.58","4":"126","5":"131.8543","6":"-14.2742716","7":"0.12716049","8":"13.14944","9":"9.531049e-02","10":"-1.14386940"},{"1":"140","2":"120","3":"140.25","4":"129","5":"121.4276","6":"18.8224444","7":"0.20000000","8":"12.32745","9":"3.102783e-01","10":"1.57550837"},{"1":"130","2":"140","3":"150.17","4":"136","5":"142.2810","6":"7.8890123","7":"0.08641975","8":"13.76369","9":"1.805986e-02","10":"0.61792956"},{"1":"150","2":"160","3":"165.17","4":"154","5":"163.1344","6":"2.0355802","7":"0.10123457","8":"13.99252","9":"1.455332e-03","10":"0.16075139"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="residuals-against-left" class="slide level2">
<h2>Residuals against <code>left</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="fu">ggplot</span>(punting.<span class="fl">2.</span>aug, <span class="fu">aes</span>(<span class="at">x =</span> left, <span class="at">y =</span> .resid)) <span class="sc">+</span></span>
<span id="cb75-2"><a href="#cb75-2"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="regression_files/figure-revealjs/basingstoke-1.png" width="960" class="r-stretch"></section>
<section id="comments-8" class="slide level2">
<h2>Comments</h2>
<ul>
<li><p>There is a <em>curved</em> relationship with <code>left</code>.</p></li>
<li><p>We should add <code>left</code>-squared to the regression (and therefore put <code>left</code> back in when we do that):</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>punting<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(punt <span class="sc">~</span> left <span class="sc">+</span> <span class="fu">I</span>(left<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> right,</span>
<span id="cb76-2"><a href="#cb76-2"></a>  <span class="at">data =</span> punting</span>
<span id="cb76-3"><a href="#cb76-3"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="regression-with-left-squared" class="slide level2">
<h2>Regression with <code>left-squared</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="fu">summary</span>(punting<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = punt ~ left + I(left^2) + right, data = punting)

Residuals:
     Min       1Q   Median       3Q      Max 
-11.3777  -5.3599   0.0459   4.5088  13.2669 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept) -4.623e+02  9.902e+01  -4.669  0.00117 **
left         6.888e+00  1.462e+00   4.710  0.00110 **
I(left^2)   -2.302e-02  4.927e-03  -4.672  0.00117 **
right        7.396e-01  2.292e-01   3.227  0.01038 * 
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 7.931 on 9 degrees of freedom
Multiple R-squared:  0.9352,    Adjusted R-squared:  0.9136 
F-statistic:  43.3 on 3 and 9 DF,  p-value: 1.13e-05</code></pre>
</div>
</div>
</section>
<section id="comments-9" class="slide level2">
<h2>Comments</h2>
<ul>
<li><p>This was definitely a good idea (R-squared has clearly increased).</p></li>
<li><p>We would never have seen it without plotting residuals from <code>punting.2</code> (without <code>left</code>) against <code>left</code>.</p></li>
<li><p>Negative slope for <code>leftsq</code> means that increased left-leg strength only increases punting distance up to a point: beyond that, it decreases again.</p></li>
</ul>
<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="regression_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="regression_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="regression_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="regression_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="regression_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="regression_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="regression_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="regression_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="regression_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="regression_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>