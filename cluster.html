<!DOCTYPE html>
<html lang="en"><head>
<script src="cluster_files/libs/clipboard/clipboard.min.js"></script>
<script src="cluster_files/libs/quarto-html/tabby.min.js"></script>
<script src="cluster_files/libs/quarto-html/popper.min.js"></script>
<script src="cluster_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="cluster_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="cluster_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="cluster_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="cluster_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.340">

  <title>Cluster analysis</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="cluster_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="cluster_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="cluster_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="cluster_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="cluster_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="cluster_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="cluster_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  
  <link href="cluster_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
  <script src="cluster_files/libs/pagedtable-1.1/js/pagedtable.js"></script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Cluster analysis</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="cluster-analysis" class="slide level2">
<h2>Cluster Analysis</h2>
<ul>
<li><p>One side-effect of discriminant analysis: could draw picture of data (if 1st 2s <code>LD</code>s told most of story) and see which individuals “close” to each other.</p></li>
<li><p>Discriminant analysis requires knowledge of groups.</p></li>
<li><p>Without knowledge of groups, use <em>cluster analysis</em>: see which individuals close together, which groups suggested by data.</p></li>
<li><p>Idea: see how individuals group into “clusters” of nearby individuals.</p></li>
<li><p>Base on “dissimilarities” between individuals.</p></li>
<li><p>Or base on standard deviations and correlations between variables (assesses dissimilarity behind scenes).</p></li>
</ul>
</section>
<section id="packages" class="slide level2">
<h2>Packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(MASS) <span class="co"># for lda later</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(spatstat) <span class="co"># for crossdist later</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(conflicted)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">conflict_prefer</span>(<span class="st">"select"</span>, <span class="st">"dplyr"</span>)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">conflict_prefer</span>(<span class="st">"filter"</span>, <span class="st">"dplyr"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="one-to-ten-in-11-languages" class="slide level2">
<h2>One to ten in 11 languages</h2>
<table>
<thead>
<tr class="header">
<th></th>
<th>English</th>
<th>Norwegian</th>
<th>Danish</th>
<th>Dutch</th>
<th>German</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>one</td>
<td>en</td>
<td>en</td>
<td>een</td>
<td>eins</td>
</tr>
<tr class="even">
<td>2</td>
<td>two</td>
<td>to</td>
<td>to</td>
<td>twee</td>
<td>zwei</td>
</tr>
<tr class="odd">
<td>3</td>
<td>three</td>
<td>tre</td>
<td>tre</td>
<td>drie</td>
<td>drei</td>
</tr>
<tr class="even">
<td>4</td>
<td>four</td>
<td>fire</td>
<td>fire</td>
<td>vier</td>
<td>vier</td>
</tr>
<tr class="odd">
<td>5</td>
<td>five</td>
<td>fem</td>
<td>fem</td>
<td>vijf</td>
<td>funf</td>
</tr>
<tr class="even">
<td>6</td>
<td>six</td>
<td>seks</td>
<td>seks</td>
<td>zes</td>
<td>sechs</td>
</tr>
<tr class="odd">
<td>7</td>
<td>seven</td>
<td>sju</td>
<td>syv</td>
<td>zeven</td>
<td>sieben</td>
</tr>
<tr class="even">
<td>8</td>
<td>eight</td>
<td>atte</td>
<td>otte</td>
<td>acht</td>
<td>acht</td>
</tr>
<tr class="odd">
<td>9</td>
<td>nine</td>
<td>ni</td>
<td>ni</td>
<td>negen</td>
<td>neun</td>
</tr>
<tr class="even">
<td>10</td>
<td>ten</td>
<td>ti</td>
<td>ti</td>
<td>tien</td>
<td>zehn</td>
</tr>
</tbody>
</table>
</section>
<section id="one-to-ten" class="slide level2 smaller">
<h2>One to ten</h2>
<table>
<thead>
<tr class="header">
<th></th>
<th>French</th>
<th>Spanish</th>
<th>Italian</th>
<th>Polish</th>
<th>Hungarian</th>
<th>Finnish</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>un</td>
<td>uno</td>
<td>uno</td>
<td>jeden</td>
<td>egy</td>
<td>yksi</td>
</tr>
<tr class="even">
<td>2</td>
<td>deux</td>
<td>dos</td>
<td>due</td>
<td>dwa</td>
<td>ketto</td>
<td>kaksi</td>
</tr>
<tr class="odd">
<td>3</td>
<td>trois</td>
<td>tres</td>
<td>tre</td>
<td>trzy</td>
<td>harom</td>
<td>kolme</td>
</tr>
<tr class="even">
<td>4</td>
<td>quatre</td>
<td>cuatro</td>
<td>quattro</td>
<td>cztery</td>
<td>negy</td>
<td>nelja</td>
</tr>
<tr class="odd">
<td>5</td>
<td>cinq</td>
<td>cinco</td>
<td>cinque</td>
<td>piec</td>
<td>ot</td>
<td>viisi</td>
</tr>
<tr class="even">
<td>6</td>
<td>six</td>
<td>seis</td>
<td>sei</td>
<td>szesc</td>
<td>hat</td>
<td>kuusi</td>
</tr>
<tr class="odd">
<td>7</td>
<td>sept</td>
<td>siete</td>
<td>sette</td>
<td>siedem</td>
<td>het</td>
<td>seitseman</td>
</tr>
<tr class="even">
<td>8</td>
<td>huit</td>
<td>ocho</td>
<td>otto</td>
<td>osiem</td>
<td>nyolc</td>
<td>kahdeksan</td>
</tr>
<tr class="odd">
<td>9</td>
<td>neuf</td>
<td>nueve</td>
<td>nove</td>
<td>dziewiec</td>
<td>kilenc</td>
<td>yhdeksan</td>
</tr>
<tr class="even">
<td>10</td>
<td>dix</td>
<td>diez</td>
<td>dieci</td>
<td>dziesiec</td>
<td>tiz</td>
<td>kymmenen</td>
</tr>
</tbody>
</table>
</section>
<section id="dissimilarities-and-languages-example" class="slide level2">
<h2>Dissimilarities and languages example</h2>
<ul>
<li><p>Can define dissimilarities how you like (whatever makes sense in application).</p></li>
<li><p>Sometimes defining “similarity” makes more sense; can turn this into dissimilarity by subtracting from some maximum.</p></li>
<li><p>Example: numbers 1–10 in various European languages. Define similarity between two languages by counting how often the same number has a name starting with the same letter (and dissimilarity by how often number has names starting with different letter).</p></li>
<li><p>Crude (doesn’t even look at most of the words), but see how effective.</p></li>
</ul>
</section>
<section id="two-kinds-of-cluster-analysis" class="slide level2">
<h2>Two kinds of cluster analysis</h2>
<ul>
<li><p>Looking at process of forming clusters (of similar languages): <strong>hierarchical cluster analysis</strong> (<code>hclust</code>).</p></li>
<li><p>Start with each individual in cluster by itself.</p></li>
<li><p>Join “closest” clusters one by one until all individuals in one cluster.</p></li>
<li><p>How to define closeness of two <em>clusters</em>? Not obvious, investigate in a moment.</p></li>
<li><p>Know how many clusters: which division into that many clusters is “best” for individuals? <strong>K-means clustering</strong> (<code>kmeans</code>).</p></li>
</ul>
</section>
<section id="two-made-up-clusters" class="slide level2">
<h2>Two made-up clusters</h2>

<img data-src="cluster_files/figure-revealjs/bCluster-2-1.png" width="960" class="r-stretch"><p>How to measure distance between set of red points and set of blue ones?</p>
</section>
<section id="single-linkage-distance" class="slide level2">
<h2>Single-linkage distance</h2>
<p>Find the red point and the blue point that are closest together:</p>

<img data-src="cluster_files/figure-revealjs/bCluster-3-1.png" width="960" class="r-stretch"><p>Single-linkage distance between 2 clusters is distance between their closest points.</p>
</section>
<section id="complete-linkage" class="slide level2">
<h2>Complete linkage</h2>
<p>Find the red and blue points that are farthest apart:</p>

<img data-src="cluster_files/figure-revealjs/bCluster-4-1.png" width="960" class="r-stretch"><p>Complete-linkage distance is distance between farthest points.</p>
</section>
<section id="wards-method" class="slide level2">
<h2>Ward’s method</h2>
<p>Work out mean of each cluster and join point to its mean:</p>

<img data-src="cluster_files/figure-revealjs/bCluster-5-1.png" width="960" class="r-stretch"><p>Work out (i) sum of squared distances of points from means.</p>
</section>
<section id="wards-method-part-2" class="slide level2">
<h2>Ward’s method part 2</h2>
<p>Now imagine combining the two clusters and working out overall mean. Join each point to this mean:</p>

<img data-src="cluster_files/figure-revealjs/bCluster-6-1.png" width="960" class="r-stretch"><p>Calc sum of squared distances (ii) of points to combined mean.</p>
</section>
<section id="wards-method-part-3" class="slide level2">
<h2>Ward’s method part 3</h2>
<ul>
<li><p>Sum of squares (ii) will be bigger than (i) (points closer to own cluster mean than combined mean).</p></li>
<li><p>Ward’s distance is (ii) minus (i).</p></li>
<li><p>Think of as “cost” of combining clusters:</p></li>
<li><p>if clusters close together, (ii) only a little larger than (i)</p></li>
<li><p>if clusters far apart, (ii) a lot larger than (i) (as in example).</p></li>
</ul>
</section>
<section id="hierarchical-clustering-revisited" class="slide level2">
<h2>Hierarchical clustering revisited</h2>
<ul>
<li><p>Single linkage, complete linkage, Ward are ways of measuring closeness of clusters.</p></li>
<li><p>Use them, starting with each observation in own cluster, to repeatedly combine two closest clusters until all points in one cluster.</p></li>
<li><p>They will give different answers (clustering stories).</p></li>
<li><p>Single linkage tends to make “stringy” clusters because clusters can be very different apart from two closest points.</p></li>
<li><p>Complete linkage insists on whole clusters being similar.</p></li>
<li><p>Ward tends to form many small clusters first.</p></li>
</ul>
</section>
<section id="dissimilarity-data-in-r" class="slide level2">
<h2>Dissimilarity data in R</h2>
<p>Dissimilarities for language data were how many number names had <em>different</em> first letter:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/languages.txt"</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>(number.d <span class="ot">&lt;-</span> <span class="fu">read_table</span>(my_url))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["la"],"name":[1],"type":["chr"],"align":["left"]},{"label":["en"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["no"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["dk"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["nl"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["de"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["fr"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["es"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["it"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["pl"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["hu"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["fi"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"en","2":"0","3":"2","4":"2","5":"7","6":"6","7":"6","8":"6","9":"6","10":"7","11":"9","12":"9"},{"1":"no","2":"2","3":"0","4":"1","5":"5","6":"4","7":"6","8":"6","9":"6","10":"7","11":"8","12":"9"},{"1":"dk","2":"2","3":"1","4":"0","5":"6","6":"5","7":"6","8":"5","9":"5","10":"6","11":"8","12":"9"},{"1":"nl","2":"7","3":"5","4":"6","5":"0","6":"5","7":"9","8":"9","9":"9","10":"10","11":"8","12":"9"},{"1":"de","2":"6","3":"4","4":"5","5":"5","6":"0","7":"7","8":"7","9":"7","10":"8","11":"9","12":"9"},{"1":"fr","2":"6","3":"6","4":"6","5":"9","6":"7","7":"0","8":"2","9":"1","10":"5","11":"10","12":"9"},{"1":"es","2":"6","3":"6","4":"5","5":"9","6":"7","7":"2","8":"0","9":"1","10":"3","11":"10","12":"9"},{"1":"it","2":"6","3":"6","4":"5","5":"9","6":"7","7":"1","8":"1","9":"0","10":"4","11":"10","12":"9"},{"1":"pl","2":"7","3":"7","4":"6","5":"10","6":"8","7":"5","8":"3","9":"4","10":"0","11":"10","12":"9"},{"1":"hu","2":"9","3":"8","4":"8","5":"8","6":"9","7":"10","8":"10","9":"10","10":"10","11":"0","12":"8"},{"1":"fi","2":"9","3":"9","4":"9","5":"9","6":"9","7":"9","8":"9","9":"8","10":"9","11":"8","12":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="making-a-distance-object" class="slide level2">
<h2>Making a distance object</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>number.d <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">select</span>(<span class="sc">-</span>la) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">as.dist</span>() <span class="ot">-&gt;</span> d</span>
<span id="cb3-4"><a href="#cb3-4"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   en no dk nl de fr es it pl hu
no  2                           
dk  2  1                        
nl  7  5  6                     
de  6  4  5  5                  
fr  6  6  6  9  7               
es  6  6  5  9  7  2            
it  6  6  5  9  7  1  1         
pl  7  7  6 10  8  5  3  4      
hu  9  8  8  8  9 10 10 10 10   
fi  9  9  9  9  9  9  9  8  9  8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">class</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "dist"</code></pre>
</div>
</div>
</section>
<section id="cluster-analysis-and-dendrogram" class="slide level2">
<h2>Cluster analysis and dendrogram</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>d.hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d, <span class="at">method =</span> <span class="st">"single"</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">plot</span>(d.hc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="cluster_files/figure-revealjs/bCluster-10-1.png" width="960" class="r-stretch"></section>
<section id="comments" class="slide level2">
<h2>Comments</h2>
<ul>
<li><p>Tree shows how languages combined into clusters.</p></li>
<li><p>First (bottom), Spanish, French, Italian joined into one cluster, Norwegian and Danish into another.</p></li>
<li><p>Later, English joined to Norse languages, Polish to Romance group.</p></li>
<li><p>Then German, Dutch make a Germanic group.</p></li>
<li><p>Finally, Hungarian and Finnish joined to each other and everything else.</p></li>
</ul>
</section>
<section id="clustering-process" class="slide level2">
<h2>Clustering process</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>d.hc<span class="sc">$</span>labels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "en" "no" "dk" "nl" "de" "fr" "es" "it" "pl" "hu" "fi"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>d.hc<span class="sc">$</span>merge</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      [,1] [,2]
 [1,]   -2   -3
 [2,]   -6   -8
 [3,]   -7    2
 [4,]   -1    1
 [5,]   -9    3
 [6,]   -5    4
 [7,]   -4    6
 [8,]    5    7
 [9,]  -10    8
[10,]  -11    9</code></pre>
</div>
</div>
</section>
<section id="comments-1" class="slide level2">
<h2>Comments</h2>
<ul>
<li><p>Lines of <code>merge</code> show what was combined</p>
<ul>
<li><p>First, languages 2 and 3 (<code>no</code> and <code>dk</code>)</p></li>
<li><p>Then languages 6 and 8 (<code>fr</code> and <code>it</code>)</p></li>
<li><p>Then #7 combined with cluster formed at step 2 (<code>es</code> joined to <code>fr</code> and <code>it</code>).</p></li>
<li><p>Then <code>en</code> joined to <code>no</code> and <code>dk</code> </p></li>
<li><p>Finally <code>fi</code> joined to all others.</p></li>
</ul></li>
</ul>
</section>
<section id="complete-linkage-1" class="slide level2">
<h2>Complete linkage</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>d.hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d, <span class="at">method =</span> <span class="st">"complete"</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="fu">plot</span>(d.hc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="cluster_files/figure-revealjs/bCluster-12-1.png" width="960" class="r-stretch"></section>
<section id="ward" class="slide level2">
<h2>Ward</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>d.hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d, <span class="at">method =</span> <span class="st">"ward.D"</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="fu">plot</span>(d.hc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="cluster_files/figure-revealjs/wardo-1.png" width="960" class="r-stretch"></section>
<section id="chopping-the-tree" class="slide level2">
<h2>Chopping the tree</h2>
<ul>
<li>Three clusters (from Ward) looks good:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">cutree</span>(d.hc, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>en no dk nl de fr es it pl hu fi 
 1  1  1  1  1  2  2  2  2  3  3 </code></pre>
</div>
</div>
</section>
<section id="turning-the-named-vector-into-a-data-frame" class="slide level2">
<h2>Turning the “named vector” into a data frame</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">cutree</span>(d.hc, <span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">enframe</span>(<span class="at">name=</span><span class="st">"country"</span>, <span class="at">value=</span><span class="st">"cluster"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["cluster"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"en","2":"1"},{"1":"no","2":"1"},{"1":"dk","2":"1"},{"1":"nl","2":"1"},{"1":"de","2":"1"},{"1":"fr","2":"2"},{"1":"es","2":"2"},{"1":"it","2":"2"},{"1":"pl","2":"2"},{"1":"hu","2":"3"},{"1":"fi","2":"3"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="drawing-those-clusters-on-the-tree" class="slide level2">
<h2>Drawing those clusters on the tree</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">plot</span>(d.hc)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="fu">rect.hclust</span>(d.hc, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="cluster_files/figure-revealjs/asfsagd-1.png" width="960" class="r-stretch"></section>
<section id="comparing-single-linkage-and-ward" class="slide level2">
<h2>Comparing single-linkage and Ward</h2>
<ul>
<li><p>In Ward, Dutch and German get joined earlier (before joining to Germanic cluster).</p></li>
<li><p>Also Hungarian and Finnish get combined earlier.</p></li>
</ul>
</section>
<section id="making-those-dissimilarities" class="slide level2">
<h2>Making those dissimilarities</h2>
<p>Original data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/one-ten.txt"</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>lang <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(my_url, <span class="st">" "</span>)</span>
<span id="cb18-3"><a href="#cb18-3"></a>lang</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["en"],"name":[1],"type":["chr"],"align":["left"]},{"label":["no"],"name":[2],"type":["chr"],"align":["left"]},{"label":["dk"],"name":[3],"type":["chr"],"align":["left"]},{"label":["nl"],"name":[4],"type":["chr"],"align":["left"]},{"label":["de"],"name":[5],"type":["chr"],"align":["left"]},{"label":["fr"],"name":[6],"type":["chr"],"align":["left"]},{"label":["es"],"name":[7],"type":["chr"],"align":["left"]},{"label":["it"],"name":[8],"type":["chr"],"align":["left"]},{"label":["pl"],"name":[9],"type":["chr"],"align":["left"]},{"label":["hu"],"name":[10],"type":["chr"],"align":["left"]},{"label":["fi"],"name":[11],"type":["chr"],"align":["left"]}],"data":[{"1":"one","2":"en","3":"en","4":"een","5":"eins","6":"un","7":"uno","8":"uno","9":"jeden","10":"egy","11":"yksi"},{"1":"two","2":"to","3":"to","4":"twee","5":"zwei","6":"deux","7":"dos","8":"due","9":"dwa","10":"ketto","11":"kaksi"},{"1":"three","2":"tre","3":"tre","4":"drie","5":"drei","6":"trois","7":"tres","8":"tre","9":"trzy","10":"harom","11":"kolme"},{"1":"four","2":"fire","3":"fire","4":"vier","5":"vier","6":"quatre","7":"cuatro","8":"quattro","9":"cztery","10":"negy","11":"nelja"},{"1":"five","2":"fem","3":"fem","4":"vijf","5":"funf","6":"cinq","7":"cinco","8":"cinque","9":"piec","10":"ot","11":"viisi"},{"1":"six","2":"seks","3":"seks","4":"zes","5":"sechs","6":"six","7":"seis","8":"sei","9":"szesc","10":"hat","11":"kuusi"},{"1":"seven","2":"sju","3":"syv","4":"zeven","5":"sieben","6":"sept","7":"siete","8":"sette","9":"siedem","10":"het","11":"seitseman"},{"1":"eight","2":"atte","3":"otte","4":"acht","5":"acht","6":"huit","7":"ocho","8":"otto","9":"osiem","10":"nyolc","11":"kahdeksan"},{"1":"nine","2":"ni","3":"ni","4":"negen","5":"neun","6":"neuf","7":"nueve","8":"nove","9":"dziewiec","10":"kilenc","11":"yhdeksan"},{"1":"ten","2":"ti","3":"ti","4":"tien","5":"zehn","6":"dix","7":"diez","8":"dieci","9":"dziesiec","10":"tiz","11":"kymmenen"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>It would be a lot easier to extract the first letter if the number names were all in one column.</p>
</section>
<section id="tidy-and-extract-first-letter" class="slide level2">
<h2>Tidy, and extract first letter</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>lang <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">number=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>    <span class="fu">pivot_longer</span>(<span class="sc">-</span>number, <span class="at">names_to=</span><span class="st">"language"</span>, <span class="at">values_to=</span><span class="st">"name"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>    <span class="fu">mutate</span>(<span class="at">first=</span><span class="fu">str_sub</span>(name, <span class="dv">1</span>, <span class="dv">1</span>)) <span class="ot">-&gt;</span> lang.long</span>
<span id="cb19-4"><a href="#cb19-4"></a>lang.long </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["number"],"name":[1],"type":["int"],"align":["right"]},{"label":["language"],"name":[2],"type":["chr"],"align":["left"]},{"label":["name"],"name":[3],"type":["chr"],"align":["left"]},{"label":["first"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"en","3":"one","4":"o"},{"1":"1","2":"no","3":"en","4":"e"},{"1":"1","2":"dk","3":"en","4":"e"},{"1":"1","2":"nl","3":"een","4":"e"},{"1":"1","2":"de","3":"eins","4":"e"},{"1":"1","2":"fr","3":"un","4":"u"},{"1":"1","2":"es","3":"uno","4":"u"},{"1":"1","2":"it","3":"uno","4":"u"},{"1":"1","2":"pl","3":"jeden","4":"j"},{"1":"1","2":"hu","3":"egy","4":"e"},{"1":"1","2":"fi","3":"yksi","4":"y"},{"1":"2","2":"en","3":"two","4":"t"},{"1":"2","2":"no","3":"to","4":"t"},{"1":"2","2":"dk","3":"to","4":"t"},{"1":"2","2":"nl","3":"twee","4":"t"},{"1":"2","2":"de","3":"zwei","4":"z"},{"1":"2","2":"fr","3":"deux","4":"d"},{"1":"2","2":"es","3":"dos","4":"d"},{"1":"2","2":"it","3":"due","4":"d"},{"1":"2","2":"pl","3":"dwa","4":"d"},{"1":"2","2":"hu","3":"ketto","4":"k"},{"1":"2","2":"fi","3":"kaksi","4":"k"},{"1":"3","2":"en","3":"three","4":"t"},{"1":"3","2":"no","3":"tre","4":"t"},{"1":"3","2":"dk","3":"tre","4":"t"},{"1":"3","2":"nl","3":"drie","4":"d"},{"1":"3","2":"de","3":"drei","4":"d"},{"1":"3","2":"fr","3":"trois","4":"t"},{"1":"3","2":"es","3":"tres","4":"t"},{"1":"3","2":"it","3":"tre","4":"t"},{"1":"3","2":"pl","3":"trzy","4":"t"},{"1":"3","2":"hu","3":"harom","4":"h"},{"1":"3","2":"fi","3":"kolme","4":"k"},{"1":"4","2":"en","3":"four","4":"f"},{"1":"4","2":"no","3":"fire","4":"f"},{"1":"4","2":"dk","3":"fire","4":"f"},{"1":"4","2":"nl","3":"vier","4":"v"},{"1":"4","2":"de","3":"vier","4":"v"},{"1":"4","2":"fr","3":"quatre","4":"q"},{"1":"4","2":"es","3":"cuatro","4":"c"},{"1":"4","2":"it","3":"quattro","4":"q"},{"1":"4","2":"pl","3":"cztery","4":"c"},{"1":"4","2":"hu","3":"negy","4":"n"},{"1":"4","2":"fi","3":"nelja","4":"n"},{"1":"5","2":"en","3":"five","4":"f"},{"1":"5","2":"no","3":"fem","4":"f"},{"1":"5","2":"dk","3":"fem","4":"f"},{"1":"5","2":"nl","3":"vijf","4":"v"},{"1":"5","2":"de","3":"funf","4":"f"},{"1":"5","2":"fr","3":"cinq","4":"c"},{"1":"5","2":"es","3":"cinco","4":"c"},{"1":"5","2":"it","3":"cinque","4":"c"},{"1":"5","2":"pl","3":"piec","4":"p"},{"1":"5","2":"hu","3":"ot","4":"o"},{"1":"5","2":"fi","3":"viisi","4":"v"},{"1":"6","2":"en","3":"six","4":"s"},{"1":"6","2":"no","3":"seks","4":"s"},{"1":"6","2":"dk","3":"seks","4":"s"},{"1":"6","2":"nl","3":"zes","4":"z"},{"1":"6","2":"de","3":"sechs","4":"s"},{"1":"6","2":"fr","3":"six","4":"s"},{"1":"6","2":"es","3":"seis","4":"s"},{"1":"6","2":"it","3":"sei","4":"s"},{"1":"6","2":"pl","3":"szesc","4":"s"},{"1":"6","2":"hu","3":"hat","4":"h"},{"1":"6","2":"fi","3":"kuusi","4":"k"},{"1":"7","2":"en","3":"seven","4":"s"},{"1":"7","2":"no","3":"sju","4":"s"},{"1":"7","2":"dk","3":"syv","4":"s"},{"1":"7","2":"nl","3":"zeven","4":"z"},{"1":"7","2":"de","3":"sieben","4":"s"},{"1":"7","2":"fr","3":"sept","4":"s"},{"1":"7","2":"es","3":"siete","4":"s"},{"1":"7","2":"it","3":"sette","4":"s"},{"1":"7","2":"pl","3":"siedem","4":"s"},{"1":"7","2":"hu","3":"het","4":"h"},{"1":"7","2":"fi","3":"seitseman","4":"s"},{"1":"8","2":"en","3":"eight","4":"e"},{"1":"8","2":"no","3":"atte","4":"a"},{"1":"8","2":"dk","3":"otte","4":"o"},{"1":"8","2":"nl","3":"acht","4":"a"},{"1":"8","2":"de","3":"acht","4":"a"},{"1":"8","2":"fr","3":"huit","4":"h"},{"1":"8","2":"es","3":"ocho","4":"o"},{"1":"8","2":"it","3":"otto","4":"o"},{"1":"8","2":"pl","3":"osiem","4":"o"},{"1":"8","2":"hu","3":"nyolc","4":"n"},{"1":"8","2":"fi","3":"kahdeksan","4":"k"},{"1":"9","2":"en","3":"nine","4":"n"},{"1":"9","2":"no","3":"ni","4":"n"},{"1":"9","2":"dk","3":"ni","4":"n"},{"1":"9","2":"nl","3":"negen","4":"n"},{"1":"9","2":"de","3":"neun","4":"n"},{"1":"9","2":"fr","3":"neuf","4":"n"},{"1":"9","2":"es","3":"nueve","4":"n"},{"1":"9","2":"it","3":"nove","4":"n"},{"1":"9","2":"pl","3":"dziewiec","4":"d"},{"1":"9","2":"hu","3":"kilenc","4":"k"},{"1":"9","2":"fi","3":"yhdeksan","4":"y"},{"1":"10","2":"en","3":"ten","4":"t"},{"1":"10","2":"no","3":"ti","4":"t"},{"1":"10","2":"dk","3":"ti","4":"t"},{"1":"10","2":"nl","3":"tien","4":"t"},{"1":"10","2":"de","3":"zehn","4":"z"},{"1":"10","2":"fr","3":"dix","4":"d"},{"1":"10","2":"es","3":"diez","4":"d"},{"1":"10","2":"it","3":"dieci","4":"d"},{"1":"10","2":"pl","3":"dziesiec","4":"d"},{"1":"10","2":"hu","3":"tiz","4":"t"},{"1":"10","2":"fi","3":"kymmenen","4":"k"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="calculating-dissimilarity" class="slide level2">
<h2>Calculating dissimilarity</h2>
<ul>
<li><p>Suppose we wanted dissimilarity between English and Norwegian. It’s the number of first letters that are different.</p></li>
<li><p>First get the lines for English:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>english <span class="ot">&lt;-</span> lang.long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(language <span class="sc">==</span> <span class="st">"en"</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a>english</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["number"],"name":[1],"type":["int"],"align":["right"]},{"label":["language"],"name":[2],"type":["chr"],"align":["left"]},{"label":["name"],"name":[3],"type":["chr"],"align":["left"]},{"label":["first"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"en","3":"one","4":"o"},{"1":"2","2":"en","3":"two","4":"t"},{"1":"3","2":"en","3":"three","4":"t"},{"1":"4","2":"en","3":"four","4":"f"},{"1":"5","2":"en","3":"five","4":"f"},{"1":"6","2":"en","3":"six","4":"s"},{"1":"7","2":"en","3":"seven","4":"s"},{"1":"8","2":"en","3":"eight","4":"e"},{"1":"9","2":"en","3":"nine","4":"n"},{"1":"10","2":"en","3":"ten","4":"t"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="and-then-the-lines-for-norwegian" class="slide level2">
<h2>And then the lines for Norwegian</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>norwegian <span class="ot">&lt;-</span> lang.long <span class="sc">%&gt;%</span> <span class="fu">filter</span>(language <span class="sc">==</span> <span class="st">"no"</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>norwegian</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["number"],"name":[1],"type":["int"],"align":["right"]},{"label":["language"],"name":[2],"type":["chr"],"align":["left"]},{"label":["name"],"name":[3],"type":["chr"],"align":["left"]},{"label":["first"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"no","3":"en","4":"e"},{"1":"2","2":"no","3":"to","4":"t"},{"1":"3","2":"no","3":"tre","4":"t"},{"1":"4","2":"no","3":"fire","4":"f"},{"1":"5","2":"no","3":"fem","4":"f"},{"1":"6","2":"no","3":"seks","4":"s"},{"1":"7","2":"no","3":"sju","4":"s"},{"1":"8","2":"no","3":"atte","4":"a"},{"1":"9","2":"no","3":"ni","4":"n"},{"1":"10","2":"no","3":"ti","4":"t"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>And now we want to put them side by side, matched by number. This is what <code>left_join</code> does. (A “join” is a lookup of values in one table using another.)</p>
</section>
<section id="the-join" class="slide level2">
<h2>The join</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>english <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(norwegian, <span class="fu">join_by</span>(number))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["number"],"name":[1],"type":["int"],"align":["right"]},{"label":["language.x"],"name":[2],"type":["chr"],"align":["left"]},{"label":["name.x"],"name":[3],"type":["chr"],"align":["left"]},{"label":["first.x"],"name":[4],"type":["chr"],"align":["left"]},{"label":["language.y"],"name":[5],"type":["chr"],"align":["left"]},{"label":["name.y"],"name":[6],"type":["chr"],"align":["left"]},{"label":["first.y"],"name":[7],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"en","3":"one","4":"o","5":"no","6":"en","7":"e"},{"1":"2","2":"en","3":"two","4":"t","5":"no","6":"to","7":"t"},{"1":"3","2":"en","3":"three","4":"t","5":"no","6":"tre","7":"t"},{"1":"4","2":"en","3":"four","4":"f","5":"no","6":"fire","7":"f"},{"1":"5","2":"en","3":"five","4":"f","5":"no","6":"fem","7":"f"},{"1":"6","2":"en","3":"six","4":"s","5":"no","6":"seks","7":"s"},{"1":"7","2":"en","3":"seven","4":"s","5":"no","6":"sju","7":"s"},{"1":"8","2":"en","3":"eight","4":"e","5":"no","6":"atte","7":"a"},{"1":"9","2":"en","3":"nine","4":"n","5":"no","6":"ni","7":"n"},{"1":"10","2":"en","3":"ten","4":"t","5":"no","6":"ti","7":"t"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>first.x</code> is 1st letter of English word, <code>first.y</code> 1st letter of Norwegian word.</p>
</section>
<section id="counting-the-different-ones" class="slide level2">
<h2>Counting the different ones</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>english <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(norwegian, <span class="fu">join_by</span>(number)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">count</span>(<span class="at">different=</span>(first.x <span class="sc">!=</span> first.y)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["different"],"name":[1],"type":["lgl"],"align":["right"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"FALSE","2":"8"},{"1":"TRUE","2":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>english <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(norwegian, <span class="fu">join_by</span>(number)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">count</span>(<span class="at">different=</span>(first.x <span class="sc">!=</span> first.y)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3"></a>  <span class="fu">filter</span>(different) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(n) <span class="ot">-&gt;</span> ans</span>
<span id="cb24-4"><a href="#cb24-4"></a>ans</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>Words for 1 and 8 start with different letter; rest are same.</p>
</section>
<section id="a-language-with-itself" class="slide level2">
<h2>A language with itself</h2>
<p>The answer should be zero:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>english <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(english, <span class="fu">join_by</span>(number)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="fu">count</span>(<span class="at">different=</span>(first.x <span class="sc">!=</span> first.y)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="fu">filter</span>(different) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(n) <span class="ot">-&gt;</span> ans</span>
<span id="cb26-4"><a href="#cb26-4"></a>ans</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>integer(0)</code></pre>
</div>
</div>
<ul>
<li>but this is “an integer vector of length zero”.</li>
<li>so we have to allow for this possibility when we write a function to do it.</li>
</ul>
</section>
<section id="function-to-do-this-for-any-two-languages" class="slide level2">
<h2>Function to do this for any two languages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>countdiff <span class="ot">&lt;-</span> <span class="cf">function</span>(lang<span class="fl">.1</span>, lang<span class="fl">.2</span>, d) {</span>
<span id="cb28-2"><a href="#cb28-2"></a>  d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(language <span class="sc">==</span> lang<span class="fl">.1</span>) <span class="ot">-&gt;</span> lang1d</span>
<span id="cb28-3"><a href="#cb28-3"></a>  d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(language <span class="sc">==</span> lang<span class="fl">.2</span>) <span class="ot">-&gt;</span> lang2d</span>
<span id="cb28-4"><a href="#cb28-4"></a>  lang1d <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5"></a>    <span class="fu">left_join</span>(lang2d, <span class="fu">join_by</span>(number)) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6"></a>    <span class="fu">count</span>(<span class="at">different =</span> (first.x <span class="sc">!=</span> first.y)) <span class="sc">%&gt;%</span></span>
<span id="cb28-7"><a href="#cb28-7"></a>    <span class="fu">filter</span>(different) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(n) <span class="ot">-&gt;</span> ans</span>
<span id="cb28-8"><a href="#cb28-8"></a>  <span class="co"># if ans has length zero, set answer to (integer) zero.</span></span>
<span id="cb28-9"><a href="#cb28-9"></a>  <span class="fu">ifelse</span>(<span class="fu">length</span>(ans)<span class="sc">==</span><span class="dv">0</span>, 0L, ans) </span>
<span id="cb28-10"><a href="#cb28-10"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="testing" class="slide level2">
<h2>Testing</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">countdiff</span>(<span class="st">"en"</span>, <span class="st">"no"</span>, lang.long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">countdiff</span>(<span class="st">"en"</span>, <span class="st">"en"</span>, lang.long)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>English and Norwegian have two different; English and English have none different.</p>
<p>Check.</p>
</section>
<section id="for-all-pairs-of-languages" class="slide level2">
<h2>For all pairs of languages?</h2>
<ul>
<li>First need all the languages:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>languages <span class="ot">&lt;-</span> <span class="fu">names</span>(lang)</span>
<span id="cb33-2"><a href="#cb33-2"></a>languages</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "en" "no" "dk" "nl" "de" "fr" "es" "it" "pl"
[10] "hu" "fi"</code></pre>
</div>
</div>
<ul>
<li>and then all <em>pairs</em> of languages:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>pairs <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">lang =</span> languages, <span class="at">lang2 =</span> languages) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-pairs" class="slide level2">
<h2>The pairs</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>pairs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["lang"],"name":[1],"type":["chr"],"align":["left"]},{"label":["lang2"],"name":[2],"type":["chr"],"align":["left"]}],"data":[{"1":"de","2":"de"},{"1":"de","2":"dk"},{"1":"de","2":"en"},{"1":"de","2":"es"},{"1":"de","2":"fi"},{"1":"de","2":"fr"},{"1":"de","2":"hu"},{"1":"de","2":"it"},{"1":"de","2":"nl"},{"1":"de","2":"no"},{"1":"de","2":"pl"},{"1":"dk","2":"de"},{"1":"dk","2":"dk"},{"1":"dk","2":"en"},{"1":"dk","2":"es"},{"1":"dk","2":"fi"},{"1":"dk","2":"fr"},{"1":"dk","2":"hu"},{"1":"dk","2":"it"},{"1":"dk","2":"nl"},{"1":"dk","2":"no"},{"1":"dk","2":"pl"},{"1":"en","2":"de"},{"1":"en","2":"dk"},{"1":"en","2":"en"},{"1":"en","2":"es"},{"1":"en","2":"fi"},{"1":"en","2":"fr"},{"1":"en","2":"hu"},{"1":"en","2":"it"},{"1":"en","2":"nl"},{"1":"en","2":"no"},{"1":"en","2":"pl"},{"1":"es","2":"de"},{"1":"es","2":"dk"},{"1":"es","2":"en"},{"1":"es","2":"es"},{"1":"es","2":"fi"},{"1":"es","2":"fr"},{"1":"es","2":"hu"},{"1":"es","2":"it"},{"1":"es","2":"nl"},{"1":"es","2":"no"},{"1":"es","2":"pl"},{"1":"fi","2":"de"},{"1":"fi","2":"dk"},{"1":"fi","2":"en"},{"1":"fi","2":"es"},{"1":"fi","2":"fi"},{"1":"fi","2":"fr"},{"1":"fi","2":"hu"},{"1":"fi","2":"it"},{"1":"fi","2":"nl"},{"1":"fi","2":"no"},{"1":"fi","2":"pl"},{"1":"fr","2":"de"},{"1":"fr","2":"dk"},{"1":"fr","2":"en"},{"1":"fr","2":"es"},{"1":"fr","2":"fi"},{"1":"fr","2":"fr"},{"1":"fr","2":"hu"},{"1":"fr","2":"it"},{"1":"fr","2":"nl"},{"1":"fr","2":"no"},{"1":"fr","2":"pl"},{"1":"hu","2":"de"},{"1":"hu","2":"dk"},{"1":"hu","2":"en"},{"1":"hu","2":"es"},{"1":"hu","2":"fi"},{"1":"hu","2":"fr"},{"1":"hu","2":"hu"},{"1":"hu","2":"it"},{"1":"hu","2":"nl"},{"1":"hu","2":"no"},{"1":"hu","2":"pl"},{"1":"it","2":"de"},{"1":"it","2":"dk"},{"1":"it","2":"en"},{"1":"it","2":"es"},{"1":"it","2":"fi"},{"1":"it","2":"fr"},{"1":"it","2":"hu"},{"1":"it","2":"it"},{"1":"it","2":"nl"},{"1":"it","2":"no"},{"1":"it","2":"pl"},{"1":"nl","2":"de"},{"1":"nl","2":"dk"},{"1":"nl","2":"en"},{"1":"nl","2":"es"},{"1":"nl","2":"fi"},{"1":"nl","2":"fr"},{"1":"nl","2":"hu"},{"1":"nl","2":"it"},{"1":"nl","2":"nl"},{"1":"nl","2":"no"},{"1":"nl","2":"pl"},{"1":"no","2":"de"},{"1":"no","2":"dk"},{"1":"no","2":"en"},{"1":"no","2":"es"},{"1":"no","2":"fi"},{"1":"no","2":"fr"},{"1":"no","2":"hu"},{"1":"no","2":"it"},{"1":"no","2":"nl"},{"1":"no","2":"no"},{"1":"no","2":"pl"},{"1":"pl","2":"de"},{"1":"pl","2":"dk"},{"1":"pl","2":"en"},{"1":"pl","2":"es"},{"1":"pl","2":"fi"},{"1":"pl","2":"fr"},{"1":"pl","2":"hu"},{"1":"pl","2":"it"},{"1":"pl","2":"nl"},{"1":"pl","2":"no"},{"1":"pl","2":"pl"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="run-countdiff-for-all-those-language-pairs" class="slide level2">
<h2>Run <code>countdiff</code> for all those language pairs</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>pairs <span class="sc">%&gt;%</span> <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> <span class="fu">countdiff</span>(lang, lang2, lang.long)) <span class="ot">-&gt;</span> thediff</span>
<span id="cb37-3"><a href="#cb37-3"></a>thediff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["lang"],"name":[1],"type":["chr"],"align":["left"]},{"label":["lang2"],"name":[2],"type":["chr"],"align":["left"]},{"label":["diff"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"de","2":"de","3":"0"},{"1":"de","2":"dk","3":"5"},{"1":"de","2":"en","3":"6"},{"1":"de","2":"es","3":"7"},{"1":"de","2":"fi","3":"9"},{"1":"de","2":"fr","3":"7"},{"1":"de","2":"hu","3":"9"},{"1":"de","2":"it","3":"7"},{"1":"de","2":"nl","3":"5"},{"1":"de","2":"no","3":"4"},{"1":"de","2":"pl","3":"8"},{"1":"dk","2":"de","3":"5"},{"1":"dk","2":"dk","3":"0"},{"1":"dk","2":"en","3":"2"},{"1":"dk","2":"es","3":"5"},{"1":"dk","2":"fi","3":"9"},{"1":"dk","2":"fr","3":"6"},{"1":"dk","2":"hu","3":"8"},{"1":"dk","2":"it","3":"5"},{"1":"dk","2":"nl","3":"6"},{"1":"dk","2":"no","3":"1"},{"1":"dk","2":"pl","3":"6"},{"1":"en","2":"de","3":"6"},{"1":"en","2":"dk","3":"2"},{"1":"en","2":"en","3":"0"},{"1":"en","2":"es","3":"6"},{"1":"en","2":"fi","3":"9"},{"1":"en","2":"fr","3":"6"},{"1":"en","2":"hu","3":"9"},{"1":"en","2":"it","3":"6"},{"1":"en","2":"nl","3":"7"},{"1":"en","2":"no","3":"2"},{"1":"en","2":"pl","3":"7"},{"1":"es","2":"de","3":"7"},{"1":"es","2":"dk","3":"5"},{"1":"es","2":"en","3":"6"},{"1":"es","2":"es","3":"0"},{"1":"es","2":"fi","3":"9"},{"1":"es","2":"fr","3":"2"},{"1":"es","2":"hu","3":"10"},{"1":"es","2":"it","3":"1"},{"1":"es","2":"nl","3":"9"},{"1":"es","2":"no","3":"6"},{"1":"es","2":"pl","3":"3"},{"1":"fi","2":"de","3":"9"},{"1":"fi","2":"dk","3":"9"},{"1":"fi","2":"en","3":"9"},{"1":"fi","2":"es","3":"9"},{"1":"fi","2":"fi","3":"0"},{"1":"fi","2":"fr","3":"9"},{"1":"fi","2":"hu","3":"8"},{"1":"fi","2":"it","3":"9"},{"1":"fi","2":"nl","3":"9"},{"1":"fi","2":"no","3":"9"},{"1":"fi","2":"pl","3":"9"},{"1":"fr","2":"de","3":"7"},{"1":"fr","2":"dk","3":"6"},{"1":"fr","2":"en","3":"6"},{"1":"fr","2":"es","3":"2"},{"1":"fr","2":"fi","3":"9"},{"1":"fr","2":"fr","3":"0"},{"1":"fr","2":"hu","3":"10"},{"1":"fr","2":"it","3":"1"},{"1":"fr","2":"nl","3":"9"},{"1":"fr","2":"no","3":"6"},{"1":"fr","2":"pl","3":"5"},{"1":"hu","2":"de","3":"9"},{"1":"hu","2":"dk","3":"8"},{"1":"hu","2":"en","3":"9"},{"1":"hu","2":"es","3":"10"},{"1":"hu","2":"fi","3":"8"},{"1":"hu","2":"fr","3":"10"},{"1":"hu","2":"hu","3":"0"},{"1":"hu","2":"it","3":"10"},{"1":"hu","2":"nl","3":"8"},{"1":"hu","2":"no","3":"8"},{"1":"hu","2":"pl","3":"10"},{"1":"it","2":"de","3":"7"},{"1":"it","2":"dk","3":"5"},{"1":"it","2":"en","3":"6"},{"1":"it","2":"es","3":"1"},{"1":"it","2":"fi","3":"9"},{"1":"it","2":"fr","3":"1"},{"1":"it","2":"hu","3":"10"},{"1":"it","2":"it","3":"0"},{"1":"it","2":"nl","3":"9"},{"1":"it","2":"no","3":"6"},{"1":"it","2":"pl","3":"4"},{"1":"nl","2":"de","3":"5"},{"1":"nl","2":"dk","3":"6"},{"1":"nl","2":"en","3":"7"},{"1":"nl","2":"es","3":"9"},{"1":"nl","2":"fi","3":"9"},{"1":"nl","2":"fr","3":"9"},{"1":"nl","2":"hu","3":"8"},{"1":"nl","2":"it","3":"9"},{"1":"nl","2":"nl","3":"0"},{"1":"nl","2":"no","3":"5"},{"1":"nl","2":"pl","3":"10"},{"1":"no","2":"de","3":"4"},{"1":"no","2":"dk","3":"1"},{"1":"no","2":"en","3":"2"},{"1":"no","2":"es","3":"6"},{"1":"no","2":"fi","3":"9"},{"1":"no","2":"fr","3":"6"},{"1":"no","2":"hu","3":"8"},{"1":"no","2":"it","3":"6"},{"1":"no","2":"nl","3":"5"},{"1":"no","2":"no","3":"0"},{"1":"no","2":"pl","3":"7"},{"1":"pl","2":"de","3":"8"},{"1":"pl","2":"dk","3":"6"},{"1":"pl","2":"en","3":"7"},{"1":"pl","2":"es","3":"3"},{"1":"pl","2":"fi","3":"9"},{"1":"pl","2":"fr","3":"5"},{"1":"pl","2":"hu","3":"10"},{"1":"pl","2":"it","3":"4"},{"1":"pl","2":"nl","3":"10"},{"1":"pl","2":"no","3":"7"},{"1":"pl","2":"pl","3":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="make-square-table-of-these" class="slide level2">
<h2>Make square table of these</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>thediff <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>lang2, <span class="at">values_from=</span>diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["lang"],"name":[1],"type":["chr"],"align":["left"]},{"label":["de"],"name":[2],"type":["int"],"align":["right"]},{"label":["dk"],"name":[3],"type":["int"],"align":["right"]},{"label":["en"],"name":[4],"type":["int"],"align":["right"]},{"label":["es"],"name":[5],"type":["int"],"align":["right"]},{"label":["fi"],"name":[6],"type":["int"],"align":["right"]},{"label":["fr"],"name":[7],"type":["int"],"align":["right"]},{"label":["hu"],"name":[8],"type":["int"],"align":["right"]},{"label":["it"],"name":[9],"type":["int"],"align":["right"]},{"label":["nl"],"name":[10],"type":["int"],"align":["right"]},{"label":["no"],"name":[11],"type":["int"],"align":["right"]},{"label":["pl"],"name":[12],"type":["int"],"align":["right"]}],"data":[{"1":"de","2":"0","3":"5","4":"6","5":"7","6":"9","7":"7","8":"9","9":"7","10":"5","11":"4","12":"8"},{"1":"dk","2":"5","3":"0","4":"2","5":"5","6":"9","7":"6","8":"8","9":"5","10":"6","11":"1","12":"6"},{"1":"en","2":"6","3":"2","4":"0","5":"6","6":"9","7":"6","8":"9","9":"6","10":"7","11":"2","12":"7"},{"1":"es","2":"7","3":"5","4":"6","5":"0","6":"9","7":"2","8":"10","9":"1","10":"9","11":"6","12":"3"},{"1":"fi","2":"9","3":"9","4":"9","5":"9","6":"0","7":"9","8":"8","9":"9","10":"9","11":"9","12":"9"},{"1":"fr","2":"7","3":"6","4":"6","5":"2","6":"9","7":"0","8":"10","9":"1","10":"9","11":"6","12":"5"},{"1":"hu","2":"9","3":"8","4":"9","5":"10","6":"8","7":"10","8":"0","9":"10","10":"8","11":"8","12":"10"},{"1":"it","2":"7","3":"5","4":"6","5":"1","6":"9","7":"1","8":"10","9":"0","10":"9","11":"6","12":"4"},{"1":"nl","2":"5","3":"6","4":"7","5":"9","6":"9","7":"9","8":"8","9":"9","10":"0","11":"5","12":"10"},{"1":"no","2":"4","3":"1","4":"2","5":"6","6":"9","7":"6","8":"8","9":"6","10":"5","11":"0","12":"7"},{"1":"pl","2":"8","3":"6","4":"7","5":"3","6":"9","7":"5","8":"10","9":"4","10":"10","11":"7","12":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>and that was where we began.</p>
</section>
<section id="another-example" class="slide level2">
<h2>Another example</h2>
<p>Birth, death and infant mortality rates for 97 countries (variables not dissimilarities):</p>
<pre><code>24.7  5.7  30.8 Albania         12.5 11.9  14.4 Bulgaria
13.4 11.7  11.3 Czechoslovakia  12   12.4   7.6 Former_E._Germany
11.6 13.4  14.8 Hungary         14.3 10.2    16 Poland
13.6 10.7  26.9 Romania           14    9  20.2 Yugoslavia
17.7   10    23 USSR            15.2  9.5  13.1 Byelorussia_SSR
13.4 11.6    13 Ukrainian_SSR   20.7  8.4  25.7 Argentina
46.6   18   111 Bolivia         28.6  7.9    63 Brazil
23.4  5.8  17.1 Chile           27.4  6.1    40 Columbia
32.9  7.4    63 Ecuador         28.3  7.3    56 Guyana
...</code></pre>
<ul>
<li><p>Want to find groups of similar countries (and how many groups, which countries in each group).</p></li>
<li><p>Tree would be unwieldy with 97 countries.</p></li>
<li><p>More automatic way of finding given number of clusters?</p></li>
</ul>
</section>
<section id="reading-in" class="slide level2">
<h2>Reading in</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/birthrate.txt"</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>vital <span class="ot">&lt;-</span> <span class="fu">read_table</span>(url)</span>
<span id="cb40-3"><a href="#cb40-3"></a>vital</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["birth"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["death"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["infant"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["country"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"24.7","2":"5.7","3":"30.8","4":"Albania"},{"1":"13.4","2":"11.7","3":"11.3","4":"Czechoslovakia"},{"1":"11.6","2":"13.4","3":"14.8","4":"Hungary"},{"1":"13.6","2":"10.7","3":"26.9","4":"Romania"},{"1":"17.7","2":"10.0","3":"23.0","4":"USSR"},{"1":"13.4","2":"11.6","3":"13.0","4":"Ukrainian_SSR"},{"1":"46.6","2":"18.0","3":"111.0","4":"Bolivia"},{"1":"23.4","2":"5.8","3":"17.1","4":"Chile"},{"1":"32.9","2":"7.4","3":"63.0","4":"Ecuador"},{"1":"34.8","2":"6.6","3":"42.0","4":"Paraguay"},{"1":"18.0","2":"9.6","3":"21.9","4":"Uruguay"},{"1":"29.0","2":"23.2","3":"43.0","4":"Mexico"},{"1":"13.2","2":"10.1","3":"5.8","4":"Finland"},{"1":"13.6","2":"9.4","3":"7.4","4":"France"},{"1":"10.1","2":"9.2","3":"11.0","4":"Greece"},{"1":"9.7","2":"9.1","3":"8.8","4":"Italy"},{"1":"14.3","2":"10.7","3":"7.8","4":"Norway"},{"1":"10.7","2":"8.2","3":"8.1","4":"Spain"},{"1":"12.5","2":"9.5","3":"7.1","4":"Switzerland"},{"1":"14.9","2":"7.4","3":"8.0","4":"Austria"},{"1":"14.5","2":"7.3","3":"7.2","4":"Canada"},{"1":"40.4","2":"18.7","3":"181.6","4":"Afghanistan"},{"1":"42.5","2":"11.5","3":"108.1","4":"Iran"},{"1":"22.3","2":"6.3","3":"9.7","4":"Israel"},{"1":"26.8","2":"2.2","3":"15.6","4":"Kuwait"},{"1":"45.6","2":"7.8","3":"40.0","4":"Oman"},{"1":"29.2","2":"8.4","3":"76.0","4":"Turkey"},{"1":"42.2","2":"15.5","3":"119.0","4":"Bangladesh"},{"1":"21.2","2":"6.7","3":"32.0","4":"China"},{"1":"30.5","2":"10.2","3":"91.0","4":"India"},{"1":"23.5","2":"18.1","3":"25.0","4":"Korea"},{"1":"36.1","2":"8.8","3":"68.0","4":"Mongolia"},{"1":"30.3","2":"8.1","3":"107.7","4":"Pakistan"},{"1":"17.8","2":"5.2","3":"7.5","4":"Singapore"},{"1":"22.3","2":"7.7","3":"28.0","4":"Thailand"},{"1":"35.5","2":"8.3","3":"74.0","4":"Algeria"},{"1":"48.5","2":"11.6","3":"67.0","4":"Botswana"},{"1":"38.8","2":"9.5","3":"49.4","4":"Egypt"},{"1":"39.4","2":"16.8","3":"103.0","4":"Gabon"},{"1":"44.4","2":"13.1","3":"90.0","4":"Ghana"},{"1":"44.0","2":"9.4","3":"82.0","4":"Libya"},{"1":"35.5","2":"9.8","3":"82.0","4":"Morocco"},{"1":"44.0","2":"12.1","3":"135.0","4":"Namibia"},{"1":"48.2","2":"23.4","3":"154.0","4":"Sierra_Leone"},{"1":"32.1","2":"9.9","3":"72.0","4":"South_Africa"},{"1":"46.8","2":"12.5","3":"118.0","4":"Swaziland"},{"1":"52.2","2":"15.6","3":"103.0","4":"Uganda"},{"1":"45.6","2":"14.2","3":"83.0","4":"Zaire"},{"1":"41.7","2":"10.3","3":"66.0","4":"Zimbabwe"},{"1":"12.5","2":"11.9","3":"14.4","4":"Bulgaria"},{"1":"12.0","2":"12.4","3":"7.6","4":"Former_E._Germany"},{"1":"14.3","2":"10.2","3":"16.0","4":"Poland"},{"1":"14.0","2":"9.0","3":"20.2","4":"Yugoslavia"},{"1":"15.2","2":"9.5","3":"13.1","4":"Byelorussia_SSR"},{"1":"20.7","2":"8.4","3":"25.7","4":"Argentina"},{"1":"28.6","2":"7.9","3":"63.0","4":"Brazil"},{"1":"27.4","2":"6.1","3":"40.0","4":"Columbia"},{"1":"28.3","2":"7.3","3":"56.0","4":"Guyana"},{"1":"32.9","2":"8.3","3":"109.9","4":"Peru"},{"1":"27.5","2":"4.4","3":"23.3","4":"Venezuela"},{"1":"12.0","2":"10.6","3":"7.9","4":"Belgium"},{"1":"12.4","2":"11.9","3":"7.5","4":"Denmark"},{"1":"11.4","2":"11.2","3":"7.4","4":"Germany"},{"1":"15.1","2":"9.1","3":"7.5","4":"Ireland"},{"1":"13.2","2":"8.6","3":"7.1","4":"Netherlands"},{"1":"11.9","2":"9.5","3":"13.1","4":"Portugal"},{"1":"14.5","2":"11.1","3":"5.6","4":"Sweden"},{"1":"13.6","2":"11.5","3":"8.4","4":"U.K."},{"1":"9.9","2":"6.7","3":"4.5","4":"Japan"},{"1":"16.7","2":"8.1","3":"9.1","4":"U.S.A."},{"1":"28.4","2":"3.8","3":"16.0","4":"Bahrain"},{"1":"42.6","2":"7.8","3":"69.0","4":"Iraq"},{"1":"38.9","2":"6.4","3":"44.0","4":"Jordan"},{"1":"31.7","2":"8.7","3":"48.0","4":"Lebanon"},{"1":"42.1","2":"7.6","3":"71.0","4":"Saudi_Arabia"},{"1":"22.8","2":"3.8","3":"26.0","4":"United_Arab_Emirates"},{"1":"41.4","2":"16.6","3":"130.0","4":"Cambodia"},{"1":"11.7","2":"4.9","3":"6.1","4":"Hong_Kong"},{"1":"28.6","2":"9.4","3":"75.0","4":"Indonesia"},{"1":"31.6","2":"5.6","3":"24.0","4":"Malaysia"},{"1":"39.6","2":"14.8","3":"128.0","4":"Nepal"},{"1":"33.2","2":"7.7","3":"45.0","4":"Philippines"},{"1":"21.3","2":"6.2","3":"19.4","4":"Sri_Lanka"},{"1":"31.8","2":"9.5","3":"64.0","4":"Vietnam"},{"1":"47.2","2":"20.2","3":"137.0","4":"Angola"},{"1":"46.1","2":"14.6","3":"73.0","4":"Congo"},{"1":"48.6","2":"20.7","3":"137.0","4":"Ethiopia"},{"1":"47.4","2":"21.4","3":"143.0","4":"Gambia"},{"1":"47.0","2":"11.3","3":"72.0","4":"Kenya"},{"1":"48.3","2":"25.0","3":"130.0","4":"Malawi"},{"1":"45.0","2":"18.5","3":"141.0","4":"Mozambique"},{"1":"48.5","2":"15.6","3":"105.0","4":"Nigeria"},{"1":"50.1","2":"20.2","3":"132.0","4":"Somalia"},{"1":"44.6","2":"15.8","3":"108.0","4":"Sudan"},{"1":"31.1","2":"7.3","3":"52.0","4":"Tunisia"},{"1":"50.5","2":"14.0","3":"106.0","4":"Tanzania"},{"1":"51.1","2":"13.7","3":"80.0","4":"Zambia"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="standardizing" class="slide level2">
<h2>Standardizing</h2>
<ul>
<li><p>Infant mortality rate numbers bigger than others, consequence of measurement scale (arbitrary).</p></li>
<li><p>Standardize (numerical) columns of data frame to have mean 0, SD 1, done by <code>scale</code>.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>vital <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="#cb41-2"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), \(x) <span class="fu">scale</span>(x))) <span class="ot">-&gt;</span> vital.s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="three-clusters" class="slide level2">
<h2>Three clusters</h2>
<p>Pretend we know 3 clusters is good. Take off the column of countries, and run <code>kmeans</code> on the resulting data frame, asking for 3 clusters:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>vital.s <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>country) <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2"></a>  <span class="fu">kmeans</span>(<span class="dv">3</span>) <span class="ot">-&gt;</span> vital.km3</span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="fu">names</span>(vital.km3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "cluster"      "centers"      "totss"       
[4] "withinss"     "tot.withinss" "betweenss"   
[7] "size"         "iter"         "ifault"      </code></pre>
</div>
</div>
<p>A lot of output, so look at these individually.</p>
</section>
<section id="whats-in-the-output" class="slide level2">
<h2>What’s in the output?</h2>
<ul>
<li>Cluster sizes:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>vital.km3<span class="sc">$</span>size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40 25 32</code></pre>
</div>
</div>
<ul>
<li>Cluster centres:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>vital.km3<span class="sc">$</span>centers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       birth      death      infant
1 -1.0376994 -0.3289046 -0.90669032
2  1.1780071  1.3323130  1.32732200
3  0.3768062 -0.6297388  0.09639258</code></pre>
</div>
</div>
<ul>
<li>Cluster 2 has lower than average rates on everything; cluster 3 has much higher than average.</li>
</ul>
</section>
<section id="cluster-sums-of-squares-and-membership" class="slide level2">
<h2>Cluster sums of squares and membership</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>vital.km3<span class="sc">$</span>withinss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17.21617 28.32560 21.53020</code></pre>
</div>
</div>
<p>Cluster 1 compact relative to others (countries in cluster 1 more similar).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>vital.km3<span class="sc">$</span>cluster</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 3 1 1 1 1 1 2 1 3 3 1 2 1 1 1 1 1 1 1 1 1 2 2 1 3 3 3 2
[29] 1 3 1 3 3 1 1 3 3 3 2 2 3 3 2 2 3 2 2 2 3 1 1 1 1 1 1 3
[57] 3 3 3 3 1 1 1 1 1 1 1 1 1 1 3 3 3 3 3 1 2 1 3 3 2 3 1 3
[85] 2 2 2 2 3 2 2 2 2 2 3 2 2</code></pre>
</div>
</div>
<p>The cluster membership for each of the 97 countries.</p>
</section>
<section id="store-countries-and-clusters-to-which-they-belong" class="slide level2">
<h2>Store countries and clusters to which they belong</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>vital<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb52-2"><a href="#cb52-2"></a>  <span class="at">country =</span> vital.s<span class="sc">$</span>country,</span>
<span id="cb52-3"><a href="#cb52-3"></a>  <span class="at">cluster =</span> vital.km3<span class="sc">$</span>cluster</span>
<span id="cb52-4"><a href="#cb52-4"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, which countries in which cluster?</p>
<p>Write function to extract them:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>get_countries <span class="ot">&lt;-</span> <span class="cf">function</span>(i, d) {</span>
<span id="cb53-2"><a href="#cb53-2"></a>  d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(cluster <span class="sc">==</span> i) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(country)</span>
<span id="cb53-3"><a href="#cb53-3"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cluster-membership-cluster-2" class="slide level2">
<h2>Cluster membership: cluster 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="fu">get_countries</span>(<span class="dv">2</span>, vital<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Bolivia"      "Mexico"       "Afghanistan" 
 [4] "Iran"         "Bangladesh"   "Gabon"       
 [7] "Ghana"        "Namibia"      "Sierra_Leone"
[10] "Swaziland"    "Uganda"       "Zaire"       
[13] "Cambodia"     "Nepal"        "Angola"      
[16] "Congo"        "Ethiopia"     "Gambia"      
[19] "Malawi"       "Mozambique"   "Nigeria"     
[22] "Somalia"      "Sudan"        "Tanzania"    
[25] "Zambia"      </code></pre>
</div>
</div>
</section>
<section id="cluster-3" class="slide level2">
<h2>Cluster 3</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="fu">get_countries</span>(<span class="dv">3</span>, vital<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Albania"      "Ecuador"      "Paraguay"    
 [4] "Kuwait"       "Oman"         "Turkey"      
 [7] "India"        "Mongolia"     "Pakistan"    
[10] "Algeria"      "Botswana"     "Egypt"       
[13] "Libya"        "Morocco"      "South_Africa"
[16] "Zimbabwe"     "Brazil"       "Columbia"    
[19] "Guyana"       "Peru"         "Venezuela"   
[22] "Bahrain"      "Iraq"         "Jordan"      
[25] "Lebanon"      "Saudi_Arabia" "Indonesia"   
[28] "Malaysia"     "Philippines"  "Vietnam"     
[31] "Kenya"        "Tunisia"     </code></pre>
</div>
</div>
</section>
<section id="cluster-1" class="slide level2">
<h2>Cluster 1</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">get_countries</span>(<span class="dv">1</span>, vital<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Czechoslovakia"       "Hungary"             
 [3] "Romania"              "USSR"                
 [5] "Ukrainian_SSR"        "Chile"               
 [7] "Uruguay"              "Finland"             
 [9] "France"               "Greece"              
[11] "Italy"                "Norway"              
[13] "Spain"                "Switzerland"         
[15] "Austria"              "Canada"              
[17] "Israel"               "China"               
[19] "Korea"                "Singapore"           
[21] "Thailand"             "Bulgaria"            
[23] "Former_E._Germany"    "Poland"              
[25] "Yugoslavia"           "Byelorussia_SSR"     
[27] "Argentina"            "Belgium"             
[29] "Denmark"              "Germany"             
[31] "Ireland"              "Netherlands"         
[33] "Portugal"             "Sweden"              
[35] "U.K."                 "Japan"               
[37] "U.S.A."               "United_Arab_Emirates"
[39] "Hong_Kong"            "Sri_Lanka"           </code></pre>
</div>
</div>
</section>
<section id="problem" class="slide level2">
<h2>Problem!</h2>
<ul>
<li><p><code>kmeans</code> uses randomization. So result of one run might be different from another run.</p></li>
<li><p>Example: just run again on 3 clusters, <code>table</code> of results:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>vital.s <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="#cb60-2"></a>  <span class="fu">select</span>(<span class="sc">-</span>country) <span class="sc">%&gt;%</span> <span class="fu">kmeans</span>(<span class="dv">3</span>) <span class="ot">-&gt;</span> vital.km3a</span>
<span id="cb60-3"><a href="#cb60-3"></a><span class="fu">table</span>(</span>
<span id="cb60-4"><a href="#cb60-4"></a>  <span class="at">first =</span> vital.km3<span class="sc">$</span>cluster,</span>
<span id="cb60-5"><a href="#cb60-5"></a>  <span class="at">second =</span> vital.km3a<span class="sc">$</span>cluster</span>
<span id="cb60-6"><a href="#cb60-6"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     second
first  1  2  3
    1 40  0  0
    2  0 24  1
    3  4  0 28</code></pre>
</div>
</div>
<ul>
<li>Clusters are similar but <em>not same</em>.</li>
</ul>
</section>
<section id="solution-to-this" class="slide level2">
<h2>Solution to this</h2>
<ul>
<li><code>nstart</code> option on <code>kmeans</code> runs that many times, takes best. Should be same every time:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>vital.s <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2"></a>  <span class="fu">select</span>(<span class="sc">-</span>country) <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3"></a>  <span class="fu">kmeans</span>(<span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">20</span>) <span class="ot">-&gt;</span> vital.km3b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="how-many-clusters" class="slide level2">
<h2>How many clusters?</h2>
<ul>
<li><p>Three was just a guess.</p></li>
<li><p>Idea: try a whole bunch of #clusters (say 2–20), obtain measure of goodness of fit for each, make plot.</p></li>
<li><p>Appropriate measure is <code>tot.withinss</code>.</p></li>
<li><p>Run <code>kmeans</code> for each #clusters, get <code>tot.withinss</code> each time.</p></li>
</ul>
</section>
<section id="function-to-get-tot.withinss" class="slide level2">
<h2>Function to get <code>tot.withinss</code></h2>
<p>for an input number of clusters, taking only numeric columns of input data frame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>ss <span class="ot">&lt;-</span> <span class="cf">function</span>(i, d) {</span>
<span id="cb63-2"><a href="#cb63-2"></a>  d <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="#cb63-3"></a>    <span class="fu">select</span>(<span class="fu">where</span>(is.numeric)) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4"></a>    <span class="fu">kmeans</span>(i, <span class="at">nstart =</span> <span class="dv">20</span>) <span class="ot">-&gt;</span> km</span>
<span id="cb63-5"><a href="#cb63-5"></a>  km<span class="sc">$</span>tot.withinss</span>
<span id="cb63-6"><a href="#cb63-6"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note: writing function to be as general as possible, so that we can re-use it later.</p>
</section>
<section id="constructing-within-cluster-ss" class="slide level2">
<h2>Constructing within-cluster SS</h2>
<p>Make a data frame with desired numbers of clusters, and fill it with the total within-group sums of squares. <code>ss</code> expects a single number of clusters, not a vector of several, so run <code>rowwise</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="fu">tibble</span>(<span class="at">clusters =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb64-2"><a href="#cb64-2"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb64-3"><a href="#cb64-3"></a>  <span class="fu">mutate</span>(<span class="at">wss =</span> <span class="fu">ss</span>(clusters, vital.s)) <span class="ot">-&gt;</span> ssd</span>
<span id="cb64-4"><a href="#cb64-4"></a>ssd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["clusters"],"name":[1],"type":["int"],"align":["right"]},{"label":["wss"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"117.375682"},{"1":"3","2":"66.883275"},{"1":"4","2":"51.403362"},{"1":"5","2":"37.513143"},{"1":"6","2":"28.659864"},{"1":"7","2":"24.714303"},{"1":"8","2":"22.214262"},{"1":"9","2":"19.760385"},{"1":"10","2":"17.472883"},{"1":"11","2":"16.090470"},{"1":"12","2":"14.667002"},{"1":"13","2":"13.286864"},{"1":"14","2":"12.106829"},{"1":"15","2":"11.237863"},{"1":"16","2":"10.549220"},{"1":"17","2":"9.707915"},{"1":"18","2":"8.979734"},{"1":"19","2":"8.437435"},{"1":"20","2":"7.974564"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="scree-plot" class="slide level2">
<h2>Scree plot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="fu">ggplot</span>(ssd, <span class="fu">aes</span>(<span class="at">x =</span> clusters, <span class="at">y =</span> wss)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="cluster_files/figure-revealjs/favalli-1.png" width="960" class="r-stretch"></section>
<section id="interpreting-scree-plot" class="slide level2">
<h2>Interpreting scree plot</h2>
<ul>
<li><p>Lower <code>wss</code> better.</p></li>
<li><p>But lower for larger #clusters, harder to explain.</p></li>
<li><p>Compromise: low-ish <code>wss</code> and low-ish #clusters.</p></li>
<li><p>Look for “elbow” in plot.</p></li>
<li><p>Idea: this is where <code>wss</code> decreases fast then slow.</p></li>
<li><p>On our plot, small elbow at 6 clusters. Try this many clusters.</p></li>
</ul>
</section>
<section id="six-clusters-using-nstart" class="slide level2">
<h2>Six clusters, using <code>nstart</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="fu">set.seed</span>(<span class="dv">457299</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>vital.s <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2"></a>  <span class="fu">select</span>(<span class="sc">-</span>country) <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3"></a>  <span class="fu">kmeans</span>(<span class="dv">6</span>, <span class="at">nstart =</span> <span class="dv">20</span>) <span class="ot">-&gt;</span> vital.km6</span>
<span id="cb67-4"><a href="#cb67-4"></a>vital.km6<span class="sc">$</span>size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24 18 15  2  8 30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>vital.km6<span class="sc">$</span>centers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       birth      death     infant
1  0.4160993 -0.5169988  0.2648754
2  1.2092406  0.7441347  1.0278003
3 -0.4357690 -1.1438599 -0.7281108
4 -0.2199722  2.1116577 -0.4544435
5  1.3043848  2.1896567  1.9470306
6 -1.1737104 -0.1856375 -0.9534370</code></pre>
</div>
</div>
</section>
<section id="make-a-data-frame-of-countries-and-clusters" class="slide level2">
<h2>Make a data frame of countries and clusters</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>vital<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb71-2"><a href="#cb71-2"></a>  <span class="at">country =</span> vital.s<span class="sc">$</span>country,</span>
<span id="cb71-3"><a href="#cb71-3"></a>  <span class="at">cluster =</span> vital.km6<span class="sc">$</span>cluster</span>
<span id="cb71-4"><a href="#cb71-4"></a>)</span>
<span id="cb71-5"><a href="#cb71-5"></a>vital<span class="fl">.6</span> <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["cluster"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Ghana","2":"2"},{"1":"Ukrainian_SSR","2":"6"},{"1":"Ethiopia","2":"5"},{"1":"Somalia","2":"5"},{"1":"Oman","2":"1"},{"1":"Botswana","2":"2"},{"1":"Paraguay","2":"1"},{"1":"Czechoslovakia","2":"6"},{"1":"Peru","2":"1"},{"1":"Afghanistan","2":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="cluster-1-1" class="slide level2">
<h2>Cluster 1</h2>
<p>Below-average death rate, though other rates a little higher than average:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="fu">get_countries</span>(<span class="dv">1</span>, vital<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Ecuador"      "Paraguay"     "Oman"        
 [4] "Turkey"       "India"        "Mongolia"    
 [7] "Pakistan"     "Algeria"      "Egypt"       
[10] "Libya"        "Morocco"      "South_Africa"
[13] "Zimbabwe"     "Brazil"       "Guyana"      
[16] "Peru"         "Iraq"         "Jordan"      
[19] "Lebanon"      "Saudi_Arabia" "Indonesia"   
[22] "Philippines"  "Vietnam"      "Tunisia"     </code></pre>
</div>
</div>
</section>
<section id="cluster-2" class="slide level2">
<h2>Cluster 2</h2>
<p>High on everything:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="fu">get_countries</span>(<span class="dv">2</span>, vital<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Bolivia"    "Iran"       "Bangladesh" "Botswana"  
 [5] "Gabon"      "Ghana"      "Namibia"    "Swaziland" 
 [9] "Uganda"     "Zaire"      "Cambodia"   "Nepal"     
[13] "Congo"      "Kenya"      "Nigeria"    "Sudan"     
[17] "Tanzania"   "Zambia"    </code></pre>
</div>
</div>
</section>
<section id="cluster-3-1" class="slide level2">
<h2>Cluster 3</h2>
<p>Low on everything: </p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="fu">get_countries</span>(<span class="dv">3</span>, vital<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Albania"              "Chile"               
 [3] "Israel"               "Kuwait"              
 [5] "China"                "Singapore"           
 [7] "Thailand"             "Argentina"           
 [9] "Columbia"             "Venezuela"           
[11] "Bahrain"              "United_Arab_Emirates"
[13] "Hong_Kong"            "Malaysia"            
[15] "Sri_Lanka"           </code></pre>
</div>
</div>
</section>
<section id="cluster-4" class="slide level2">
<h2>Cluster 4</h2>
<p>Very high death rate, just below average on all else:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="fu">get_countries</span>(<span class="dv">4</span>, vital<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mexico" "Korea" </code></pre>
</div>
</div>
</section>
<section id="cluster-5" class="slide level2">
<h2>Cluster 5</h2>
<p>Very high on everything:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="fu">get_countries</span>(<span class="dv">5</span>, vital<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Afghanistan"  "Sierra_Leone" "Angola"      
[4] "Ethiopia"     "Gambia"       "Malawi"      
[7] "Mozambique"   "Somalia"     </code></pre>
</div>
</div>
</section>
<section id="cluster-6" class="slide level2">
<h2>Cluster 6</h2>
<p>A bit below average on everything:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="fu">get_countries</span>(<span class="dv">6</span>, vital<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Czechoslovakia"    "Hungary"          
 [3] "Romania"           "USSR"             
 [5] "Ukrainian_SSR"     "Uruguay"          
 [7] "Finland"           "France"           
 [9] "Greece"            "Italy"            
[11] "Norway"            "Spain"            
[13] "Switzerland"       "Austria"          
[15] "Canada"            "Bulgaria"         
[17] "Former_E._Germany" "Poland"           
[19] "Yugoslavia"        "Byelorussia_SSR"  
[21] "Belgium"           "Denmark"          
[23] "Germany"           "Ireland"          
[25] "Netherlands"       "Portugal"         
[27] "Sweden"            "U.K."             
[29] "Japan"             "U.S.A."           </code></pre>
</div>
</div>
</section>
<section id="comparing-our-3-and-6-cluster-solutions" class="slide level2">
<h2>Comparing our 3 and 6-cluster solutions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="fu">table</span>(<span class="at">three =</span> vital.km3<span class="sc">$</span>cluster, <span class="at">six =</span> vital.km6<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     six
three  1  2  3  4  5  6
    1  0  0  9  1  0 30
    2  0 16  0  1  8  0
    3 24  2  6  0  0  0</code></pre>
</div>
</div>
<p>Compared to 3-cluster solution:</p>
<ul>
<li><p>most of (old) cluster 1 gone to (new) cluster 6</p></li>
<li><p>cluster 2 split into clusters 2 and 5 (two types of “poor” countries)</p></li>
<li><p>cluster 3 split into clusters 1 and 3 (two types of “intermediate” countries, divided by death rate).</p></li>
</ul>
</section>
<section id="getting-a-picture-from-kmeans" class="slide level2">
<h2>Getting a picture from <code>kmeans</code></h2>
<ul>
<li>Use discriminant analysis on clusters found, treating them as “known” groups.</li>
</ul>
</section>
<section id="discriminant-analysis" class="slide level2">
<h2>Discriminant analysis</h2>
<ul>
<li><p>So what makes the groups different?</p></li>
<li><p>Uses package <code>MASS</code> (loaded):</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>vital.lda <span class="ot">&lt;-</span> <span class="fu">lda</span>(vital.km6<span class="sc">$</span>cluster <span class="sc">~</span> birth <span class="sc">+</span> death <span class="sc">+</span> infant, </span>
<span id="cb86-2"><a href="#cb86-2"></a>                 <span class="at">data =</span> vital.s)</span>
<span id="cb86-3"><a href="#cb86-3"></a>vital.lda<span class="sc">$</span>svd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21.687195  8.851811  1.773006</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>vital.lda<span class="sc">$</span>scaling</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             LD1        LD2        LD3
birth  2.6879695  1.1224202 -1.9483853
death  0.6652712 -2.7213044 -0.6049358
infant 2.1111801  0.7650912  2.3542296</code></pre>
</div>
</div>
<ul>
<li><p>LD1 is some of everything (high=poor, low=rich).</p></li>
<li><p>LD2 mainly death rate, high or low.</p></li>
</ul>
</section>
<section id="a-data-frame-to-make-plot-from" class="slide level2">
<h2>A data frame to make plot from</h2>
<ul>
<li>Get predictions first:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>vital.pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(vital.lda)</span>
<span id="cb90-2"><a href="#cb90-2"></a>d <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb90-3"><a href="#cb90-3"></a>  <span class="at">country =</span> vital.s<span class="sc">$</span>country,</span>
<span id="cb90-4"><a href="#cb90-4"></a>  <span class="at">cluster =</span> vital.km6<span class="sc">$</span>cluster, </span>
<span id="cb90-5"><a href="#cb90-5"></a>  vital.pred<span class="sc">$</span>x</span>
<span id="cb90-6"><a href="#cb90-6"></a>)</span>
<span id="cb90-7"><a href="#cb90-7"></a>d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["country"],"name":[1],"type":["chr"],"align":["left"]},{"label":["cluster"],"name":[2],"type":["int"],"align":["right"]},{"label":["LD1"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LD2"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["LD3"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"Albania","2":"3","3":"-2.74034473","4":"2.23114272","5":"0.086392118","_rn_":"1"},{"1":"Czechoslovakia","2":"6","3":"-5.01874312","4":"-2.54276395","5":"-0.067491502","_rn_":"2"},{"1":"Hungary","2":"6","3":"-4.97189595","4":"-3.62910309","5":"0.149274227","_rn_":"3"},{"1":"Romania","2":"6","3":"-4.40612396","4":"-1.68114304","5":"0.832426535","_rn_":"4"},{"1":"USSR","2":"6","3":"-3.87181416","4":"-0.99643221","5":"0.134219177","_rn_":"5"},{"1":"Ukrainian_SSR","2":"6","3":"-4.95502329","4":"-2.45593006","5":"0.032543051","_rn_":"6"},{"1":"Bolivia","2":"2","3":"7.04719692","4":"-1.82235340","5":"-0.559232315","_rn_":"7"},{"1":"Chile","2":"3","3":"-3.61284528","4":"1.83697531","5":"-0.440912763","_rn_":"8"},{"1":"Ecuador","2":"1","3":"0.60813286","4":"2.45078735","5":"0.333955737","_rn_":"9"},{"1":"Paraguay","2":"1","3":"-0.09333631","4":"2.72730980","5":"-0.910115449","_rn_":"10"},{"1":"Uruguay","2":"6","3":"-3.92003877","4":"-0.75565723","5":"0.086830641","_rn_":"11"},{"1":"Mexico","2":"4","3":"1.17794263","4":"-7.45661911","5":"-2.185449656","_rn_":"12"},{"1":"Finland","2":"6","3":"-5.53992595","4":"-1.71396053","5":"-0.111993227","_rn_":"13"},{"1":"France","2":"6","3":"-5.48731510","4":"-1.24432254","5":"0.003489983","_rn_":"14"},{"1":"Greece","2":"6","3":"-6.04517374","4":"-1.35732249","5":"0.717192252","_rn_":"15"},{"1":"Italy","2":"6","3":"-6.23984314","4":"-1.36850774","5":"0.675127833","_rn_":"16"},{"1":"Norway","2":"6","3":"-5.14396822","4":"-1.94087447","5":"-0.245927314","_rn_":"17"},{"1":"Spain","2":"6","3":"-6.20238403","4":"-0.77030865","5":"0.612616941","_rn_":"18"},{"1":"Switzerland","2":"6","3":"-5.70503604","4":"-1.39900851","5":"0.133327537","_rn_":"19"},{"1":"Austria","2":"6","3":"-5.48811665","4":"0.04445534","5":"0.107554431","_rn_":"20"},{"1":"Canada","2":"6","3":"-5.61852237","4":"0.05655923","5":"0.137152032","_rn_":"21"},{"1":"Afghanistan","2":"5","3":"9.15790453","4":"-1.57150002","5":"3.855195867","_rn_":"22"},{"1":"Iran","2":"2","3":"5.17009665","4":"1.59572127","5":"0.728082136","_rn_":"23"},{"1":"Israel","2":"3","3":"-4.09921633","4":"1.32996325","5":"-0.726569567","_rn_":"24"},{"1":"Kuwait","2":"3","3":"-3.52238895","4":"4.20168393","5":"-0.538116615","_rn_":"25"},{"1":"Oman","2":"1","3":"2.12959716","4":"2.88622987","5":"-2.722021794","_rn_":"26"},{"1":"Turkey","2":"1","3":"0.61384977","4":"1.77493550","5":"1.401386127","_rn_":"27"},{"1":"Bangladesh","2":"2","3":"6.18349326","4":"-0.58998184","5":"0.808514931","_rn_":"28"},{"1":"China","2":"3","3":"-3.23659422","4":"1.37556784","5":"0.521048584","_rn_":"29"},{"1":"India","2":"1","3":"1.81800150","4":"1.07819827","5":"1.747922987","_rn_":"30"},{"1":"Korea","2":"4","3":"-1.46967404","4":"-5.22549147","5":"-1.651932383","_rn_":"31"},{"1":"Mongolia","2":"1","3":"1.67300272","4":"1.97934176","5":"-0.052585403","_rn_":"32"},{"1":"Pakistan","2":"1","3":"2.24428372","4":"2.56907200","5":"2.904858080","_rn_":"33"},{"1":"Singapore","2":"3","3":"-5.25056428","4":"1.56461210","5":"-0.048777986","_rn_":"34"},{"1":"Thailand","2":"3","3":"-3.05879372","4":"0.81462641","5":"0.027926012","_rn_":"35"},{"1":"Algeria","2":"1","3":"1.75779182","4":"2.32221009","5":"0.405915880","_rn_":"36"},{"1":"Botswana","2":"2","3":"4.48834877","4":"1.35059836","5":"-2.251690523","_rn_":"37"},{"1":"Egypt","2":"1","3":"1.45515716","4":"1.48375960","5":"-1.484115076","_rn_":"38"},{"1":"Gabon","2":"2","3":"5.07955834","4":"-1.84934413","5":"0.223023990","_rn_":"39"},{"1":"Ghana","2":"2","3":"4.94529597","4":"0.51518412","5":"-0.679939548","_rn_":"40"},{"1":"Libya","2":"1","3":"3.96906505","4":"2.51546738","5":"-0.550299598","_rn_":"41"},{"1":"Morocco","2":"1","3":"2.33973207","4":"1.57697751","5":"0.620167354","_rn_":"42"},{"1":"Namibia","2":"2","3":"6.78839862","4":"1.81616353","5":"1.811177322","_rn_":"43"},{"1":"Sierra_Leone","2":"5","3":"10.11147508","4":"-4.13640327","5":"0.708806858","_rn_":"44"},{"1":"South_Africa","2":"1","3":"1.22038392","4":"1.07036311","5":"0.584292394","_rn_":"45"},{"1":"Swaziland","2":"2","3":"6.62089564","4":"1.53114576","5":"0.486213522","_rn_":"46"},{"1":"Uganda","2":"2","3":"7.44759122","4":"-0.08614119","5":"-1.461769491","_rn_":"47"},{"1":"Zaire","2":"2","3":"5.01954548","4":"-0.14593127","5":"-1.354022712","_rn_":"48"},{"1":"Zimbabwe","2":"1","3":"2.90708292","4":"1.53174980","5":"-1.155638673","_rn_":"49"},{"1":"Bulgaria","2":"6","3":"-5.02639603","4":"-2.68287368","5":"0.194600531","_rn_":"50"},{"1":"Former_E._Germany","2":"6","3":"-5.36617200","4":"-3.13019129","5":"-0.146640390","_rn_":"51"},{"1":"Poland","2":"6","3":"-4.83913984","4":"-1.51169554","5":"0.238889303","_rn_":"52"},{"1":"Yugoslavia","2":"6","3":"-4.87765104","4":"-0.76403413","5":"0.653220196","_rn_":"53"},{"1":"Byelorussia_SSR","2":"6","3":"-4.89387951","4":"-1.07548768","5":"0.052116630","_rn_":"54"},{"1":"Argentina","2":"3","3":"-3.38164344","4":"0.23391708","5":"0.049204615","_rn_":"55"},{"1":"Brazil","2":"1","3":"-0.17351090","4":"1.80173696","5":"0.887331423","_rn_":"56"},{"1":"Columbia","2":"3","3":"-1.72504134","4":"2.37367896","5":"0.116914571","_rn_":"57"},{"1":"Guyana","2":"1","3":"-0.64024371","4":"2.01175992","5":"0.650267842","_rn_":"58"},{"1":"Peru","2":"1","3":"2.88979728","4":"2.70398544","5":"2.617485939","_rn_":"59"},{"1":"Venezuela","2":"3","3":"-2.71512137","4":"3.09958020","5":"-0.531015134","_rn_":"60"},{"1":"Belgium","2":"6","3":"-5.61006438","4":"-2.07122472","5":"0.103010698","_rn_":"61"},{"1":"Denmark","2":"6","3":"-5.36296636","4":"-2.80594142","5":"-0.144208119","_rn_":"62"},{"1":"Germany","2":"6","3":"-5.66618148","4":"-2.48058100","5":"0.085615217","_rn_":"63"},{"1":"Ireland","2":"6","3":"-5.22803491","4":"-0.94271289","5":"-0.168083173","_rn_":"64"},{"1":"Netherlands","2":"6","3":"-5.69497185","4":"-0.81402153","5":"0.149795861","_rn_":"65"},{"1":"Portugal","2":"6","3":"-5.54867384","4":"-1.34891130","5":"0.526746892","_rn_":"66"},{"1":"Sweden","2":"6","3":"-5.14801099","4":"-2.19511746","5":"-0.439370072","_rn_":"67"},{"1":"U.K.","2":"6","3":"-5.14080545","4":"-2.45732616","5":"-0.218666957","_rn_":"68"},{"1":"Japan","2":"6","3":"-6.74109078","4":"-0.01816615","5":"0.738650841","_rn_":"69"},{"1":"U.S.A.","2":"6","3":"-4.98026088","4":"-0.19798546","5":"-0.186143629","_rn_":"70"},{"1":"Bahrain","2":"3","3":"-2.95751794","4":"3.40403941","5":"-0.956027685","_rn_":"71"},{"1":"Iraq","2":"1","3":"2.86550554","4":"3.12008079","5":"-0.806112179","_rn_":"72"},{"1":"Jordan","2":"1","3":"0.78337204","4":"3.21739659","5":"-1.371400507","_rn_":"73"},{"1":"Lebanon","2":"1","3":"-0.13242340","4":"1.34062918","5":"-0.430471811","_rn_":"74"},{"1":"Saudi_Arabia","2":"1","3":"2.82947028","4":"3.22903162","5":"-0.605791417","_rn_":"75"},{"1":"United_Arab_Emirates","2":"3","3":"-3.60965788","4":"3.10639879","5":"0.361277059","_rn_":"76"},{"1":"Cambodia","2":"2","3":"6.68714487","4":"-1.11737674","5":"1.343455301","_rn_":"77"},{"1":"Hong_Kong","2":"3","3":"-6.56814921","4":"1.21156621","5":"0.795955999","_rn_":"78"},{"1":"Indonesia","2":"1","3":"0.59203984","4":"1.12304477","5":"1.306331526","_rn_":"79"},{"1":"Malaysia","2":"3","3":"-1.69768174","4":"2.74828222","5":"-1.241072895","_rn_":"80"},{"1":"Nepal","2":"2","3":"5.98051592","4":"-0.24581105","5":"1.734265161","_rn_":"81"},{"1":"Philippines","2":"1","3":"-0.11564367","4":"2.00054960","5":"-0.669610455","_rn_":"82"},{"1":"Sri_Lanka","2":"3","3":"-3.86669807","4":"1.46702228","5":"-0.073210404","_rn_":"83"},{"1":"Vietnam","2":"1","3":"0.73637772","4":"1.14664253","5":"0.270008884","_rn_":"84"},{"1":"Angola","2":"5","3":"8.67464018","4":"-2.62832040","5":"0.398976877","_rn_":"85"},{"1":"Congo","2":"2","3":"4.71698904","4":"-0.50507133","5":"-1.989873503","_rn_":"86"},{"1":"Ethiopia","2":"5","3":"9.02400482","4":"-2.80509362","5":"0.132536656","_rn_":"87"},{"1":"Gambia","2":"5","3":"9.16151584","4":"-3.21458937","5":"0.521137723","_rn_":"88"},{"1":"Kenya","2":"2","3":"4.37728422","4":"1.48515306","5":"-1.740964552","_rn_":"89"},{"1":"Malawi","2":"5","3":"9.25868839","4":"-5.46422766","5":"-0.742329819","_rn_":"90"},{"1":"Mozambique","2":"5","3":"8.17837256","4":"-1.74864060","5":"1.141424236","_rn_":"91"},{"1":"Nigeria","2":"2","3":"6.80523311","4":"-0.35943688","5":"-0.827233974","_rn_":"92"},{"1":"Somalia","2":"5","3":"9.02055241","4":"-2.47121452","5":"-0.274058230","_rn_":"93"},{"1":"Sudan","2":"2","3":"6.19772237","4":"-0.74977705","5":"-0.138778600","_rn_":"94"},{"1":"Tunisia","2":"1","3":"-0.26827112","4":"2.17721533","5":"0.042802627","_rn_":"95"},{"1":"Tanzania","2":"2","3":"7.01894686","4":"0.75977710","5":"-0.855439352","_rn_":"96"},{"1":"Zambia","2":"2","3":"5.90158841","4":"0.55264060","5":"-2.233552693","_rn_":"97"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="whats-in-there-making-a-plot" class="slide level2">
<h2>What’s in there; making a plot</h2>
<ul>
<li><code>d</code> contains country names, cluster memberships and discriminant scores.</li>
<li>Plot <code>LD1</code> against <code>LD2</code>, colouring points by cluster and labelling by country:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d, <span class="fu">aes</span>(</span>
<span id="cb91-2"><a href="#cb91-2"></a>  <span class="at">x =</span> LD1, <span class="at">y =</span> LD2, <span class="at">colour =</span> <span class="fu">factor</span>(cluster),</span>
<span id="cb91-3"><a href="#cb91-3"></a>  <span class="at">label =</span> country</span>
<span id="cb91-4"><a href="#cb91-4"></a>)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb91-5"><a href="#cb91-5"></a>  <span class="fu">geom_text_repel</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">max.overlaps =</span> <span class="cn">Inf</span>) <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-plot" class="slide level2">
<h2>The plot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="cluster_files/figure-revealjs/bCluster-66-1.png" width="960" class="r-stretch"><p>It would be better to zoom in on parts of this plot.</p>
</section>
<section id="final-example-a-hockey-league" class="slide level2">
<h2>Final example: a hockey league</h2>
<ul>
<li><p>An Ontario hockey league has teams in 21 cities. How can we arrange those teams into 4 geographical divisions?</p></li>
<li><p>Distance data in spreadsheet.</p></li>
<li><p>Take out spaces in team names.</p></li>
<li><p>Save as “text/csv”.</p></li>
<li><p>Distances, so back to <code>hclust</code>.</p></li>
</ul>
</section>
<section id="a-map" class="slide level2">
<h2>A map</h2>

<img data-src="map1.png" class="r-stretch"></section>
<section id="attempt-1" class="slide level2">
<h2>Attempt 1</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>my_url <span class="ot">&lt;-</span> </span>
<span id="cb93-2"><a href="#cb93-2"></a>  <span class="st">"http://ritsokiguess.site/datafiles/ontario-road-distances.csv"</span></span>
<span id="cb93-3"><a href="#cb93-3"></a>ontario <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(my_url)</span>
<span id="cb93-4"><a href="#cb93-4"></a>ontario.d <span class="ot">&lt;-</span> ontario <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">as.dist</span>()</span>
<span id="cb93-5"><a href="#cb93-5"></a>ontario.hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(ontario.d, <span class="at">method =</span> <span class="st">"ward.D"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-with-4-clusters" class="slide level2">
<h2>Plot, with 4 clusters</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="fu">plot</span>(ontario.hc)</span>
<span id="cb94-2"><a href="#cb94-2"></a><span class="fu">rect.hclust</span>(ontario.hc, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="cluster_files/figure-revealjs/bCluster-68-1.png" width="960" class="r-stretch"></section>
<section id="comments-2" class="slide level2">
<h2>Comments</h2>
<ul>
<li><p>Can’t have divisions of 1 team!</p></li>
<li><p>“Southern” divisions way too big!</p></li>
<li><p>Try splitting into more. I found 7 to be good:</p></li>
</ul>
</section>
<section id="seven-clusters" class="slide level2">
<h2>Seven clusters</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="fu">plot</span>(ontario.hc)</span>
<span id="cb95-2"><a href="#cb95-2"></a><span class="fu">rect.hclust</span>(ontario.hc, <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="cluster_files/figure-revealjs/bCluster-69-1.png" width="960" class="r-stretch"></section>
<section id="divisions-now" class="slide level2">
<h2>Divisions now</h2>
<ul>
<li><p>I want to put Huntsville and North Bay together with northern teams.</p></li>
<li><p>I’ll put the Eastern teams together. Gives:</p></li>
<li><p>North: Sault Ste Marie, Sudbury, Huntsville, North Bay</p></li>
<li><p>East: Brockville, Cornwall, Ottawa, Peterborough, Belleville, Kingston</p></li>
<li><p>West: Windsor, London, Sarnia</p></li>
<li><p>Central: Owen Sound, Barrie, Toronto, Niagara Falls, St Catharines, Brantford, Hamilton, Kitchener</p></li>
<li><p>Getting them same size beyond us!</p></li>
</ul>
</section>
<section id="another-map" class="slide level2">
<h2>Another map</h2>

<img data-src="map2.png" class="r-stretch"><div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="cluster_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="cluster_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="cluster_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="cluster_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="cluster_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="cluster_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="cluster_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="cluster_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="cluster_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="cluster_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>