<!DOCTYPE html>
<html lang="en"><head>
<script src="anova_files/libs/clipboard/clipboard.min.js"></script>
<script src="anova_files/libs/quarto-html/tabby.min.js"></script>
<script src="anova_files/libs/quarto-html/popper.min.js"></script>
<script src="anova_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="anova_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="anova_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="anova_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="anova_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.340">

  <title>Analysis of variance revisited</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="anova_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="anova_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="anova_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="anova_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="anova_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="anova_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="anova_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  
  <link href="anova_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
  <script src="anova_files/libs/pagedtable-1.1/js/pagedtable.js"></script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Analysis of variance revisited</h1>

<div class="quarto-title-authors">
</div>

</section>
<section id="analysis-of-variance" class="slide level2">
<h2>Analysis of variance</h2>
<ul>
<li><p>Analysis of variance used with:</p>
<ul>
<li><p>counted/measured response</p></li>
<li><p>categorical explanatory variable(s)</p></li>
<li><p>that is, data divided into groups, and see if response significantly different among groups</p></li>
<li><p>or, see whether knowing group membership helps to predict response.</p></li>
</ul></li>
</ul>
</section>
<section id="two-stages" class="slide level2">
<h2>Two stages</h2>
<ul>
<li><p>Typically two stages:</p>
<ul>
<li><p><span class="math inline">\(F\)</span>-test to detect <em>any</em> differences among/due to groups</p></li>
<li><p>if <span class="math inline">\(F\)</span>-test significant, do <em>multiple comparisons</em> to see which groups significantly different from which.</p></li>
</ul></li>
<li><p>Need special multiple comparisons method because just doing (say) two-sample <span class="math inline">\(t\)</span>-tests on each pair of groups gives too big a chance of finding “significant” differences by accident.</p></li>
</ul>
</section>
<section id="packages" class="slide level2">
<h2>Packages</h2>
<p>These:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(car) <span class="co"># for Levene's text</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-pain-threshold-and-hair-colour" class="slide level2">
<h2>Example: Pain threshold and hair colour</h2>
<ul>
<li><p>Do people with different hair colour have different abilities to deal with pain?</p></li>
<li><p>Men and women of various ages divided into 4 groups by hair colour: light and dark blond, light and dark brown.</p></li>
<li><p>Each subject given a pain sensitivity test resulting in pain threshold score: higher score is higher pain tolerance.</p></li>
<li><p>19 subjects altogether.</p></li>
</ul>
</section>
<section id="the-data" class="slide level2">
<h2>The data</h2>
<p>In <code>hairpain.txt</code>:</p>
<div class="columns">
<div class="column" style="width:50%;">
<pre><code>hair pain
lightblond 62
lightblond 60
lightblond 71
lightblond 55
lightblond 48
darkblond 63
darkblond 57
darkblond 52
darkblond 41
darkblond 43</code></pre>
</div><div class="column" style="width:5 0%;">
<pre><code>lightbrown 42
lightbrown 50
lightbrown 41
lightbrown 37
darkbrown 32
darkbrown 39
darkbrown 51
darkbrown 30
darkbrown 35</code></pre>
</div>
</div>
</section>
<section id="summarizing-the-groups" class="slide level2">
<h2>Summarizing the groups</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/hairpain.txt"</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>hairpain <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(my_url, <span class="st">" "</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a>hairpain <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="fu">group_by</span>(hair) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="fu">summarize</span>(</span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb4-7"><a href="#cb4-7"></a>    <span class="at">xbar =</span> <span class="fu">mean</span>(pain),</span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="at">s =</span> <span class="fu">sd</span>(pain)</span>
<span id="cb4-9"><a href="#cb4-9"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["hair"],"name":[1],"type":["chr"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]},{"label":["xbar"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["s"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"darkblond","2":"5","3":"51.2","4":"9.284396"},{"1":"darkbrown","2":"5","3":"37.4","4":"8.324662"},{"1":"lightblond","2":"5","3":"59.2","4":"8.526429"},{"1":"lightbrown","2":"4","3":"42.5","4":"5.446712"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Brown-haired people seem to have lower pain tolerance.</p>
</section>
<section id="boxplot" class="slide level2">
<h2>Boxplot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">ggplot</span>(hairpain, <span class="fu">aes</span>(<span class="at">x =</span> hair, <span class="at">y =</span> pain)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="anova_files/figure-revealjs/tartuffo-1.png" width="960" class="r-stretch"></section>
<section id="assumptions" class="slide level2">
<h2>Assumptions</h2>
<ul>
<li><p>Data should be:</p>
<ul>
<li><p>normally distributed within each group</p></li>
<li><p>same spread for each group</p></li>
</ul></li>
<li><p><code>darkbrown</code> group has upper outlier (suggests not normal)</p></li>
<li><p><code>darkblond</code> group has smaller IQR than other groups.</p></li>
<li><p>But, groups <em>small</em>.</p></li>
<li><p>Shrug shoulders and continue for moment.</p></li>
</ul>
</section>
<section id="testing-equality-of-sds" class="slide level2">
<h2>Testing equality of SDs</h2>
<ul>
<li>via <strong>Levene’s test</strong> in package <code>car</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">leveneTest</span>(pain <span class="sc">~</span> hair, <span class="at">data =</span> hairpain)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["F value"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"3","2":"0.3927432","3":"0.7600161","_rn_":"group"},{"1":"15","2":"NA","3":"NA","_rn_":""}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li><p>No evidence (at all) of difference among group SDs.</p></li>
<li><p>Possibly because groups <em>small</em>.</p></li>
</ul>
</section>
<section id="analysis-of-variance-1" class="slide level2">
<h2>Analysis of variance</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>hairpain<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">aov</span>(pain <span class="sc">~</span> hair, <span class="at">data =</span> hairpain)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">summary</span>(hairpain<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value  Pr(&gt;F)   
hair         3   1361   453.6   6.791 0.00411 **
Residuals   15   1002    66.8                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li><p>P-value small: the mean pain tolerances for the four groups are <em>not</em> all the same.</p></li>
<li><p>Which groups differ from which, and how?</p></li>
</ul>
</section>
<section id="multiple-comparisons" class="slide level2">
<h2>Multiple comparisons</h2>
<ul>
<li><p>Which groups differ from which? Multiple comparisons method. Lots.</p></li>
<li><p>Problem: by comparing all the groups with each other, doing many tests, have large chance to (possibly incorrectly) reject <span class="math inline">\(H_0:\)</span> groups have equal means.</p></li>
<li><p>4 groups: 6 comparisons (1 vs 2, 1 vs 3, , 3 vs 4). 5 groups: 10 comparisons. Thus 6 (or 10) chances to make mistake.</p></li>
<li><p>Get “familywise error rate” of 0.05 (whatever), no matter how many comparisons you’re doing.</p></li>
<li><p>My favourite: Tukey, or “honestly significant differences”: how far apart might largest, smallest group means be (if actually no differences). Group means more different: significantly different.</p></li>
</ul>
</section>
<section id="tukey" class="slide level2">
<h2>Tukey</h2>
<ul>
<li><code>TukeyHSD:</code></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">TukeyHSD</span>(hairpain<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = pain ~ hair, data = hairpain)

$hair
                       diff        lwr        upr     p adj
darkbrown-darkblond   -13.8 -28.696741  1.0967407 0.0740679
lightblond-darkblond    8.0  -6.896741 22.8967407 0.4355768
lightbrown-darkblond   -8.7 -24.500380  7.1003795 0.4147283
lightblond-darkbrown   21.8   6.903259 36.6967407 0.0037079
lightbrown-darkbrown    5.1 -10.700380 20.9003795 0.7893211
lightbrown-lightblond -16.7 -32.500380 -0.8996205 0.0366467</code></pre>
</div>
</div>
</section>
<section id="the-old-fashioned-way" class="slide level2">
<h2>The old-fashioned way</h2>
<ul>
<li><p>List group means in order</p></li>
<li><p>Draw lines connecting groups that are <em>not</em> significantly different:</p></li>
</ul>
<pre><code>darkbrown lightbrown  darkblond lightblond
37.4      42.5       51.2       59.2
-------------------------
                     ---------------</code></pre>
<ul>
<li><p><code>lightblond</code> significantly higher than everything except <code>darkblond</code> (at <span class="math inline">\(\alpha=0.05\)</span>).</p></li>
<li><p><code>darkblond</code> in middle ground: not significantly less than <code>lightblond</code>, not significantly greater than <code>darkbrown</code> and <code>lightbrown</code>.</p></li>
<li><p>More data might resolve this.</p></li>
<li><p>Looks as if blond-haired people do have higher pain tolerance, but not completely clear.</p></li>
</ul>
</section>
<section id="some-other-multiple-comparison-methods" class="slide level2">
<h2>Some other multiple-comparison methods</h2>
<ul>
<li><p>Work any time you do <span class="math inline">\(k\)</span> tests at once (not just ANOVA).</p>
<ul>
<li><p><strong>Bonferroni</strong>: multiply all P-values by <span class="math inline">\(k\)</span>.</p></li>
<li><p><strong>Holm</strong>: multiply smallest P-value by <span class="math inline">\(k\)</span>, next-smallest by <span class="math inline">\(k-1\)</span>, etc.</p></li>
<li><p><strong>False discovery rate</strong>: multiply smallest P-value by <span class="math inline">\(k/1\)</span>, 2nd-smallest by <span class="math inline">\(k/2\)</span>, , <span class="math inline">\(i\)</span>-th smallest by <span class="math inline">\(k/i\)</span>.</p></li>
</ul></li>
<li><p>Stop after non-rejection.</p></li>
</ul>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<ul>
<li><p>P-values 0.005, 0.015, 0.03, 0.06 (4 tests all done at once) Use <span class="math inline">\(\alpha=0.05\)</span>.</p></li>
<li><p>Bonferroni:</p>
<ul>
<li><p>Multiply all P-values by 4 (4 tests).</p></li>
<li><p>Reject only 1st null.</p></li>
</ul></li>
<li><p>Holm:</p>
<ul>
<li><p>Times smallest P-value by 4: <span class="math inline">\(0.005*4=0.020&lt;0.05\)</span>, reject.</p></li>
<li><p>Times next smallest by 3: <span class="math inline">\(0.015*3=0.045&lt;0.05\)</span>, reject.</p></li>
<li><p>Times next smallest by 2: <span class="math inline">\(0.03*2=0.06&gt;0.05\)</span>, do not reject. Stop.</p></li>
</ul></li>
</ul>
</section>
<section id="continued" class="slide level2">
<h2>Continued</h2>
<ul>
<li><p>With P-values 0.005, 0.015, 0.03, 0.06:</p></li>
<li><p>False discovery rate:</p>
<ul>
<li><p>Times smallest P-value by 4: <span class="math inline">\(0.005*4=0.02&lt;0.05\)</span>: reject.</p></li>
<li><p>Times second smallest by <span class="math inline">\(4/2\)</span>: <span class="math inline">\(0.015*4/2=0.03&lt;0.05\)</span>, reject.</p></li>
<li><p>Times third smallest by <span class="math inline">\(4/3\)</span>: <span class="math inline">\(0.03*4/3=0.04&lt;0.05\)</span>, reject.</p></li>
<li><p>Times fourth smallest by <span class="math inline">\(4/4\)</span>: <span class="math inline">\(0.06*4/4=0.06&gt;0.05\)</span>, do not reject. Stop.</p></li>
</ul></li>
</ul>
</section>
<section id="pairwise.t.test" class="slide level2">
<h2><code>pairwise.t.test</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">with</span>(hairpain, <span class="fu">pairwise.t.test</span>(pain, hair, <span class="at">p.adj =</span> <span class="st">"none"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  pain and hair 

           darkblond darkbrown lightblond
darkbrown  0.01748   -         -         
lightblond 0.14251   0.00075   -         
lightbrown 0.13337   0.36695   0.00817   

P value adjustment method: none </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">with</span>(hairpain, <span class="fu">pairwise.t.test</span>(pain, hair, <span class="at">p.adj =</span> <span class="st">"holm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  pain and hair 

           darkblond darkbrown lightblond
darkbrown  0.0699    -         -         
lightblond 0.4001    0.0045    -         
lightbrown 0.4001    0.4001    0.0408    

P value adjustment method: holm </code></pre>
</div>
</div>
</section>
<section id="pairwise.t.test-part-2" class="slide level2">
<h2><code>pairwise.t.test</code> part 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="fu">with</span>(hairpain, <span class="fu">pairwise.t.test</span>(pain, hair, <span class="at">p.adj =</span> <span class="st">"fdr"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  pain and hair 

           darkblond darkbrown lightblond
darkbrown  0.0350    -         -         
lightblond 0.1710    0.0045    -         
lightbrown 0.1710    0.3670    0.0245    

P value adjustment method: fdr </code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">with</span>(hairpain, <span class="fu">pairwise.t.test</span>(pain, hair, <span class="at">p.adj =</span> <span class="st">"bon"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using t tests with pooled SD 

data:  pain and hair 

           darkblond darkbrown lightblond
darkbrown  0.1049    -         -         
lightblond 0.8550    0.0045    -         
lightbrown 0.8002    1.0000    0.0490    

P value adjustment method: bonferroni </code></pre>
</div>
</div>
</section>
<section id="comments" class="slide level2">
<h2>Comments</h2>
<ul>
<li><p>P-values all adjusted upwards from “none”.</p></li>
<li><p>Required because 6 tests at once.</p></li>
<li><p>Highest P-values for Bonferroni: most “conservative”.</p></li>
<li><p>Prefer Tukey or FDR or Holm.</p></li>
<li><p>Tukey only applies to ANOVA, not to other cases of multiple testing.</p></li>
</ul>
</section>
<section id="rats-and-vitamin-b" class="slide level2">
<h2>Rats and vitamin B</h2>
<ul>
<li><p>What is the effect of dietary vitamin B on the kidney?</p></li>
<li><p>A number of rats were randomized to receive either a B-supplemented diet or a regular diet.</p></li>
<li><p>Desired to control for initial size of rats, so classified into size classes <code>lean</code> and <code>obese</code>.</p></li>
<li><p>After 20 weeks, rats’ kidneys weighed.</p></li>
<li><p>Variables:</p>
<ul>
<li><p>Response: <code>kidneyweight</code> (grams).</p></li>
<li><p>Explanatory: <code>diet</code>, <code>ratsize</code>.</p></li>
</ul></li>
<li><p>Read in data:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/vitaminb.txt"</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>vitaminb <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(my_url, <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-data-1" class="slide level2">
<h2>The data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>vitaminb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["ratsize"],"name":[1],"type":["chr"],"align":["left"]},{"label":["diet"],"name":[2],"type":["chr"],"align":["left"]},{"label":["kidneyweight"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"lean","2":"regular","3":"1.62"},{"1":"lean","2":"regular","3":"1.80"},{"1":"lean","2":"regular","3":"1.71"},{"1":"lean","2":"regular","3":"1.81"},{"1":"lean","2":"regular","3":"1.47"},{"1":"lean","2":"regular","3":"1.37"},{"1":"lean","2":"regular","3":"1.71"},{"1":"lean","2":"vitaminb","3":"1.51"},{"1":"lean","2":"vitaminb","3":"1.65"},{"1":"lean","2":"vitaminb","3":"1.45"},{"1":"lean","2":"vitaminb","3":"1.44"},{"1":"lean","2":"vitaminb","3":"1.63"},{"1":"lean","2":"vitaminb","3":"1.35"},{"1":"lean","2":"vitaminb","3":"1.66"},{"1":"obese","2":"regular","3":"2.35"},{"1":"obese","2":"regular","3":"2.97"},{"1":"obese","2":"regular","3":"2.54"},{"1":"obese","2":"regular","3":"2.93"},{"1":"obese","2":"regular","3":"2.84"},{"1":"obese","2":"regular","3":"2.05"},{"1":"obese","2":"regular","3":"2.82"},{"1":"obese","2":"vitaminb","3":"2.93"},{"1":"obese","2":"vitaminb","3":"2.72"},{"1":"obese","2":"vitaminb","3":"2.99"},{"1":"obese","2":"vitaminb","3":"2.19"},{"1":"obese","2":"vitaminb","3":"2.63"},{"1":"obese","2":"vitaminb","3":"2.61"},{"1":"obese","2":"vitaminb","3":"2.64"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="grouped-boxplot" class="slide level2">
<h2>Grouped boxplot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">ggplot</span>(vitaminb, <span class="fu">aes</span>(</span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="at">x =</span> ratsize, <span class="at">y =</span> kidneyweight,</span>
<span id="cb22-3"><a href="#cb22-3"></a>  <span class="at">fill =</span> diet</span>
<span id="cb22-4"><a href="#cb22-4"></a>)) <span class="sc">+</span> <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="anova_files/figure-revealjs/bAnova-10-1.png" width="960" class="r-stretch"></section>
<section id="whats-going-on" class="slide level2">
<h2>What’s going on?</h2>
<ul>
<li>Calculate group means:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>summary <span class="ot">&lt;-</span> vitaminb <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">group_by</span>(ratsize, diet) <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>  <span class="fu">summarize</span>(<span class="at">mean =</span> <span class="fu">mean</span>(kidneyweight))</span>
<span id="cb23-4"><a href="#cb23-4"></a>summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["ratsize"],"name":[1],"type":["chr"],"align":["left"]},{"label":["diet"],"name":[2],"type":["chr"],"align":["left"]},{"label":["mean"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"lean","2":"regular","3":"1.641429"},{"1":"lean","2":"vitaminb","3":"1.527143"},{"1":"obese","2":"regular","3":"2.642857"},{"1":"obese","2":"vitaminb","3":"2.672857"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li><p>Rat size: a large and consistent effect.</p></li>
<li><p>Diet: small/no effect (compare same rat size, different diet).</p></li>
<li><p>Effect of rat size <em>same</em> for each diet: no interaction.</p></li>
</ul>
</section>
<section id="anova-with-interaction" class="slide level2">
<h2>ANOVA with interaction</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>vitaminb<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">aov</span>(kidneyweight <span class="sc">~</span> ratsize <span class="sc">*</span> diet,</span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="at">data =</span> vitaminb</span>
<span id="cb24-3"><a href="#cb24-3"></a>)</span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="fu">summary</span>(vitaminb<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
ratsize       1  8.068   8.068 141.179 1.53e-11 ***
diet          1  0.012   0.012   0.218    0.645    
ratsize:diet  1  0.036   0.036   0.638    0.432    
Residuals    24  1.372   0.057                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>Significance/nonsignificance as we expected.</li>
<li>Note no significant interaction (can be removed).</li>
</ul>
</section>
<section id="interaction-plot" class="slide level2">
<h2>Interaction plot</h2>
<ul>
<li>Plot mean of response variable against one of the explanatory, using other one as groups. Start from <code>summary</code>:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary, <span class="fu">aes</span>(</span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="at">x =</span> ratsize, <span class="at">y =</span> mean,</span>
<span id="cb26-3"><a href="#cb26-3"></a>  <span class="at">colour =</span> diet, <span class="at">group =</span> diet</span>
<span id="cb26-4"><a href="#cb26-4"></a>)) <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>For this, have to give <em>both</em> <code>group</code> and <code>colour</code>.</li>
</ul>
</section>
<section id="the-interaction-plot" class="slide level2">
<h2>The interaction plot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="anova_files/figure-revealjs/bAnova-14-1.png" width="960" class="r-stretch"><p>Lines basically parallel, indicating no interaction.</p>
</section>
<section id="take-out-interaction" class="slide level2">
<h2>Take out interaction</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>vitaminb<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">update</span>(vitaminb<span class="fl">.1</span>, . <span class="sc">~</span> . <span class="sc">-</span> ratsize<span class="sc">:</span>diet)</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="fu">summary</span>(vitaminb<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
ratsize      1  8.068   8.068 143.256 7.59e-12 ***
diet         1  0.012   0.012   0.221    0.643    
Residuals   25  1.408   0.056                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li><p>No Tukey for <code>diet</code>: not significant.</p></li>
<li><p>No Tukey for <code>ratsize</code>: only two sizes, and already know that obese rats have larger kidneys than lean ones.</p></li>
<li><p>Bottom line: diet has no effect on kidney size once you control for size of rat.</p></li>
</ul>
</section>
<section id="assessing-assumptions-residuals" class="slide level2">
<h2>Assessing assumptions: residuals</h2>
<ul>
<li>In two-way ANOVA, not many observations per treatment group.</li>
<li>Difficult to check for normality / equal spreads.</li>
<li><em>But</em>, any regular ANOVA also a regression.</li>
<li>Use regression residual ideas.</li>
<li>In ANOVA, one fitted value per treatment group (based on means).</li>
<li>Residual: observation minus fitted value.</li>
</ul>
</section>
<section id="previous-anova-as-regression" class="slide level2">
<h2>Previous ANOVA as regression</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>vitaminb<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(kidneyweight <span class="sc">~</span> ratsize <span class="sc">+</span> diet, <span class="at">data =</span> vitaminb)</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="fu">summary</span>(vitaminb<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = kidneyweight ~ ratsize + diet, data = vitaminb)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.62893 -0.12625  0.04071  0.14607  0.35321 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.60536    0.07768   20.67  &lt; 2e-16 ***
ratsizeobese  1.07357    0.08970   11.97 7.59e-12 ***
dietvitaminb -0.04214    0.08970   -0.47    0.643    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2373 on 25 degrees of freedom
Multiple R-squared:  0.8516,    Adjusted R-squared:  0.8397 
F-statistic: 71.74 on 2 and 25 DF,  p-value: 4.39e-11</code></pre>
</div>
</div>
</section>
<section id="reproduce-anova" class="slide level2">
<h2>Reproduce ANOVA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>  <span class="fu">drop1</span>(vitaminb<span class="fl">.3</span>, <span class="at">test =</span> <span class="st">"F"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Sum of Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["RSS"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"NA","2":"NA","3":"1.407946","4":"-77.72202","5":"NA","6":"NA","_rn_":"<none>"},{"1":"1","2":"8.06788929","3":"9.475836","4":"-26.33687","5":"143.2563257","6":"7.592733e-12","_rn_":"ratsize"},{"1":"1","2":"0.01243214","3":"1.420379","4":"-79.47587","5":"0.2207496","6":"6.425419e-01","_rn_":"diet"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li>ANOVA and regression <code>drop1</code> output always the same.</li>
<li>this time, ANOVA and regression <code>summary</code> output have same P-values, but only because categorical variables both have two levels.</li>
</ul>
</section>
<section id="are-the-residuals-normal" class="slide level2">
<h2>Are the residuals normal?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">ggplot</span>(vitaminb<span class="fl">.3</span>, <span class="fu">aes</span>(<span class="at">sample=</span>.resid)) <span class="sc">+</span> </span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="anova_files/figure-revealjs/bAnova-18-1.png" width="960" class="r-stretch"></section>
<section id="residuals-against-fitted" class="slide level2">
<h2>Residuals against fitted</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu">ggplot</span>(vitaminb<span class="fl">.3</span>, <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>.resid)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="anova_files/figure-revealjs/bAnova-19-1.png" width="960" class="r-stretch"></section>
<section id="comments-1" class="slide level2">
<h2>Comments</h2>
<ul>
<li>2 rat sizes, 2 diets: only <span class="math inline">\(2 \times 2 = 4\)</span> different fitted values</li>
<li>larger fitted values have greater spread (fan-out, transformation?)</li>
<li>add residuals to data to plot residuals against size, diet (<code>augment</code> from <code>broom</code>):</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>vitaminb<span class="fl">.3</span> <span class="sc">%&gt;%</span> <span class="fu">augment</span>(vitaminb) <span class="ot">-&gt;</span> vitaminb<span class="fl">.3</span>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>explanatory <code>ratsize</code>, <code>diet</code> categorical, so plot resid vs.&nbsp;them with <em>boxplots</em>.</li>
</ul>
</section>
<section id="residuals-vs-rat-size" class="slide level2">
<h2>Residuals vs rat size</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">ggplot</span>(vitaminb<span class="fl">.3</span>a, <span class="fu">aes</span>(<span class="at">x =</span> ratsize, <span class="at">y =</span> .resid)) <span class="sc">+</span> </span>
<span id="cb36-2"><a href="#cb36-2"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="anova_files/figure-revealjs/bAnova-21-1.png" width="960" class="r-stretch"></section>
<section id="residuals-vs-diet" class="slide level2">
<h2>Residuals vs diet</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">ggplot</span>(vitaminb<span class="fl">.3</span>a, <span class="fu">aes</span>(<span class="at">x =</span> diet, <span class="at">y =</span> .resid)) <span class="sc">+</span> </span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="anova_files/figure-revealjs/bAnova-22-1.png" width="960" class="r-stretch"></section>
<section id="comments-2" class="slide level2">
<h2>Comments</h2>
<ul>
<li>there are low outliers on the plot against diet</li>
<li>residuals for obese rats seem more spread out than for lean rats</li>
<li>case for transformation of rat weights</li>
<li>however, story from our analysis very clear:
<ul>
<li>rat size strongly significant</li>
<li>diet nowhere near significant</li>
</ul></li>
<li>and so expect transformation to make no difference to conclusions.</li>
</ul>
</section>
<section id="the-auto-noise-data" class="slide level2">
<h2>The auto noise data</h2>
<p>In 1973, the President of Texaco cited an automobile filter developed by Associated Octel Company as effective in reducing pollution. However, questions had been raised about the effects of filter silencing. He referred to the data included in the report (and below) as evidence that the silencing properties of the Octel filter were at least equal to those of standard silencers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>u <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/autonoise.txt"</span></span>
<span id="cb38-2"><a href="#cb38-2"></a>autonoise <span class="ot">&lt;-</span> <span class="fu">read_table</span>(u)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-data-2" class="slide level2">
<h2>The data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>autonoise</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["noise"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["size"],"name":[2],"type":["chr"],"align":["left"]},{"label":["type"],"name":[3],"type":["chr"],"align":["left"]},{"label":["side"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"840","2":"M","3":"Std","4":"R"},{"1":"770","2":"L","3":"Octel","4":"L"},{"1":"820","2":"M","3":"Octel","4":"R"},{"1":"775","2":"L","3":"Octel","4":"R"},{"1":"825","2":"M","3":"Octel","4":"L"},{"1":"840","2":"M","3":"Std","4":"R"},{"1":"845","2":"M","3":"Std","4":"L"},{"1":"825","2":"M","3":"Octel","4":"L"},{"1":"815","2":"M","3":"Octel","4":"L"},{"1":"845","2":"M","3":"Std","4":"R"},{"1":"765","2":"L","3":"Octel","4":"L"},{"1":"835","2":"S","3":"Std","4":"L"},{"1":"775","2":"L","3":"Octel","4":"R"},{"1":"835","2":"S","3":"Std","4":"L"},{"1":"820","2":"S","3":"Octel","4":"R"},{"1":"760","2":"L","3":"Octel","4":"L"},{"1":"760","2":"L","3":"Std","4":"L"},{"1":"835","2":"S","3":"Std","4":"L"},{"1":"850","2":"M","3":"Std","4":"L"},{"1":"825","2":"S","3":"Octel","4":"L"},{"1":"820","2":"S","3":"Std","4":"R"},{"1":"855","2":"M","3":"Std","4":"L"},{"1":"825","2":"S","3":"Octel","4":"L"},{"1":"785","2":"L","3":"Std","4":"R"},{"1":"770","2":"L","3":"Std","4":"L"},{"1":"760","2":"L","3":"Std","4":"L"},{"1":"820","2":"S","3":"Std","4":"R"},{"1":"820","2":"M","3":"Octel","4":"R"},{"1":"825","2":"M","3":"Octel","4":"R"},{"1":"790","2":"L","3":"Std","4":"R"},{"1":"820","2":"S","3":"Octel","4":"R"},{"1":"775","2":"L","3":"Octel","4":"R"},{"1":"820","2":"S","3":"Octel","4":"R"},{"1":"810","2":"S","3":"Std","4":"R"},{"1":"785","2":"L","3":"Std","4":"R"},{"1":"825","2":"S","3":"Octel","4":"L"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="making-boxplot" class="slide level2">
<h2>Making boxplot</h2>
<ul>
<li><p>Make a boxplot, but have combinations of filter type and engine size.</p></li>
<li><p>Use grouped boxplot again, thus:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>g <span class="ot">&lt;-</span> autonoise <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> size, <span class="at">y =</span> noise, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-boxplot" class="slide level2">
<h2>The boxplot</h2>
<ul>
<li><p>See difference in engine noise between Octel and standard is larger for medium engine size than for large or small.</p></li>
<li><p>Some evidence of differences in spreads (ignore for now):</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="anova_files/figure-revealjs/bAnova-26-1.png" width="960" class="r-stretch"></section>
<section id="anova" class="slide level2">
<h2>ANOVA</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>autonoise<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">aov</span>(noise <span class="sc">~</span> size <span class="sc">*</span> type, <span class="at">data =</span> autonoise)</span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="fu">summary</span>(autonoise<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
size         2  26051   13026 199.119  &lt; 2e-16 ***
type         1   1056    1056  16.146 0.000363 ***
size:type    2    804     402   6.146 0.005792 ** 
Residuals   30   1962      65                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li><p>The interaction is significant, as we suspected from the boxplots.</p></li>
<li><p>The within-group spreads don’t look very equal, but only based on 6 obs each.</p></li>
</ul>
</section>
<section id="tukey-ouch" class="slide level2">
<h2>Tukey: ouch!</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>autonoise<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(autonoise<span class="fl">.1</span>)</span>
<span id="cb44-2"><a href="#cb44-2"></a>autonoise<span class="fl">.2</span><span class="sc">$</span><span class="st">`</span><span class="at">size:type</span><span class="st">`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       diff        lwr        upr        p adj
M:Octel-L:Octel  51.6666667  37.463511  65.869823 6.033496e-11
S:Octel-L:Octel  52.5000000  38.296844  66.703156 4.089762e-11
L:Std-L:Octel     5.0000000  -9.203156  19.203156 8.890358e-01
M:Std-L:Octel    75.8333333  61.630177  90.036489 4.962697e-14
S:Std-L:Octel    55.8333333  41.630177  70.036489 9.002910e-12
S:Octel-M:Octel   0.8333333 -13.369823  15.036489 9.999720e-01
L:Std-M:Octel   -46.6666667 -60.869823 -32.463511 6.766649e-10
M:Std-M:Octel    24.1666667   9.963511  38.369823 1.908995e-04
S:Std-M:Octel     4.1666667 -10.036489  18.369823 9.454142e-01
L:Std-S:Octel   -47.5000000 -61.703156 -33.296844 4.477636e-10
M:Std-S:Octel    23.3333333   9.130177  37.536489 3.129974e-04
S:Std-S:Octel     3.3333333 -10.869823  17.536489 9.787622e-01
M:Std-L:Std      70.8333333  56.630177  85.036489 6.583623e-14
S:Std-L:Std      50.8333333  36.630177  65.036489 8.937329e-11
S:Std-M:Std     -20.0000000 -34.203156  -5.796844 2.203265e-03</code></pre>
</div>
</div>
</section>
<section id="interaction-plot-1" class="slide level2">
<h2>Interaction plot</h2>
<ul>
<li><p>This time, don’t have summary of mean noise for each size-type combination.</p></li>
<li><p>One way is to compute summaries (means) first, and feed into <code>ggplot</code> as in vitamin B example.</p></li>
<li><p>Or, have <code>ggplot</code> compute them for us, thus:</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(autonoise, <span class="fu">aes</span>(</span>
<span id="cb46-2"><a href="#cb46-2"></a>  <span class="at">x =</span> size, <span class="at">y =</span> noise,</span>
<span id="cb46-3"><a href="#cb46-3"></a>  <span class="at">colour =</span> type, <span class="at">group =</span> type</span>
<span id="cb46-4"><a href="#cb46-4"></a>)) <span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"point"</span>) <span class="sc">+</span></span>
<span id="cb46-6"><a href="#cb46-6"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">"line"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="interaction-plot-2" class="slide level2">
<h2>Interaction plot</h2>
<p>The lines are definitely <em>not</em> parallel, showing that the effect of <code>type</code> is different for medium-sized engines than for others:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>g</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="anova_files/figure-revealjs/bAnova-30-1.png" width="960" class="r-stretch"></section>
<section id="if-you-dont-like-that" class="slide level2">
<h2>If you don’t like that</h2>
<p>then compute the means first, in a pipeline:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>autonoise <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>  <span class="fu">group_by</span>(size, type) <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3"></a>  <span class="fu">summarize</span>(<span class="at">mean_noise =</span> <span class="fu">mean</span>(noise)) <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb48-5"><a href="#cb48-5"></a>    <span class="at">x =</span> size, <span class="at">y =</span> mean_noise, <span class="at">group =</span> type,</span>
<span id="cb48-6"><a href="#cb48-6"></a>    <span class="at">colour =</span> type</span>
<span id="cb48-7"><a href="#cb48-7"></a>  )) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="anova_files/figure-revealjs/bAnova-31-1.png" width="960" class="r-stretch"></section>
<section id="simple-effects-for-auto-noise-example" class="slide level2">
<h2>Simple effects for auto noise example</h2>
<ul>
<li><p>In auto noise example, weren’t interested in all comparisons between car size and filter type combinations.</p></li>
<li><p>Wanted to demonstrate (lack of) difference between filter types <em>for each car type</em>.</p></li>
<li><p>These are called <strong>simple effects</strong> of one variable (filter type) conditional on other variable (car type).</p></li>
<li><p>To do this, pull out just the data for small cars, compare noise for the two filter types. Then repeat for medium and large cars. (Three one-way ANOVAs.)</p></li>
</ul>
</section>
<section id="do-it-using-dplyr-tools" class="slide level2">
<h2>Do it using <code>dplyr tools</code></h2>
<ul>
<li>Small cars:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>autonoise <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>  <span class="fu">filter</span>(size <span class="sc">==</span> <span class="st">"S"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3"></a>  <span class="fu">aov</span>(noise <span class="sc">~</span> type, <span class="at">data =</span> .) <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
type         1   33.3   33.33   0.548  0.476
Residuals   10  608.3   60.83               </code></pre>
</div>
</div>
<ul>
<li><p>No filter difference for small cars.</p></li>
<li><p>For Medium, change <code>S</code> to <code>M</code> and repeat.</p></li>
</ul>
</section>
<section id="simple-effect-of-filter-type-for-medium-cars" class="slide level2">
<h2>Simple effect of filter type for medium cars</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>autonoise <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>  <span class="fu">filter</span>(size <span class="sc">==</span> <span class="st">"M"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3"></a>  <span class="fu">aov</span>(noise <span class="sc">~</span> type, <span class="at">data =</span> .) <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
type         1 1752.1  1752.1   68.93 8.49e-06 ***
Residuals   10  254.2    25.4                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<ul>
<li>There <em>is</em> an effect of filter type for medium cars. Look at means to investigate (over).</li>
</ul>
</section>
<section id="mean-noise-for-each-filter-type" class="slide level2">
<h2>Mean noise for each filter type</h2>
<p>for medium engine size:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a>autonoise <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>  <span class="fu">filter</span>(size <span class="sc">==</span> <span class="st">"M"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="#cb53-4"></a>  <span class="fu">summarize</span>(<span class="at">m =</span> <span class="fu">mean</span>(noise))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["type"],"name":[1],"type":["chr"],"align":["left"]},{"label":["m"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Octel","2":"821.6667"},{"1":"Std","2":"845.8333"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li>Octel filters produce <em>less</em> noise for medium cars.</li>
</ul>
</section>
<section id="large-cars" class="slide level2">
<h2>Large cars</h2>
<ul>
<li>Large cars:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>autonoise <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="#cb54-2"></a>  <span class="fu">filter</span>(size <span class="sc">==</span> <span class="st">"L"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3"></a>  <span class="fu">aov</span>(noise <span class="sc">~</span> type, <span class="at">data =</span> .) <span class="sc">%&gt;%</span></span>
<span id="cb54-4"><a href="#cb54-4"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)
type         1     75      75   0.682  0.428
Residuals   10   1100     110               </code></pre>
</div>
</div>
<ul>
<li>No significant difference again.</li>
</ul>
</section>
<section id="all-at-once-using-splitapplycombine" class="slide level2">
<h2>All at once, using split/apply/combine</h2>
<p>The “split” part:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a>autonoise <span class="sc">%&gt;%</span></span>
<span id="cb56-2"><a href="#cb56-2"></a>  <span class="fu">group_by</span>(size) <span class="sc">%&gt;%</span></span>
<span id="cb56-3"><a href="#cb56-3"></a>  <span class="fu">nest</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["size"],"name":[1],"type":["chr"],"align":["left"]},{"label":["data"],"name":[2],"type":["list"],"align":["right"]}],"data":[{"1":"M","2":"<tibble[,3]>"},{"1":"L","2":"<tibble[,3]>"},{"1":"S","2":"<tibble[,3]>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Now have <em>three</em> rows, with the data frame for each size encoded as <em>one element</em> of this data frame.</p>
</section>
<section id="apply" class="slide level2">
<h2>Apply</h2>
<ul>
<li>Write function to do <code>aov</code> on a data frame with columns <code>noise</code> and <code>type</code>, returning P-value:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>aov_pval <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb57-2"><a href="#cb57-2"></a>  noise<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">aov</span>(noise <span class="sc">~</span> type, <span class="at">data =</span> x)</span>
<span id="cb57-3"><a href="#cb57-3"></a>  gg <span class="ot">&lt;-</span> <span class="fu">tidy</span>(noise<span class="fl">.1</span>)</span>
<span id="cb57-4"><a href="#cb57-4"></a>  gg<span class="sc">$</span>p.value[<span class="dv">1</span>]</span>
<span id="cb57-5"><a href="#cb57-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Test it:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>autonoise <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2"></a>  <span class="fu">filter</span>(size <span class="sc">==</span> <span class="st">"L"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3"></a>  <span class="fu">aov_pval</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.428221</code></pre>
</div>
</div>
<ul>
<li>Check.</li>
</ul>
</section>
<section id="combine" class="slide level2">
<h2>Combine</h2>
<ul>
<li>Apply this function to each of the nested data frames (one per engine size):</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a>autonoise <span class="sc">%&gt;%</span></span>
<span id="cb60-2"><a href="#cb60-2"></a>  <span class="fu">nest_by</span>(size) <span class="sc">%&gt;%</span> </span>
<span id="cb60-3"><a href="#cb60-3"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb60-4"><a href="#cb60-4"></a>  <span class="fu">mutate</span>(<span class="at">p_val =</span> <span class="fu">aov_pval</span>(data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["size"],"name":[1],"type":["chr"],"align":["left"]},{"label":["data"],"name":[2],"type":["list<tibble[,3]>"],"align":["right"]},{"label":["p_val"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"L","2":"<list<tibble[,3]>>","3":"4.282210e-01"},{"1":"M","2":"<list<tibble[,3]>>","3":"8.492967e-06"},{"1":"S","2":"<list<tibble[,3]>>","3":"4.761786e-01"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="tidy-up" class="slide level2">
<h2>Tidy up</h2>
<ul>
<li>The <code>data</code> column was stepping-stone to getting answer. Don’t need it any more:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>autonoise <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>  <span class="fu">nest_by</span>(size) <span class="sc">%&gt;%</span> </span>
<span id="cb61-3"><a href="#cb61-3"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb61-4"><a href="#cb61-4"></a>  <span class="fu">mutate</span>(<span class="at">p_val =</span> <span class="fu">aov_pval</span>(data)) <span class="sc">%&gt;%</span> </span>
<span id="cb61-5"><a href="#cb61-5"></a>  <span class="fu">select</span>(<span class="sc">-</span>data) <span class="ot">-&gt;</span> simple_effects</span>
<span id="cb61-6"><a href="#cb61-6"></a>simple_effects</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["size"],"name":[1],"type":["chr"],"align":["left"]},{"label":["p_val"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"L","2":"4.282210e-01"},{"1":"M","2":"8.492967e-06"},{"1":"S","2":"4.761786e-01"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="simultaneous-tests" class="slide level2">
<h2>Simultaneous tests</h2>
<ul>
<li>When testing simple effects, doing several tests at once. (In this case, 3.) Have to adjust P-values for this. Eg.&nbsp;Holm:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>simple_effects <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(p_val) <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2"></a>  <span class="fu">mutate</span>(<span class="at">multiplier =</span> <span class="dv">4</span> <span class="sc">-</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3"></a>  <span class="fu">mutate</span>(<span class="at">p_val_adj =</span> p_val <span class="sc">*</span> multiplier)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["size"],"name":[1],"type":["chr"],"align":["left"]},{"label":["p_val"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["multiplier"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["p_val_adj"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"M","2":"8.492967e-06","3":"3","4":"0.0000254789"},{"1":"L","2":"4.282210e-01","3":"2","4":"0.8564419461"},{"1":"S","2":"4.761786e-01","3":"1","4":"0.4761785895"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li><p>No change in rejection decisions.</p></li>
<li><p>Octel filters sig.&nbsp;better in terms of noise for medium cars, and not sig.&nbsp;different for other sizes.</p></li>
<li><p>Octel filters never significantly worse than standard ones.</p></li>
</ul>
</section>
<section id="confidence-intervals" class="slide level2">
<h2>Confidence intervals</h2>
<ul>
<li><p>Perhaps better way of assessing simple effects: look at <em>confidence intervals</em> rather than tests.</p></li>
<li><p>Gives us sense of accuracy of estimation, and thus whether non-significance might be lack of power: ``absence of evidence is not evidence of absence’’.</p></li>
<li><p>Works here because <em>two</em> filter types, using <code>t.test</code> for each engine type.</p></li>
<li><p>Want to show that the Octel filter is equivalent to or better than the standard filter, in terms of engine noise.</p></li>
</ul>
</section>
<section id="equivalence-and-noninferiority" class="slide level2">
<h2>Equivalence and noninferiority</h2>
<ul>
<li><p>Known as “equivalence testing” in medical world. A good read: <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3019319/">link</a>. Basic idea: decide on size of difference <span class="math inline">\(\delta\)</span> that would be considered “equivalent”, and if CI entirely inside <span class="math inline">\(\pm \delta\)</span>, have evidence in favour of equivalence.</p></li>
<li><p>We really want to show that the Octel filters are “no worse” than the standard one: that is, equivalent <em>or better</em> than standard filters.</p></li>
<li><p>Such a “noninferiority test” done by checking that <code>upper limit</code> of CI, new minus old, is <em>less</em> than <span class="math inline">\(\delta\)</span>. (This requires careful thinking about (i) which way around the difference is and (ii) whether a higher or lower value is better.)</p></li>
</ul>
</section>
<section id="ci-for-small-cars" class="slide level2">
<h2>CI for small cars</h2>
<p>Same idea as for simple effect test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>autonoise <span class="sc">%&gt;%</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>  <span class="fu">filter</span>(size <span class="sc">==</span> <span class="st">"S"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="#cb63-3"></a>  <span class="fu">t.test</span>(noise <span class="sc">~</span> type, <span class="at">data =</span> .) <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4"></a>  <span class="fu">pluck</span>(<span class="st">"conf.int"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -14.517462   7.850795
attr(,"conf.level")
[1] 0.95</code></pre>
</div>
</div>
</section>
<section id="ci-for-medium-cars" class="slide level2">
<h2>CI for medium cars</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>autonoise <span class="sc">%&gt;%</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>  <span class="fu">filter</span>(size <span class="sc">==</span> <span class="st">"M"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb65-3"><a href="#cb65-3"></a>  <span class="fu">t.test</span>(noise <span class="sc">~</span> type, <span class="at">data =</span> .) <span class="sc">%&gt;%</span></span>
<span id="cb65-4"><a href="#cb65-4"></a>  <span class="fu">pluck</span>(<span class="st">"conf.int"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -30.75784 -17.57549
attr(,"conf.level")
[1] 0.95</code></pre>
</div>
</div>
</section>
<section id="ci-for-large-cars" class="slide level2">
<h2>CI for large cars</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>autonoise <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2"></a>  <span class="fu">filter</span>(size <span class="sc">==</span> <span class="st">"L"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3"></a>  <span class="fu">t.test</span>(noise <span class="sc">~</span> type, <span class="at">data =</span> .) <span class="sc">%&gt;%</span></span>
<span id="cb67-4"><a href="#cb67-4"></a>  <span class="fu">pluck</span>(<span class="st">"conf.int"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -19.270673   9.270673
attr(,"conf.level")
[1] 0.95</code></pre>
</div>
</div>
</section>
<section id="or-all-at-once-splitapplycombine" class="slide level2">
<h2>Or, all at once: split/apply/combine</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>ci_func <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb69-2"><a href="#cb69-2"></a>  tt <span class="ot">&lt;-</span> <span class="fu">t.test</span>(noise <span class="sc">~</span> type, <span class="at">data =</span> x)</span>
<span id="cb69-3"><a href="#cb69-3"></a>  tt<span class="sc">$</span>conf.int</span>
<span id="cb69-4"><a href="#cb69-4"></a>}</span>
<span id="cb69-5"><a href="#cb69-5"></a></span>
<span id="cb69-6"><a href="#cb69-6"></a>autonoise <span class="sc">%&gt;%</span> <span class="fu">nest_by</span>(size) <span class="sc">%&gt;%</span></span>
<span id="cb69-7"><a href="#cb69-7"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb69-8"><a href="#cb69-8"></a>  <span class="fu">mutate</span>(<span class="at">ci =</span> <span class="fu">list</span>(<span class="fu">ci_func</span>(data))) <span class="sc">%&gt;%</span></span>
<span id="cb69-9"><a href="#cb69-9"></a>  <span class="fu">unnest_wider</span>(ci, <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="ot">-&gt;</span> cis</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="results" class="slide level2">
<h2>Results</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>cis <span class="sc">%&gt;%</span> <span class="fu">select</span>(size, <span class="fu">starts_with</span>(<span class="st">"ci"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["size"],"name":[1],"type":["chr"],"align":["left"]},{"label":["ci_1"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["ci_2"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"L","2":"-19.27067","3":"9.270673"},{"1":"M","2":"-30.75784","3":"-17.575492"},{"1":"S","2":"-14.51746","3":"7.850795"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="procedure" class="slide level2">
<h2>Procedure</h2>
<ul>
<li><p>Function to get CI of difference in noise means for types of filter on input data frame</p></li>
<li><p>Nest by <code>size</code> (mini-df <code>data</code> per size)</p></li>
<li><p>Calculate CI for each thing in <code>data</code>: CI is two numbers long</p></li>
<li><p><code>unnest</code> <code>ci</code> column (wider) to see two numbers in each CI.</p></li>
</ul>
</section>
<section id="cis-and-noninferiority-test" class="slide level2">
<h2>CIs and noninferiority test</h2>
<ul>
<li><p>Suppose we decide that a 20 dB difference would be considered equivalent. (I have no idea whether that is reasonable.)</p></li>
<li><p>Intervals: </p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>cis <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["size"],"name":[1],"type":["chr"],"align":["left"]},{"label":["ci_1"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["ci_2"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"L","2":"-19.27067","3":"9.270673"},{"1":"M","2":"-30.75784","3":"-17.575492"},{"1":"S","2":"-14.51746","3":"7.850795"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="comments-3" class="slide level2">
<h2>Comments</h2>
<ul>
<li><p>In all cases, upper limit of CI is less than 20 dB. The Octel filters are “noninferior” to the standard ones.</p></li>
<li><p>Caution: we did 3 procedures at once again. The true confidence level is not 95%. (Won’t worry about that here.)</p></li>
</ul>
</section>
<section id="contrasts-in-anova" class="slide level2">
<h2>Contrasts in ANOVA</h2>
<ul>
<li><p>Sometimes, don’t want to compare <em>all</em> groups, only <em>some</em> of them.</p></li>
<li><p>Might be able to specify these comparisons ahead of time; other comparisons of no interest.</p></li>
<li><p>Wasteful to do ANOVA and Tukey.</p></li>
</ul>
</section>
<section id="example-chainsaw-kickback" class="slide level2">
<h2>Example: chainsaw kickback</h2>
<ul>
<li><p>From <a href="http://www.ohio.edu/plantbio/staff/mccarthy/quantmet/lectures/ANOVA2.pdf">link</a>.</p></li>
<li><p>Forest manager concerned about safety of chainsaws issued to field crew. 4 models of chainsaws, measure “kickback” (degrees of deflection) for 5 of each:</p></li>
</ul>
<pre><code>
 A  B  C  D
-----------
42 28 57 29
17 50 45 29
24 44 48 22
39 32 41 34
43 61 54 30
</code></pre>
<ul>
<li>So far, standard 1-way ANOVA: what differences are there among models?</li>
</ul>
</section>
<section id="chainsaw-kickback-2" class="slide level2">
<h2>chainsaw kickback (2)</h2>
<ul>
<li><p>But: models A and D are designed to be used at home, while models B and C are industrial models.</p></li>
<li><p>Suggests these comparisons of interest:</p></li>
<li><p>home vs.&nbsp;industrial</p></li>
<li><p>the two home models A vs.&nbsp;D</p></li>
<li><p>the two industrial models B vs.&nbsp;C.</p></li>
<li><p>Don’t need to compare <em>all</em> the pairs of models.</p></li>
</ul>
</section>
<section id="what-is-a-contrast" class="slide level2">
<h2>What is a contrast?</h2>
<ul>
<li><p>Contrast is a linear combination of group means.</p></li>
<li><p>Notation: <span class="math inline">\(\mu_A\)</span> for (population) mean of group <span class="math inline">\(A\)</span>, and so on.</p></li>
<li><p>In example, compare two home models: <span class="math inline">\(H_0: \mu_A-\mu_D=0\)</span>.</p></li>
<li><p>Compare two industrial models: <span class="math inline">\(H_0: \mu_B-\mu_C=0\)</span>.</p></li>
<li><p>Compare average of two home models vs.&nbsp;average of two industrial models: <span class="math inline">\(H_0: \frac{1}{2}(\mu_A+\mu_D)-{1\over 2}(\mu_B+\mu_C)=0\)</span> or <span class="math inline">\(H_0: 0.5\mu_A-0.5\mu_B-0.5\mu_C+0.5\mu_D=0\)</span>.</p></li>
<li><p>Note that coefficients of contrasts add to 0, and right-hand side is 0.</p></li>
</ul>
</section>
<section id="contrasts-in-r" class="slide level2">
<h2>Contrasts in R</h2>
<ul>
<li>Comparing two home models A and D (<span class="math inline">\(\mu_A-\mu_D=0\)</span>):</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>c.home <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Comparing two industrial models B and C (<span class="math inline">\(\mu_B-\mu_C=0\)</span>):</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>c.industrial <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Comparing home average vs.&nbsp;industrial average (<span class="math inline">\(0.5\mu_A-0.5\mu_B-0.5\mu_C+0.5\mu_D=0\)</span>):</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>c.home.ind <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="orthogonal-contrasts" class="slide level2">
<h2>Orthogonal contrasts</h2>
<ul>
<li>What happens if we multiply the contrast coefficients one by one?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>c.home <span class="sc">*</span> c.industrial</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0 0 0 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a>c.home <span class="sc">*</span> c.home.ind</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.5  0.0  0.0 -0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>c.industrial <span class="sc">*</span> c.home.ind</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.0 -0.5  0.5  0.0</code></pre>
</div>
</div>
<ul>
<li>in each case, the results <strong>add up to zero</strong>. Such contrasts are called <strong>orthogonal</strong>.</li>
</ul>
</section>
<section id="orthogonal-contrasts-2" class="slide level2">
<h2>Orthogonal contrasts (2)</h2>
<ul>
<li>Compare these:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb82-2"><a href="#cb82-2"></a>c2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb82-3"><a href="#cb82-3"></a><span class="fu">sum</span>(c1 <span class="sc">*</span> c2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1</code></pre>
</div>
</div>
<p>Not zero, so <code>c1</code> and <code>c2</code> are <em>not</em> orthogonal.</p>
<ul>
<li><p>Orthogonal contrasts are much easier to deal with.</p></li>
<li><p>Can use non-orthogonal contrasts, but more trouble (beyond us).</p></li>
</ul>
</section>
<section id="read-in-data" class="slide level2">
<h2>Read in data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a>url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/chainsaw.txt"</span></span>
<span id="cb84-2"><a href="#cb84-2"></a>chain.wide <span class="ot">&lt;-</span> <span class="fu">read_table</span>(url)</span>
<span id="cb84-3"><a href="#cb84-3"></a>chain.wide</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["A"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["B"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["C"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["D"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"42","2":"28","3":"57","4":"29"},{"1":"17","2":"50","3":"45","4":"29"},{"1":"24","2":"44","3":"48","4":"22"},{"1":"39","2":"32","3":"41","4":"34"},{"1":"43","2":"61","3":"54","4":"30"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="tidying" class="slide level2">
<h2>Tidying</h2>
<p>Need all the kickbacks in <em>one</em> column:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>chain.wide <span class="sc">%&gt;%</span> </span>
<span id="cb85-2"><a href="#cb85-2"></a>  <span class="fu">pivot_longer</span>(A<span class="sc">:</span>D, <span class="at">names_to =</span> <span class="st">"model"</span>, </span>
<span id="cb85-3"><a href="#cb85-3"></a>               <span class="at">names_ptypes =</span> <span class="fu">list</span>(<span class="at">model=</span><span class="fu">factor</span>()), </span>
<span id="cb85-4"><a href="#cb85-4"></a>               <span class="at">values_to =</span> <span class="st">"kickback"</span>) <span class="ot">-&gt;</span> chain</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="starting-the-analysis-2" class="slide level2">
<h2>Starting the analysis (2)</h2>
<p>The proper data frame:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a>chain </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["model"],"name":[1],"type":["fct"],"align":["left"]},{"label":["kickback"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"A","2":"42"},{"1":"B","2":"28"},{"1":"C","2":"57"},{"1":"D","2":"29"},{"1":"A","2":"17"},{"1":"B","2":"50"},{"1":"C","2":"45"},{"1":"D","2":"29"},{"1":"A","2":"24"},{"1":"B","2":"44"},{"1":"C","2":"48"},{"1":"D","2":"22"},{"1":"A","2":"39"},{"1":"B","2":"32"},{"1":"C","2":"41"},{"1":"D","2":"34"},{"1":"A","2":"43"},{"1":"B","2":"61"},{"1":"C","2":"54"},{"1":"D","2":"30"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="setting-up-contrasts" class="slide level2">
<h2>Setting up contrasts</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>m <span class="ot">&lt;-</span> <span class="fu">cbind</span>(c.home, c.industrial, c.home.ind)</span>
<span id="cb87-2"><a href="#cb87-2"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     c.home c.industrial c.home.ind
[1,]      1            0        0.5
[2,]      0            1       -0.5
[3,]      0           -1       -0.5
[4,]     -1            0        0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a><span class="fu">contrasts</span>(chain<span class="sc">$</span>model) <span class="ot">&lt;-</span> m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="anova-as-if-regression" class="slide level2">
<h2>ANOVA <em>as if regression</em></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>chain<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(kickback <span class="sc">~</span> model, <span class="at">data =</span> chain)</span>
<span id="cb90-2"><a href="#cb90-2"></a><span class="fu">summary</span>(chain<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = kickback ~ model, data = chain)

Residuals:
   Min     1Q Median     3Q    Max 
-16.00  -7.10   0.60   6.25  18.00 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         38.450      2.179  17.649 6.52e-12 ***
modelc.home          2.100      3.081   0.682  0.50524    
modelc.industrial   -3.000      3.081  -0.974  0.34469    
modelc.home.ind    -15.100      4.357  -3.466  0.00319 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.743 on 16 degrees of freedom
Multiple R-squared:  0.4562,    Adjusted R-squared:  0.3542 
F-statistic: 4.474 on 3 and 16 DF,  p-value: 0.01833</code></pre>
</div>
</div>
</section>
<section id="conclusions" class="slide level2">
<h2>Conclusions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="fu">tidy</span>(chain<span class="fl">.1</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(term, p.value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["p.value"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"6.518309e-12"},{"1":"modelc.home","2":"5.052396e-01"},{"1":"modelc.industrial","2":"3.446913e-01"},{"1":"modelc.home.ind","2":"3.187219e-03"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li><p>Two home models not sig.&nbsp;diff.&nbsp;(P-value 0.51)</p></li>
<li><p>Two industrial models not sig.&nbsp;diff.&nbsp;(P-value 0.34)</p></li>
<li><p>Home, industrial models <em>are</em> sig.&nbsp;diff.&nbsp;(P-value 0.0032).</p></li>
</ul>
</section>
<section id="means-by-model" class="slide level2">
<h2>Means by model</h2>
<ul>
<li>The means:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>chain <span class="sc">%&gt;%</span></span>
<span id="cb93-2"><a href="#cb93-2"></a>  <span class="fu">group_by</span>(model) <span class="sc">%&gt;%</span></span>
<span id="cb93-3"><a href="#cb93-3"></a>  <span class="fu">summarize</span>(<span class="at">mean.kick =</span> <span class="fu">mean</span>(kickback)) <span class="sc">%&gt;%</span></span>
<span id="cb93-4"><a href="#cb93-4"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mean.kick))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["model"],"name":[1],"type":["fct"],"align":["left"]},{"label":["mean.kick"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"C","2":"49.0"},{"1":"B","2":"43.0"},{"1":"A","2":"33.0"},{"1":"D","2":"28.8"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li><p>Home models A &amp; D have less kickback than industrial ones B &amp; C.</p></li>
<li><p>Makes sense because industrial users should get training to cope with additional kickback.</p></li>
</ul>
<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="anova_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="anova_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="anova_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="anova_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="anova_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="anova_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="anova_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="anova_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="anova_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="anova_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>