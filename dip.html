<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Durations, intervals, and periods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="dip_files/libs/clipboard/clipboard.min.js"></script>
<script src="dip_files/libs/quarto-html/quarto.js"></script>
<script src="dip_files/libs/quarto-html/popper.min.js"></script>
<script src="dip_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="dip_files/libs/quarto-html/anchor.min.js"></script>
<link href="dip_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="dip_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="dip_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="dip_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="dip_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<link href="dip_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="dip_files/libs/pagedtable-1.1/js/pagedtable.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="dip.html"><i class="bi bi-file-slides"></i>RevealJS</a></li><li><a href="dip.pdf"><i class="bi bi-file-pdf"></i>Beamer</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Durations, intervals, and periods</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="packages-for-this-section" class="level2">
<h2 class="anchored" data-anchor-id="packages-for-this-section">Packages for this section</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Dates and times live in a package called <code>lubridate</code>, but this is now part of the <code>tidyverse</code>.</p>
</section>
<section id="exact-time-intervals" class="level2">
<h2 class="anchored" data-anchor-id="exact-time-intervals">Exact time intervals</h2>
<p>We previously got fractional days (of stays in hospital):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/datafiles/hospital.csv"</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>stays <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(my_url)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>stays <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stay_days =</span> (discharge <span class="sc">-</span> admit) <span class="sc">/</span> <span class="fu">ddays</span>(<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["admit"],"name":[1],"type":["dttm"],"align":["right"]},{"label":["discharge"],"name":[2],"type":["dttm"],"align":["right"]},{"label":["stay_days"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1981-12-10 22:00:00","2":"1982-01-03 14:00:00","3":"23.666667"},{"1":"2014-03-07 14:00:00","2":"2014-03-08 09:30:00","3":"0.812500"},{"1":"2016-08-31 21:00:00","2":"2016-09-02 17:00:00","3":"1.833333"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>but what if we wanted days, hours and minutes?</p>
</section>
<section id="intervals" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="intervals">Intervals</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>stays <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stay =</span> admit <span class="sc">%--%</span> discharge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["admit"],"name":[1],"type":["dttm"],"align":["right"]},{"label":["discharge"],"name":[2],"type":["dttm"],"align":["right"]},{"label":["stay"],"name":[3],"type":["Interval"],"align":["right"]}],"data":[{"1":"1981-12-10 22:00:00","2":"1982-01-03 14:00:00","3":"1981-12-10 22:00:00 UTC--1982-01-03 14:00:00 UTC"},{"1":"2014-03-07 14:00:00","2":"2014-03-08 09:30:00","3":"2014-03-07 14:00:00 UTC--2014-03-08 09:30:00 UTC"},{"1":"2016-08-31 21:00:00","2":"2016-09-02 17:00:00","3":"2016-08-31 21:00:00 UTC--2016-09-02 17:00:00 UTC"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li>These are called <em>intervals</em>: they have a start point and an end point.</li>
</ul>
</section>
<section id="periods" class="level2">
<h2 class="anchored" data-anchor-id="periods">Periods</h2>
<p>To work out the exact length of an interval, in human units, turn it into a <code>period</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>stays <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stay =</span> <span class="fu">as.period</span>(admit <span class="sc">%--%</span> discharge))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["admit"],"name":[1],"type":["dttm"],"align":["right"]},{"label":["discharge"],"name":[2],"type":["dttm"],"align":["right"]},{"label":["stay"],"name":[3],"type":["Period"],"align":["right"]}],"data":[{"1":"1981-12-10 22:00:00","2":"1982-01-03 14:00:00","3":"23d 16H 0M 0S"},{"1":"2014-03-07 14:00:00","2":"2014-03-08 09:30:00","3":"19H 30M 0S"},{"1":"2016-08-31 21:00:00","2":"2016-09-02 17:00:00","3":"1d 20H 0M 0S"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>A period is exact as long as it has a start and an end (accounting for daylight savings, leap years etc).</p>
</section>
<section id="completed-days" class="level2">
<h2 class="anchored" data-anchor-id="completed-days">Completed days</h2>
<p>Take <code>day</code> of the periods:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>stays <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stay =</span> <span class="fu">as.period</span>(admit <span class="sc">%--%</span> discharge)) <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">days_of_stay =</span> <span class="fu">day</span>(stay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["admit"],"name":[1],"type":["dttm"],"align":["right"]},{"label":["discharge"],"name":[2],"type":["dttm"],"align":["right"]},{"label":["stay"],"name":[3],"type":["Period"],"align":["right"]},{"label":["days_of_stay"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1981-12-10 22:00:00","2":"1982-01-03 14:00:00","3":"23d 16H 0M 0S","4":"23"},{"1":"2014-03-07 14:00:00","2":"2014-03-08 09:30:00","3":"19H 30M 0S","4":"0"},{"1":"2016-08-31 21:00:00","2":"2016-09-02 17:00:00","3":"1d 20H 0M 0S","4":"1"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="completed-hours-12" class="level2">
<h2 class="anchored" data-anchor-id="completed-hours-12">Completed hours 1/2</h2>
<ul>
<li>Not quite what you think:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>stays <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stay =</span> <span class="fu">as.period</span>(admit <span class="sc">%--%</span> discharge)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hours_of_stay =</span> <span class="fu">hour</span>(stay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["admit"],"name":[1],"type":["dttm"],"align":["right"]},{"label":["discharge"],"name":[2],"type":["dttm"],"align":["right"]},{"label":["stay"],"name":[3],"type":["Period"],"align":["right"]},{"label":["hours_of_stay"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1981-12-10 22:00:00","2":"1982-01-03 14:00:00","3":"23d 16H 0M 0S","4":"16"},{"1":"2014-03-07 14:00:00","2":"2014-03-08 09:30:00","3":"19H 30M 0S","4":"19"},{"1":"2016-08-31 21:00:00","2":"2016-09-02 17:00:00","3":"1d 20H 0M 0S","4":"20"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li>These are completed hours <em>within</em> days.</li>
</ul>
</section>
<section id="completed-hours-22" class="level2">
<h2 class="anchored" data-anchor-id="completed-hours-22">Completed hours 2/2</h2>
<ul>
<li>To get total hours, count each day as 24 hours also:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>stays <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stay =</span> <span class="fu">as.period</span>(admit <span class="sc">%--%</span> discharge)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hours_of_stay =</span> <span class="fu">hour</span>(stay) <span class="sc">+</span> <span class="dv">24</span><span class="sc">*</span><span class="fu">day</span>(stay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["admit"],"name":[1],"type":["dttm"],"align":["right"]},{"label":["discharge"],"name":[2],"type":["dttm"],"align":["right"]},{"label":["stay"],"name":[3],"type":["Period"],"align":["right"]},{"label":["hours_of_stay"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1981-12-10 22:00:00","2":"1982-01-03 14:00:00","3":"23d 16H 0M 0S","4":"568"},{"1":"2014-03-07 14:00:00","2":"2014-03-08 09:30:00","3":"19H 30M 0S","4":"19"},{"1":"2016-08-31 21:00:00","2":"2016-09-02 17:00:00","3":"1d 20H 0M 0S","4":"44"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="durations" class="level2">
<h2 class="anchored" data-anchor-id="durations">Durations</h2>
<ul>
<li>What’s the difference between <code>duration</code> and <code>period</code>?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>stays <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">stay =</span> <span class="fu">as.duration</span>(admit <span class="sc">%--%</span> discharge)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["admit"],"name":[1],"type":["dttm"],"align":["right"]},{"label":["discharge"],"name":[2],"type":["dttm"],"align":["right"]},{"label":["stay"],"name":[3],"type":["Duration"],"align":["right"]}],"data":[{"1":"1981-12-10 22:00:00","2":"1982-01-03 14:00:00","3":"2044800s (~3.38 weeks)"},{"1":"2014-03-07 14:00:00","2":"2014-03-08 09:30:00","3":"70200s (~19.5 hours)"},{"1":"2016-08-31 21:00:00","2":"2016-09-02 17:00:00","3":"158400s (~1.83 days)"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li>A duration is always a number of <em>seconds</em>.</li>
<li>Also shown is an approx equivalent on a more human scale (calculated from seconds).</li>
</ul>
</section>
<section id="sometimes-it-matters" class="level2">
<h2 class="anchored" data-anchor-id="sometimes-it-matters">Sometimes it matters</h2>
<ul>
<li>Days and hours are always the same length (as a number of seconds).</li>
<li>Months and years are not always the same length:
<ul>
<li>months have different numbers of days</li>
<li>years can be leap years or not</li>
<li>the actual length of 2 months depends <em>which</em> 2 months:</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tribble</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>start, <span class="sc">~</span>end,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ymd</span>(<span class="st">"2020-01-15"</span>), <span class="fu">ymd</span>(<span class="st">"2020-03-15"</span>),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ymd</span>(<span class="st">"2020-07-15"</span>), <span class="fu">ymd</span>(<span class="st">"2020-09-15"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">period =</span> <span class="fu">as.period</span>(start <span class="sc">%--%</span> end)) <span class="sc">%&gt;%</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">duration =</span> <span class="fu">as.duration</span>(start <span class="sc">%--%</span> end))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["start"],"name":[1],"type":["date"],"align":["right"]},{"label":["end"],"name":[2],"type":["date"],"align":["right"]},{"label":["period"],"name":[3],"type":["Period"],"align":["right"]},{"label":["duration"],"name":[4],"type":["Duration"],"align":["right"]}],"data":[{"1":"2020-01-15","2":"2020-03-15","3":"2m 0d 0H 0M 0S","4":"5184000s (~8.57 weeks)"},{"1":"2020-07-15","2":"2020-09-15","3":"2m 0d 0H 0M 0S","4":"5356800s (~8.86 weeks)"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="comments" class="level2">
<h2 class="anchored" data-anchor-id="comments">Comments</h2>
<ul>
<li>Both periods are exactly two months</li>
<li>but they have a different duration in seconds</li>
<li>the first two-month period is shorter because it contains the short month February</li>
<li>the second two-month period is longer because both July and August have 31 days.</li>
</ul>
</section>
<section id="manchester-united" class="level2">
<h2 class="anchored" data-anchor-id="manchester-united">Manchester United</h2>
<p>Sometime in December 2019 or January 2020, I downloaded some information about the players that were then in the squad of the famous Manchester United Football (soccer) Club. We are going to use the players’ ages (as given) to figure out exactly when the download happened.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>my_url <span class="ot">&lt;-</span> <span class="st">"http://ritsokiguess.site/STAD29/manu.csv"</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(my_url) <span class="sc">%&gt;%</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, date_of_birth, age) <span class="ot">-&gt;</span> man_united</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">The data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>man_united</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["date_of_birth"],"name":[2],"type":["chr"],"align":["left"]},{"label":["age"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"David de Gea Quintana","2":"7 November 1990","3":"29"},{"1":"Lee Grant","2":"27 January 1983","3":"36"},{"1":"Sergio Germán Romero","2":"22 February 1987","3":"32"},{"1":"Victor Nilsson Lindelöf","2":"17 July 1994","3":"25"},{"1":"Eric Bertrand  Bailly","2":"12 April 1994","3":"25"},{"1":"Phil Jones","2":"21 February 1992","3":"27"},{"1":"Harry Maguire","2":"5 March 1993","3":"26"},{"1":"Faustino Marcos Alberto Rojo","2":"20 March 1990","3":"29"},{"1":"Ashley Young","2":"9 July 1985","3":"34"},{"1":"José Diogo Dalot Teixeira","2":"18 March 1999","3":"20"},{"1":"Luke Shaw","2":"12 July 1995","3":"24"},{"1":"Timothy Evans Fosu-Mensah","2":"2 January 1998","3":"21"},{"1":"Aaron Wan-Bissaka","2":"26 November 1997","3":"22"},{"1":"Axel Tuanzebe","2":"14 November 1997","3":"22"},{"1":"Brandon Williams","2":"3 September 2000","3":"19"},{"1":"Paul Pogba","2":"15 March 1993","3":"26"},{"1":"Juan Manuel Mata García","2":"28 April 1988","3":"31"},{"1":"Jesse Lingard","2":"15 December 1992","3":"26"},{"1":"Andreas Hoelgebaum Pereira","2":"1 January 1996","3":"23"},{"1":"Frederico Rodrigues Santos","2":"5 March 1993","3":"26"},{"1":"Daniel James","2":"10 November 1997","3":"22"},{"1":"Angel Gomes","2":"31 August 2000","3":"19"},{"1":"Nemanja Matić","2":"1 August 1988","3":"31"},{"1":"James Garner","2":"13 March 2001","3":"18"},{"1":"Scott McTominay","2":"8 December 1996","3":"23"},{"1":"Anthony Martial","2":"5 December 1995","3":"24"},{"1":"Marcus Rashford","2":"31 October 1997","3":"22"},{"1":"Mason Greenwood","2":"1 October 2001","3":"18"},{"1":"Tahith Chong","2":"4 December 1999","3":"20"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="ages" class="level2">
<h2 class="anchored" data-anchor-id="ages">Ages</h2>
<ul>
<li>A player’s age is the number of <em>completed</em> years since their birth</li>
<li>This suggests:
<ul>
<li>guessing a download date</li>
<li>working out time since birth as <em>period</em></li>
<li>extracting number of years</li>
</ul></li>
<li>After that, see if our calculations of age match actual ages</li>
</ul>
</section>
<section id="guess-download-date-and-work-out-ages" class="level2">
<h2 class="anchored" data-anchor-id="guess-download-date-and-work-out-ages">Guess download date and work out ages</h2>
<p>Guess January 10, 2020 as download date (just to pick a date):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>guess <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2020-01-10"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>man_united <span class="sc">%&gt;%</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dob =</span> <span class="fu">dmy</span>(date_of_birth)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_period =</span> <span class="fu">as.period</span>(dob <span class="sc">%--%</span> guess)) <span class="sc">%&gt;%</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_years =</span> <span class="fu">year</span>(age_period)) <span class="ot">-&gt;</span> d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="results-just-the-ages" class="level2">
<h2 class="anchored" data-anchor-id="results-just-the-ages">Results (just the ages)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> <span class="fu">select</span>(name, age, age_years)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["age"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["age_years"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"David de Gea Quintana","2":"29","3":"29"},{"1":"Lee Grant","2":"36","3":"36"},{"1":"Sergio Germán Romero","2":"32","3":"32"},{"1":"Victor Nilsson Lindelöf","2":"25","3":"25"},{"1":"Eric Bertrand  Bailly","2":"25","3":"25"},{"1":"Phil Jones","2":"27","3":"27"},{"1":"Harry Maguire","2":"26","3":"26"},{"1":"Faustino Marcos Alberto Rojo","2":"29","3":"29"},{"1":"Ashley Young","2":"34","3":"34"},{"1":"José Diogo Dalot Teixeira","2":"20","3":"20"},{"1":"Luke Shaw","2":"24","3":"24"},{"1":"Timothy Evans Fosu-Mensah","2":"21","3":"22"},{"1":"Aaron Wan-Bissaka","2":"22","3":"22"},{"1":"Axel Tuanzebe","2":"22","3":"22"},{"1":"Brandon Williams","2":"19","3":"19"},{"1":"Paul Pogba","2":"26","3":"26"},{"1":"Juan Manuel Mata García","2":"31","3":"31"},{"1":"Jesse Lingard","2":"26","3":"27"},{"1":"Andreas Hoelgebaum Pereira","2":"23","3":"24"},{"1":"Frederico Rodrigues Santos","2":"26","3":"26"},{"1":"Daniel James","2":"22","3":"22"},{"1":"Angel Gomes","2":"19","3":"19"},{"1":"Nemanja Matić","2":"31","3":"31"},{"1":"James Garner","2":"18","3":"18"},{"1":"Scott McTominay","2":"23","3":"23"},{"1":"Anthony Martial","2":"24","3":"24"},{"1":"Marcus Rashford","2":"22","3":"22"},{"1":"Mason Greenwood","2":"18","3":"18"},{"1":"Tahith Chong","2":"20","3":"20"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="which-ones-are-different" class="level2">
<h2 class="anchored" data-anchor-id="which-ones-are-different">Which ones are different?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span> <span class="fu">filter</span>(age <span class="sc">!=</span> age_years) <span class="sc">%&gt;%</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, date_of_birth, age, age_years)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["date_of_birth"],"name":[2],"type":["chr"],"align":["left"]},{"label":["age"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["age_years"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Timothy Evans Fosu-Mensah","2":"2 January 1998","3":"21","4":"22"},{"1":"Jesse Lingard","2":"15 December 1992","3":"26","4":"27"},{"1":"Andreas Hoelgebaum Pereira","2":"1 January 1996","3":"23","4":"24"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li>these three players were calculated wrong: we got one year too many.</li>
<li>Our guessed date, January 10, was too <em>late</em>.</li>
<li>These three players had a birthday since the actual download date</li>
<li>actual download date must have been before Dec 15.</li>
</ul>
</section>
<section id="try-an-earlier-date" class="level2">
<h2 class="anchored" data-anchor-id="try-an-earlier-date">Try an earlier date</h2>
<ul>
<li>say Dec 5:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>guess <span class="ot">&lt;-</span> <span class="fu">ymd</span>(<span class="st">"2019-12-05"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>man_united <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dob =</span> <span class="fu">dmy</span>(date_of_birth)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_period =</span> <span class="fu">as.period</span>(dob <span class="sc">%--%</span> guess)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_years =</span> <span class="fu">year</span>(age_period)) <span class="sc">%&gt;%</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(age <span class="sc">!=</span> age_years) <span class="sc">%&gt;%</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, date_of_birth, age, age_years) <span class="ot">-&gt;</span> d2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>d2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["date_of_birth"],"name":[2],"type":["chr"],"align":["left"]},{"label":["age"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["age_years"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"Scott McTominay","2":"8 December 1996","3":"23","4":"22"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<ul>
<li>Dec 5 was too early for the download date</li>
<li>must have been later than Dec 8 (to get McTominay’s age right)</li>
<li>so must have been between Dec 8 and Dec 15 (Lingard’s birthday)</li>
<li>Actually I downloaded the data on Dec 10.</li>
</ul>
</section>

</main>
<!-- /main column -->

<script>
  // htmlwidgets need to know to resize themselves when slides are shown/hidden.
  // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
  // slide changes (different for each slide format).
  (function () {
    // dispatch for htmlwidgets
    function fireSlideEnter() {
      const event = window.document.createEvent("Event");
      event.initEvent("slideenter", true, true);
      window.document.dispatchEvent(event);
    }

    function fireSlideChanged(previousSlide, currentSlide) {
      fireSlideEnter();

      // dispatch for shiny
      if (window.jQuery) {
        if (previousSlide) {
          window.jQuery(previousSlide).trigger("hidden");
        }
        if (currentSlide) {
          window.jQuery(currentSlide).trigger("shown");
        }
      }
    }

    // hookup for slidy
    if (window.w3c_slidy) {
      window.w3c_slidy.add_observer(function (slide_num) {
        // slide_num starts at position 1
        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
      });
    }

  })();
</script>

<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>