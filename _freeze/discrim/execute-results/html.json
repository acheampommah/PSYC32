{
  "hash": "1dc93a96e66d36d38ab1d4713ce6e256",
  "result": {
    "markdown": "---\ntitle: \"Discrimimant Analysis\"\n---\n\n\n\n\n\n## Discriminant analysis\n\n\n* ANOVA and MANOVA: predict a (counted/measured) response from group membership.\n\n* Discriminant analysis: predict group membership based on counted/measured variables.\n\n* Covers same ground as logistic regression (and its variations), but emphasis on classifying observed data into correct groups.\n\n* Does so by searching for linear combination of original variables that best separates data into groups (canonical variables).\n\n* Assumption here that groups are known (for data we have). If trying to \"best separate\" data into unknown groups, see *cluster analysis*.\n\n\n\n## Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MASS)\nlibrary(tidyverse)\nlibrary(ggrepel)\nlibrary(ggbiplot)\nlibrary(MVTests) # for Box M test\nlibrary(conflicted)\nconflict_prefer(\"arrange\", \"dplyr\")\nconflict_prefer(\"summarize\", \"dplyr\")\nconflict_prefer(\"select\", \"dplyr\")\nconflict_prefer(\"filter\", \"dplyr\")\nconflict_prefer(\"mutate\", \"dplyr\")\n```\n:::\n\n\n   \n\n- `ggrepel` allows labelling points on a plot so they don't\noverwrite each other.\n- `ggbiplot` uses `plyr` rather than `dplyr`, which has functions by similar names.\n\n## About `select`\n\n\n* Both `dplyr` (in `tidyverse`) and `MASS`\nhave a function called `select`, and *they do\ndifferent things*.\n\n* How do you know which `select` is going to get called? \n\n* With `library`, the one loaded *last* is visible,\nand others are not.\n\n* Thus we can access the `select` in `dplyr` but\nnot the one in `MASS`. If we wanted that one, we'd have to\nsay `MASS::select`.\n\n- Better: load `conflicted` package. Any time you load two packages containing functions with same name, you get error and have to choose between them. \n\n## Example 1: seed yields and weights\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/manova1.txt\"\nhilo <- read_delim(my_url, \" \")\ng <- ggplot(hilo, aes(x = yield, y = weight,\n  colour = fertilizer)) + geom_point(size = 4)\n```\n:::\n\n \n\n\n:::: {.columns}\n\n::: {.column width=\"40%\"}\nRecall data from MANOVA: needed a multivariate analysis to find\ndifference in seed yield and weight based on whether they were high\nor low fertilizer.\n:::\n\n::: {.column width=\"60%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](discrim_files/figure-revealjs/unnamed-chunk-1-1.png){width=960}\n:::\n:::\n\n\n\n:::\n\n::::\n\n## Basic discriminant analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhilo.1 <- lda(fertilizer ~ yield + weight, data = hilo)\n```\n:::\n\n\n \n\n\n\n* Uses `lda` from package MASS.\n\n* \"Predicting\" group membership from measured variables.\n\n\n\n\n## Output\n\n\\small\n\n::: {.cell}\n\n```{.r .cell-code}\nhilo.1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\nlda(fertilizer ~ yield + weight, data = hilo)\n\nPrior probabilities of groups:\nhigh  low \n 0.5  0.5 \n\nGroup means:\n     yield weight\nhigh  35.0  13.25\nlow   32.5  12.00\n\nCoefficients of linear discriminants:\n              LD1\nyield  -0.7666761\nweight -1.2513563\n```\n:::\n:::\n\n\\normalsize\n \n\n\n\n## Things to take from output\n\n\n* Group means: high-fertilizer plants have (slightly) higher\nmean yield and weight than low-fertilizer plants.\n\n* \"Coefficients of linear discriminants\": \\texttt{LD1,\nLD2,}\\ldots are scores constructed from observed variables that\nbest separate the groups.\n\n\n* For any plant, get LD1 score by taking $-0.76$ times yield\nplus $-1.25$ times weight, add up, standardize.\n\n- the LD1 coefficients are like slopes: \n  - if yield higher, LD1 score for a plant lower\n  - if weight higher, LD1 score for a plant lower\n\n* High-fertilizer plants have higher yield and weight, thus\nlow (negative) LD1 score. Low-fertilizer plants have low yield and\nweight, thus high (positive) LD1 score.\n\n* One LD1 score for each observation. Plot with actual groups.\n\n\n\n\n## How many linear discriminants?\n\n\n* Smaller of these:\n\n  * Number of variables\n\n  * Number of groups *minus 1*\n\n\n* Seed yield and weight: 2 variables, 2 groups,\n$\\min(2,2-1)=1$. \n\n\n\n## Getting LD scores\nFeed output from LDA into `predict`:\n\n\\scriptsize\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- predict(hilo.1)\nhilo.2 <- cbind(hilo, p)\nhilo.2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"fertilizer\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"yield\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"weight\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"class\"],\"name\":[4],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"posterior.high\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.low\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"LD1\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"low\",\"2\":\"34\",\"3\":\"10\",\"4\":\"low\",\"5\":\"2.108619e-05\",\"6\":\"9.999789e-01\",\"7\":\"3.0931414\",\"_rn_\":\"1\"},{\"1\":\"low\",\"2\":\"29\",\"3\":\"14\",\"4\":\"low\",\"5\":\"1.245320e-03\",\"6\":\"9.987547e-01\",\"7\":\"1.9210963\",\"_rn_\":\"2\"},{\"1\":\"low\",\"2\":\"35\",\"3\":\"11\",\"4\":\"low\",\"5\":\"2.315016e-02\",\"6\":\"9.768498e-01\",\"7\":\"1.0751090\",\"_rn_\":\"3\"},{\"1\":\"low\",\"2\":\"32\",\"3\":\"13\",\"4\":\"low\",\"5\":\"4.579036e-02\",\"6\":\"9.542096e-01\",\"7\":\"0.8724245\",\"_rn_\":\"4\"},{\"1\":\"high\",\"2\":\"33\",\"3\":\"14\",\"4\":\"high\",\"5\":\"9.817958e-01\",\"6\":\"1.820422e-02\",\"7\":\"-1.1456079\",\"_rn_\":\"5\"},{\"1\":\"high\",\"2\":\"38\",\"3\":\"12\",\"4\":\"high\",\"5\":\"9.998195e-01\",\"6\":\"1.804941e-04\",\"7\":\"-2.4762756\",\"_rn_\":\"6\"},{\"1\":\"high\",\"2\":\"34\",\"3\":\"13\",\"4\":\"high\",\"5\":\"9.089278e-01\",\"6\":\"9.107216e-02\",\"7\":\"-0.6609276\",\"_rn_\":\"7\"},{\"1\":\"high\",\"2\":\"35\",\"3\":\"14\",\"4\":\"high\",\"5\":\"9.999109e-01\",\"6\":\"8.914534e-05\",\"7\":\"-2.6789600\",\"_rn_\":\"8\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\\normalsize\n\n## LD1 scores in order\n\nMost positive LD1 score is most obviously low fertilizer, most negative is most obviously high:\n\n\\footnotesize\n\n::: {.cell}\n\n```{.r .cell-code}\nhilo.2 %>% select(fertilizer, yield, weight, LD1) %>% \n  arrange(desc(LD1))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"fertilizer\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"yield\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"weight\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"LD1\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"low\",\"2\":\"34\",\"3\":\"10\",\"4\":\"3.0931414\",\"_rn_\":\"1\"},{\"1\":\"low\",\"2\":\"29\",\"3\":\"14\",\"4\":\"1.9210963\",\"_rn_\":\"2\"},{\"1\":\"low\",\"2\":\"35\",\"3\":\"11\",\"4\":\"1.0751090\",\"_rn_\":\"3\"},{\"1\":\"low\",\"2\":\"32\",\"3\":\"13\",\"4\":\"0.8724245\",\"_rn_\":\"4\"},{\"1\":\"high\",\"2\":\"34\",\"3\":\"13\",\"4\":\"-0.6609276\",\"_rn_\":\"7\"},{\"1\":\"high\",\"2\":\"33\",\"3\":\"14\",\"4\":\"-1.1456079\",\"_rn_\":\"5\"},{\"1\":\"high\",\"2\":\"38\",\"3\":\"12\",\"4\":\"-2.4762756\",\"_rn_\":\"6\"},{\"1\":\"high\",\"2\":\"35\",\"3\":\"14\",\"4\":\"-2.6789600\",\"_rn_\":\"8\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n \nHigh fertilizer have yield and weight high, negative LD1 scores.\n\n\n## Plotting LD1 scores\nWith one LD score, plot against (true) groups, eg. boxplot: \n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(hilo.2, aes(x = fertilizer, y = LD1)) + geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](discrim_files/figure-revealjs/bDiscrim-8-1.png){width=960}\n:::\n:::\n\n\n   \n\n## What else is in `hilo.2`?\n\n\n\n* `class`: predicted fertilizer level (based on values of\n`yield` and `weight`).\n\n* `posterior`: predicted probability of being low or high\nfertilizer given `yield` and `weight`.\n \n- `LD1`: scores for (each) linear discriminant (here is only LD1) on each observation.\n\n## Predictions and predicted groups\n\\ldots based on `yield` and `weight`: \n\n\\footnotesize\n\n::: {.cell}\n\n```{.r .cell-code}\nhilo.2 %>% select(yield, weight, fertilizer, class)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"yield\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"weight\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"fertilizer\"],\"name\":[3],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"class\"],\"name\":[4],\"type\":[\"fct\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"34\",\"2\":\"10\",\"3\":\"low\",\"4\":\"low\",\"_rn_\":\"1\"},{\"1\":\"29\",\"2\":\"14\",\"3\":\"low\",\"4\":\"low\",\"_rn_\":\"2\"},{\"1\":\"35\",\"2\":\"11\",\"3\":\"low\",\"4\":\"low\",\"_rn_\":\"3\"},{\"1\":\"32\",\"2\":\"13\",\"3\":\"low\",\"4\":\"low\",\"_rn_\":\"4\"},{\"1\":\"33\",\"2\":\"14\",\"3\":\"high\",\"4\":\"high\",\"_rn_\":\"5\"},{\"1\":\"38\",\"2\":\"12\",\"3\":\"high\",\"4\":\"high\",\"_rn_\":\"6\"},{\"1\":\"34\",\"2\":\"13\",\"3\":\"high\",\"4\":\"high\",\"_rn_\":\"7\"},{\"1\":\"35\",\"2\":\"14\",\"3\":\"high\",\"4\":\"high\",\"_rn_\":\"8\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n\n\n## Count up correct and incorrect classification\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(hilo.2, table(obs = fertilizer, pred = class))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      pred\nobs    high low\n  high    4   0\n  low     0   4\n```\n:::\n:::\n\n\n \n* Each predicted fertilizer level is exactly same as observed\none (perfect prediction).\n\n* Table shows no errors: all values on top-left to bottom-right\ndiagonal. \n\n\n\n## Posterior probabilities\n\n\\footnotesize\n\n\nshow how clear-cut the classification decisions were:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhilo.2 %>% \n  mutate(across(starts_with(\"posterior\"), \\(p) round(p, 4))) %>% \n  select(-LD1)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"fertilizer\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"yield\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"weight\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"class\"],\"name\":[4],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"posterior.high\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.low\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"low\",\"2\":\"34\",\"3\":\"10\",\"4\":\"low\",\"5\":\"0.0000\",\"6\":\"1.0000\",\"_rn_\":\"1\"},{\"1\":\"low\",\"2\":\"29\",\"3\":\"14\",\"4\":\"low\",\"5\":\"0.0012\",\"6\":\"0.9988\",\"_rn_\":\"2\"},{\"1\":\"low\",\"2\":\"35\",\"3\":\"11\",\"4\":\"low\",\"5\":\"0.0232\",\"6\":\"0.9768\",\"_rn_\":\"3\"},{\"1\":\"low\",\"2\":\"32\",\"3\":\"13\",\"4\":\"low\",\"5\":\"0.0458\",\"6\":\"0.9542\",\"_rn_\":\"4\"},{\"1\":\"high\",\"2\":\"33\",\"3\":\"14\",\"4\":\"high\",\"5\":\"0.9818\",\"6\":\"0.0182\",\"_rn_\":\"5\"},{\"1\":\"high\",\"2\":\"38\",\"3\":\"12\",\"4\":\"high\",\"5\":\"0.9998\",\"6\":\"0.0002\",\"_rn_\":\"6\"},{\"1\":\"high\",\"2\":\"34\",\"3\":\"13\",\"4\":\"high\",\"5\":\"0.9089\",\"6\":\"0.0911\",\"_rn_\":\"7\"},{\"1\":\"high\",\"2\":\"35\",\"3\":\"14\",\"4\":\"high\",\"5\":\"0.9999\",\"6\":\"0.0001\",\"_rn_\":\"8\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nOnly obs.\\ 7 has any doubt: `yield` low for a high-fertilizer,\nbut high `weight` makes up for it.\n \n\\normalsize\n\n\n## Example 2: the peanuts \n\n\\scriptsize\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/peanuts.txt\"\npeanuts <- read_delim(my_url, \" \")\npeanuts\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"obs\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"location\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"variety\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"y\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"smk\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"w\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"1\",\"3\":\"5\",\"4\":\"195.3\",\"5\":\"153.1\",\"6\":\"51.4\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"5\",\"4\":\"194.3\",\"5\":\"167.7\",\"6\":\"53.7\"},{\"1\":\"3\",\"2\":\"2\",\"3\":\"5\",\"4\":\"189.7\",\"5\":\"139.5\",\"6\":\"55.5\"},{\"1\":\"4\",\"2\":\"2\",\"3\":\"5\",\"4\":\"180.4\",\"5\":\"121.1\",\"6\":\"44.4\"},{\"1\":\"5\",\"2\":\"1\",\"3\":\"6\",\"4\":\"203.0\",\"5\":\"156.8\",\"6\":\"49.8\"},{\"1\":\"6\",\"2\":\"1\",\"3\":\"6\",\"4\":\"195.9\",\"5\":\"166.0\",\"6\":\"45.8\"},{\"1\":\"7\",\"2\":\"2\",\"3\":\"6\",\"4\":\"202.7\",\"5\":\"166.1\",\"6\":\"60.4\"},{\"1\":\"8\",\"2\":\"2\",\"3\":\"6\",\"4\":\"197.6\",\"5\":\"161.8\",\"6\":\"54.1\"},{\"1\":\"9\",\"2\":\"1\",\"3\":\"8\",\"4\":\"193.5\",\"5\":\"164.5\",\"6\":\"57.8\"},{\"1\":\"10\",\"2\":\"1\",\"3\":\"8\",\"4\":\"187.0\",\"5\":\"165.1\",\"6\":\"58.6\"},{\"1\":\"11\",\"2\":\"2\",\"3\":\"8\",\"4\":\"201.5\",\"5\":\"166.8\",\"6\":\"65.0\"},{\"1\":\"12\",\"2\":\"2\",\"3\":\"8\",\"4\":\"200.0\",\"5\":\"173.8\",\"6\":\"67.2\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n \n\n- Recall: `location` and `variety` both significant in\nMANOVA. Make combo of them (over):\n\n\n## Location-variety combos\n\n\\footnotesize\n\n::: {.cell}\n\n```{.r .cell-code}\npeanuts %>%\n   unite(combo, c(variety, location)) -> peanuts.combo\npeanuts.combo\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"obs\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"combo\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"y\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"smk\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"w\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"5_1\",\"3\":\"195.3\",\"4\":\"153.1\",\"5\":\"51.4\"},{\"1\":\"2\",\"2\":\"5_1\",\"3\":\"194.3\",\"4\":\"167.7\",\"5\":\"53.7\"},{\"1\":\"3\",\"2\":\"5_2\",\"3\":\"189.7\",\"4\":\"139.5\",\"5\":\"55.5\"},{\"1\":\"4\",\"2\":\"5_2\",\"3\":\"180.4\",\"4\":\"121.1\",\"5\":\"44.4\"},{\"1\":\"5\",\"2\":\"6_1\",\"3\":\"203.0\",\"4\":\"156.8\",\"5\":\"49.8\"},{\"1\":\"6\",\"2\":\"6_1\",\"3\":\"195.9\",\"4\":\"166.0\",\"5\":\"45.8\"},{\"1\":\"7\",\"2\":\"6_2\",\"3\":\"202.7\",\"4\":\"166.1\",\"5\":\"60.4\"},{\"1\":\"8\",\"2\":\"6_2\",\"3\":\"197.6\",\"4\":\"161.8\",\"5\":\"54.1\"},{\"1\":\"9\",\"2\":\"8_1\",\"3\":\"193.5\",\"4\":\"164.5\",\"5\":\"57.8\"},{\"1\":\"10\",\"2\":\"8_1\",\"3\":\"187.0\",\"4\":\"165.1\",\"5\":\"58.6\"},{\"1\":\"11\",\"2\":\"8_2\",\"3\":\"201.5\",\"4\":\"166.8\",\"5\":\"65.0\"},{\"1\":\"12\",\"2\":\"8_2\",\"3\":\"200.0\",\"4\":\"173.8\",\"5\":\"67.2\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\\normalsize\n\n## Discriminant analysis\n\n\\tiny\n\n::: {.cell}\n\n```{.r .cell-code}\npeanuts.1 <- lda(combo ~ y + smk + w, data = peanuts.combo)\npeanuts.1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\nlda(combo ~ y + smk + w, data = peanuts.combo)\n\nPrior probabilities of groups:\n      5_1       5_2       6_1       6_2       8_1       8_2 \n0.1666667 0.1666667 0.1666667 0.1666667 0.1666667 0.1666667 \n\nGroup means:\n         y    smk     w\n5_1 194.80 160.40 52.55\n5_2 185.05 130.30 49.95\n6_1 199.45 161.40 47.80\n6_2 200.15 163.95 57.25\n8_1 190.25 164.80 58.20\n8_2 200.75 170.30 66.10\n\nCoefficients of linear discriminants:\n           LD1         LD2         LD3\ny    0.4027356  0.02967881  0.18839237\nsmk  0.1727459 -0.06794271 -0.09386294\nw   -0.5792456 -0.16300221  0.07341123\n\nProportion of trace:\n   LD1    LD2    LD3 \n0.8424 0.1317 0.0258 \n```\n:::\n:::\n\n\\normalsize\n   \n\n\n\n\n## Comments\n\n* Now 3 LDs (3 variables, 6 groups, $\\min(3,6-1)=3$).\n\n* Relationship of LDs to original variables. Look for\ncoeffs far from zero: \n\n\n::: {.cell}\n\n```{.r .cell-code}\npeanuts.1$scaling\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           LD1         LD2         LD3\ny    0.4027356  0.02967881  0.18839237\nsmk  0.1727459 -0.06794271 -0.09386294\nw   -0.5792456 -0.16300221  0.07341123\n```\n:::\n:::\n\n\n\n\n   *   high `LD1` mainly high `y`\nor low `w`.\n\n   * high `LD2` mainly low `w`.\n\n\n* Proportion of trace values show relative importance of LDs:\n`LD1` much more important than `LD2`; `LD3` worthless.\n\n\n\n## The predictions and misclassification\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- predict(peanuts.1)\npeanuts.2 <- cbind(peanuts.combo, p)\nwith(peanuts.2, table(obs = combo, pred = class))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     pred\nobs   5_1 5_2 6_1 6_2 8_1 8_2\n  5_1   2   0   0   0   0   0\n  5_2   0   2   0   0   0   0\n  6_1   0   0   2   0   0   0\n  6_2   1   0   0   1   0   0\n  8_1   0   0   0   0   2   0\n  8_2   0   0   0   0   0   2\n```\n:::\n:::\n\n\nActually classified very well. Only one `6_2` classified as a\n`5_1`, rest all correct.\n\n\n## Posterior probabilities\n\n\\scriptsize\n\n\n::: {.cell}\n\n```{.r .cell-code}\npeanuts.2 %>% \n  mutate(across(starts_with(\"posterior\"), \\(p) round(p, 2))) %>% \n  select(combo,  class, starts_with(\"posterior\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"combo\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"class\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"posterior.5_1\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.5_2\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.6_1\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.6_2\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.8_1\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.8_2\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"5_1\",\"2\":\"5_1\",\"3\":\"0.69\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0.31\",\"7\":\"0.00\",\"8\":\"0.00\",\"_rn_\":\"1\"},{\"1\":\"5_1\",\"2\":\"5_1\",\"3\":\"0.73\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0.27\",\"7\":\"0.00\",\"8\":\"0.00\",\"_rn_\":\"2\"},{\"1\":\"5_2\",\"2\":\"5_2\",\"3\":\"0.00\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0.00\",\"7\":\"0.00\",\"8\":\"0.00\",\"_rn_\":\"3\"},{\"1\":\"5_2\",\"2\":\"5_2\",\"3\":\"0.00\",\"4\":\"1\",\"5\":\"0\",\"6\":\"0.00\",\"7\":\"0.00\",\"8\":\"0.00\",\"_rn_\":\"4\"},{\"1\":\"6_1\",\"2\":\"6_1\",\"3\":\"0.00\",\"4\":\"0\",\"5\":\"1\",\"6\":\"0.00\",\"7\":\"0.00\",\"8\":\"0.00\",\"_rn_\":\"5\"},{\"1\":\"6_1\",\"2\":\"6_1\",\"3\":\"0.00\",\"4\":\"0\",\"5\":\"1\",\"6\":\"0.00\",\"7\":\"0.00\",\"8\":\"0.00\",\"_rn_\":\"6\"},{\"1\":\"6_2\",\"2\":\"6_2\",\"3\":\"0.13\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0.87\",\"7\":\"0.00\",\"8\":\"0.00\",\"_rn_\":\"7\"},{\"1\":\"6_2\",\"2\":\"5_1\",\"3\":\"0.53\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0.47\",\"7\":\"0.00\",\"8\":\"0.00\",\"_rn_\":\"8\"},{\"1\":\"8_1\",\"2\":\"8_1\",\"3\":\"0.02\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0.02\",\"7\":\"0.75\",\"8\":\"0.21\",\"_rn_\":\"9\"},{\"1\":\"8_1\",\"2\":\"8_1\",\"3\":\"0.00\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0.00\",\"7\":\"0.99\",\"8\":\"0.01\",\"_rn_\":\"10\"},{\"1\":\"8_2\",\"2\":\"8_2\",\"3\":\"0.00\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0.00\",\"7\":\"0.03\",\"8\":\"0.97\",\"_rn_\":\"11\"},{\"1\":\"8_2\",\"2\":\"8_2\",\"3\":\"0.00\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0.00\",\"7\":\"0.06\",\"8\":\"0.94\",\"_rn_\":\"12\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\\small   \n\n*Some* doubt about which combo each plant belongs in, but not too\nmuch. The one misclassified plant was a close call.\n\n\\normalsize\n\n## Discriminant scores, again\n\n\n* How are discriminant scores related to original variables?\n\n* Construct data frame with original data and discriminant\nscores side by side:\n\n\\footnotesize\n\n::: {.cell}\n\n```{.r .cell-code}\npeanuts.1$scaling\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           LD1         LD2         LD3\ny    0.4027356  0.02967881  0.18839237\nsmk  0.1727459 -0.06794271 -0.09386294\nw   -0.5792456 -0.16300221  0.07341123\n```\n:::\n:::\n\n\\normalsize\n   \n\n* LD1 positive if `y` large and/or `w` small.\n\n* LD2 positive if `w` small.    \n\n\n\n\n\n## Discriminant scores for data\n\n\\footnotesize\n\n::: {.cell}\n\n```{.r .cell-code}\npeanuts.2 %>% select(y, w, starts_with(\"x\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"y\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"w\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"x.LD1\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"x.LD2\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"x.LD3\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"195.3\",\"2\":\"51.4\",\"3\":\"1.417354\",\"4\":\"1.01233393\",\"5\":\"0.26467918\",\"_rn_\":\"1\"},{\"1\":\"194.3\",\"2\":\"53.7\",\"3\":\"2.204444\",\"4\":\"-0.38421359\",\"5\":\"-1.12526629\",\"_rn_\":\"2\"},{\"1\":\"189.7\",\"2\":\"55.5\",\"3\":\"-5.562217\",\"4\":\"1.10184441\",\"5\":\"0.78720394\",\"_rn_\":\"3\"},{\"1\":\"180.4\",\"2\":\"44.4\",\"3\":\"-6.056558\",\"4\":\"3.88530191\",\"5\":\"-0.05263163\",\"_rn_\":\"4\"},{\"1\":\"203.0\",\"2\":\"49.8\",\"3\":\"6.084370\",\"4\":\"1.25027629\",\"5\":\"1.25054957\",\"_rn_\":\"5\"},{\"1\":\"195.9\",\"2\":\"45.8\",\"3\":\"7.131192\",\"4\":\"1.06649258\",\"5\":\"-1.24422021\",\"_rn_\":\"6\"},{\"1\":\"202.7\",\"2\":\"60.4\",\"3\":\"1.430084\",\"4\":\"-1.11831802\",\"5\":\"1.09926555\",\"_rn_\":\"7\"},{\"1\":\"197.6\",\"2\":\"54.1\",\"3\":\"2.282572\",\"4\":\"0.04938762\",\"5\":\"0.07958437\",\"_rn_\":\"8\"},{\"1\":\"193.5\",\"2\":\"57.8\",\"3\":\"-1.045438\",\"4\":\"-0.85884902\",\"5\":\"-0.67463274\",\"_rn_\":\"9\"},{\"1\":\"187.0\",\"2\":\"58.6\",\"3\":\"-4.022969\",\"4\":\"-1.22292871\",\"5\":\"-1.89677191\",\"_rn_\":\"10\"},{\"1\":\"201.5\",\"2\":\"65.0\",\"3\":\"-1.596806\",\"4\":\"-1.95130266\",\"5\":\"1.14518230\",\"_rn_\":\"11\"},{\"1\":\"200.0\",\"2\":\"67.2\",\"3\":\"-2.266028\",\"4\":\"-2.83002474\",\"5\":\"0.36705787\",\"_rn_\":\"12\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n   \n\n* Obs.\\ 5 and 6 have most positive `LD1`: large `y`,\nsmall `w`.\n\n* Obs.\\ 4 has most positive `LD2`: small `w`.\n\n\\normalsize\n\n\n\n## Plot LD1 vs.\\ LD2, labelling by combo\n\n\\small\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng <- ggplot(peanuts.2, aes(x = x.LD1, y = x.LD2, colour = combo, \n                    label = combo)) + geom_point() +\n  geom_text_repel() + guides(colour = \"none\")\ng\n```\n\n::: {.cell-output-display}\n![](discrim_files/figure-revealjs/bDiscrim-24-1.png){width=960}\n:::\n:::\n\n\n\\normalsize   \n\n\n## \"Bi-plot\" from `ggbiplot`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggbiplot(peanuts.1, groups = factor(peanuts.combo$combo))\n```\n\n::: {.cell-output-display}\n![](discrim_files/figure-revealjs/bDiscrim-25-1.png){width=960}\n:::\n:::\n\n\n\n## Installing `ggbiplot`\n\n\n* `ggbiplot` not on CRAN, so usual\n`install.packages` will not work.\n\n* Install package `devtools` first (once):\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"devtools\")\n```\n:::\n\n\n     \n\n* Then install `ggbiplot` (once):\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(devtools)\ninstall_github(\"vqv/ggbiplot\")\n```\n:::\n\n\n     \n\n\n## Cross-validation\n\n\n* So far, have predicted group membership from same data used to\nform the groups --- dishonest!\n\n* Better: *cross-validation*: form groups from all\nobservations *except one*, then predict group membership for\nthat left-out observation.\n\n* No longer cheating!\n\n* Illustrate with peanuts data again.\n\n\n\n## Misclassifications\n\n\n* Fitting and prediction all in one go:\n\n\\small\n\n::: {.cell}\n\n```{.r .cell-code}\np <- lda(combo ~ y + smk + w,\n  data = peanuts.combo, CV = TRUE)\npeanuts.3 <- cbind(peanuts.combo, class = p$class, \n                   posterior = p$posterior)\nwith(peanuts.3, table(obs = combo, pred = class))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     pred\nobs   5_1 5_2 6_1 6_2 8_1 8_2\n  5_1   0   0   0   2   0   0\n  5_2   0   1   0   0   1   0\n  6_1   0   0   2   0   0   0\n  6_2   1   0   0   1   0   0\n  8_1   0   1   0   0   0   1\n  8_2   0   0   0   0   0   2\n```\n:::\n:::\n\n\\normalsize\n   \n* Some more misclassification this time.\n\n\n\n\n## Repeat of LD plot\n\n::: {.cell}\n\n```{.r .cell-code}\ng\n```\n\n::: {.cell-output-display}\n![](discrim_files/figure-revealjs/graziani-1.png){width=960}\n:::\n:::\n\n\n   \n\n\n## Posterior probabilities\n\n\\footnotesize\n\n::: {.cell}\n\n```{.r .cell-code}\npeanuts.3 %>% \n  mutate(across(starts_with(\"posterior\"), \\(p) round(p, 3))) %>% \n  select(combo, class, starts_with(\"posterior\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"combo\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"class\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"posterior.5_1\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.5_2\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.6_1\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.6_2\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.8_1\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.8_2\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"5_1\",\"2\":\"6_2\",\"3\":\"0.162\",\"4\":\"0.00\",\"5\":\"0.000\",\"6\":\"0.838\",\"7\":\"0.000\",\"8\":\"0.000\",\"_rn_\":\"1\"},{\"1\":\"5_1\",\"2\":\"6_2\",\"3\":\"0.200\",\"4\":\"0.00\",\"5\":\"0.000\",\"6\":\"0.799\",\"7\":\"0.000\",\"8\":\"0.000\",\"_rn_\":\"2\"},{\"1\":\"5_2\",\"2\":\"8_1\",\"3\":\"0.000\",\"4\":\"0.18\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.820\",\"8\":\"0.000\",\"_rn_\":\"3\"},{\"1\":\"5_2\",\"2\":\"5_2\",\"3\":\"0.000\",\"4\":\"1.00\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.000\",\"8\":\"0.000\",\"_rn_\":\"4\"},{\"1\":\"6_1\",\"2\":\"6_1\",\"3\":\"0.194\",\"4\":\"0.00\",\"5\":\"0.669\",\"6\":\"0.137\",\"7\":\"0.000\",\"8\":\"0.000\",\"_rn_\":\"5\"},{\"1\":\"6_1\",\"2\":\"6_1\",\"3\":\"0.000\",\"4\":\"0.00\",\"5\":\"1.000\",\"6\":\"0.000\",\"7\":\"0.000\",\"8\":\"0.000\",\"_rn_\":\"6\"},{\"1\":\"6_2\",\"2\":\"6_2\",\"3\":\"0.325\",\"4\":\"0.00\",\"5\":\"0.000\",\"6\":\"0.667\",\"7\":\"0.001\",\"8\":\"0.008\",\"_rn_\":\"7\"},{\"1\":\"6_2\",\"2\":\"5_1\",\"3\":\"0.821\",\"4\":\"0.00\",\"5\":\"0.000\",\"6\":\"0.179\",\"7\":\"0.000\",\"8\":\"0.000\",\"_rn_\":\"8\"},{\"1\":\"8_1\",\"2\":\"8_2\",\"3\":\"0.000\",\"4\":\"0.00\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.000\",\"8\":\"1.000\",\"_rn_\":\"9\"},{\"1\":\"8_1\",\"2\":\"5_2\",\"3\":\"0.000\",\"4\":\"1.00\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.000\",\"8\":\"0.000\",\"_rn_\":\"10\"},{\"1\":\"8_2\",\"2\":\"8_2\",\"3\":\"0.001\",\"4\":\"0.00\",\"5\":\"0.000\",\"6\":\"0.004\",\"7\":\"0.083\",\"8\":\"0.913\",\"_rn_\":\"11\"},{\"1\":\"8_2\",\"2\":\"8_2\",\"3\":\"0.000\",\"4\":\"0.00\",\"5\":\"0.000\",\"6\":\"0.000\",\"7\":\"0.167\",\"8\":\"0.833\",\"_rn_\":\"12\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n   \n\n\n## Why more misclassification?\n\n\n* When predicting group membership for one observation, only\nuses the *other one* in that group.\n\n* So if two in a pair are far apart, or if two groups overlap,\ngreat potential for misclassification.\n\n* Groups `5_1` and `6_2` overlap.\n\n* `5_2` closest to `8_1`s looks more like an\n`8_1` than a `5_2` (other one far away).\n\n* `8_1`s relatively far apart and close to other things,\nso one appears to be a `5_2` and the other an `8_2`.\n\n\n## Example 3: professions and leisure activities\n\n\n* 15 individuals from three different professions (politicians,\nadministrators and belly dancers) each participate in four\ndifferent leisure activities: reading, dancing, TV watching and\nskiing. After each activity they rate it on a 0--10 scale.\n\n* How can we best use the scores on the activities to predict a person's profession?\n\n* Or, what combination(s) of scores best separate data into profession groups?\n\n\n## The data\n\n\\footnotesize\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/profile.txt\"\nactive <- read_delim(my_url, \" \")\nactive\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"job\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"reading\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"dance\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"tv\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"ski\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"bellydancer\",\"2\":\"7\",\"3\":\"10\",\"4\":\"6\",\"5\":\"5\"},{\"1\":\"bellydancer\",\"2\":\"8\",\"3\":\"9\",\"4\":\"5\",\"5\":\"7\"},{\"1\":\"bellydancer\",\"2\":\"5\",\"3\":\"10\",\"4\":\"5\",\"5\":\"8\"},{\"1\":\"bellydancer\",\"2\":\"6\",\"3\":\"10\",\"4\":\"6\",\"5\":\"8\"},{\"1\":\"bellydancer\",\"2\":\"7\",\"3\":\"8\",\"4\":\"7\",\"5\":\"9\"},{\"1\":\"politician\",\"2\":\"4\",\"3\":\"4\",\"4\":\"4\",\"5\":\"4\"},{\"1\":\"politician\",\"2\":\"6\",\"3\":\"4\",\"4\":\"5\",\"5\":\"3\"},{\"1\":\"politician\",\"2\":\"5\",\"3\":\"5\",\"4\":\"5\",\"5\":\"6\"},{\"1\":\"politician\",\"2\":\"6\",\"3\":\"6\",\"4\":\"6\",\"5\":\"7\"},{\"1\":\"politician\",\"2\":\"4\",\"3\":\"5\",\"4\":\"6\",\"5\":\"5\"},{\"1\":\"admin\",\"2\":\"3\",\"3\":\"1\",\"4\":\"1\",\"5\":\"2\"},{\"1\":\"admin\",\"2\":\"5\",\"3\":\"3\",\"4\":\"1\",\"5\":\"5\"},{\"1\":\"admin\",\"2\":\"4\",\"3\":\"2\",\"4\":\"2\",\"5\":\"5\"},{\"1\":\"admin\",\"2\":\"7\",\"3\":\"1\",\"4\":\"2\",\"5\":\"4\"},{\"1\":\"admin\",\"2\":\"6\",\"3\":\"3\",\"4\":\"3\",\"5\":\"3\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\\normalsize\n\n\n\n## Discriminant analysis\n\n\\tiny\n\n\n::: {.cell}\n\n```{.r .cell-code}\nactive.1 <- lda(job ~ reading + dance + tv + ski, data = active)\nactive.1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\nlda(job ~ reading + dance + tv + ski, data = active)\n\nPrior probabilities of groups:\n      admin bellydancer  politician \n  0.3333333   0.3333333   0.3333333 \n\nGroup means:\n            reading dance  tv ski\nadmin           5.0   2.0 1.8 3.8\nbellydancer     6.6   9.4 5.8 7.4\npolitician      5.0   4.8 5.2 5.0\n\nCoefficients of linear discriminants:\n                LD1        LD2\nreading -0.01297465 -0.4748081\ndance   -0.95212396 -0.4614976\ntv      -0.47417264  1.2446327\nski      0.04153684 -0.2033122\n\nProportion of trace:\n   LD1    LD2 \n0.8917 0.1083 \n```\n:::\n:::\n\n\\normalsize\n\n## Comments   \n\n* Two discriminants, first fair bit more important than second.\n\n* `LD1` depends (negatively) most on `dance`, a bit\non `tv`.\n\n* `LD2` depends mostly (negatively) on `tv`.\n\n\n\n## Misclassification\n\n::: {.cell}\n\n```{.r .cell-code}\np <- predict(active.1)\nactive.2 <- cbind(active, p)\nwith(active.2, table(obs = job, pred = class))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             pred\nobs           admin bellydancer politician\n  admin           5           0          0\n  bellydancer     0           5          0\n  politician      0           0          5\n```\n:::\n:::\n\n\n   \n\nEveryone correctly classified.\n\n\n## Plotting LDs \n\n\\small\n\n::: {.cell}\n\n```{.r .cell-code}\ng <- ggplot(active.2, aes(x = x.LD1, y = x.LD2, colour = job, label = job)) + \n  geom_point() + geom_text_repel() + guides(colour = \"none\")\ng\n```\n\n::: {.cell-output-display}\n![](discrim_files/figure-revealjs/bDiscrim-32-1.png){width=960}\n:::\n:::\n\n\\normalsize\n   \n\n\n## Biplot \n\n::: {.cell}\n\n```{.r .cell-code}\nggbiplot(active.1, groups = active$job)\n```\n\n::: {.cell-output-display}\n![](discrim_files/figure-revealjs/bDiscrim-33-1.png){width=960}\n:::\n:::\n\n\n   \n\n\n## Comments on plot\n\n\n* Groups well separated: bellydancers top left, administrators\ntop right, politicians lower middle.\n\n* Bellydancers most negative on `LD1`: like dancing most.\n\n* Administrators most positive on `LD1`: like dancing least.\n\n* Politicians most negative on `LD2`: like TV-watching most.\n\n\n\n## Plotting individual `persons`\nMake `label` be identifier of person. Now need legend:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nactive.2 %>% mutate(person = row_number()) %>% \n  ggplot(aes(x = x.LD1, y = x.LD2,  colour = job, \n               label = person)) + \n  geom_point() + geom_text_repel()\n```\n\n::: {.cell-output-display}\n![](discrim_files/figure-revealjs/bDiscrim-34-1.png){width=960}\n:::\n:::\n\n\n   \n\n\n## Posterior probabilities\n\n\\scriptsize\n\n::: {.cell}\n\n```{.r .cell-code}\nactive.2 %>% mutate(across(starts_with(\"posterior\"), \\(p) round(p, 3))) %>% \n  select(job, class, starts_with(\"posterior\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"job\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"class\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"posterior.admin\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.bellydancer\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.politician\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"bellydancer\",\"2\":\"bellydancer\",\"3\":\"0.000\",\"4\":\"1.000\",\"5\":\"0.000\",\"_rn_\":\"1\"},{\"1\":\"bellydancer\",\"2\":\"bellydancer\",\"3\":\"0.000\",\"4\":\"1.000\",\"5\":\"0.000\",\"_rn_\":\"2\"},{\"1\":\"bellydancer\",\"2\":\"bellydancer\",\"3\":\"0.000\",\"4\":\"1.000\",\"5\":\"0.000\",\"_rn_\":\"3\"},{\"1\":\"bellydancer\",\"2\":\"bellydancer\",\"3\":\"0.000\",\"4\":\"1.000\",\"5\":\"0.000\",\"_rn_\":\"4\"},{\"1\":\"bellydancer\",\"2\":\"bellydancer\",\"3\":\"0.000\",\"4\":\"0.997\",\"5\":\"0.003\",\"_rn_\":\"5\"},{\"1\":\"politician\",\"2\":\"politician\",\"3\":\"0.003\",\"4\":\"0.000\",\"5\":\"0.997\",\"_rn_\":\"6\"},{\"1\":\"politician\",\"2\":\"politician\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"1.000\",\"_rn_\":\"7\"},{\"1\":\"politician\",\"2\":\"politician\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"1.000\",\"_rn_\":\"8\"},{\"1\":\"politician\",\"2\":\"politician\",\"3\":\"0.000\",\"4\":\"0.002\",\"5\":\"0.998\",\"_rn_\":\"9\"},{\"1\":\"politician\",\"2\":\"politician\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"1.000\",\"_rn_\":\"10\"},{\"1\":\"admin\",\"2\":\"admin\",\"3\":\"1.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"_rn_\":\"11\"},{\"1\":\"admin\",\"2\":\"admin\",\"3\":\"1.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"_rn_\":\"12\"},{\"1\":\"admin\",\"2\":\"admin\",\"3\":\"1.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"_rn_\":\"13\"},{\"1\":\"admin\",\"2\":\"admin\",\"3\":\"1.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"_rn_\":\"14\"},{\"1\":\"admin\",\"2\":\"admin\",\"3\":\"0.982\",\"4\":\"0.000\",\"5\":\"0.018\",\"_rn_\":\"15\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n   \nNot much doubt.\n\n\n## Cross-validating the jobs-activities data\nRecall: no need for `predict`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- lda(job ~ reading + dance + tv + ski, data = active, CV = TRUE)\nactive.3 <- cbind(active, class = p$class, posterior = p$posterior)\nwith(active.3, table(obs = job, pred = class))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             pred\nobs           admin bellydancer politician\n  admin           5           0          0\n  bellydancer     0           4          1\n  politician      0           0          5\n```\n:::\n:::\n\n\n   \n\nThis time one of the bellydancers was classified as a politician.\n\n\n## and look at the posterior probabilities\n\n\\scriptsize\n\n::: {.cell}\n\n```{.r .cell-code}\nactive.3 %>% \n  mutate(across(starts_with(\"posterior\"), \\(p) round(p, 3))) %>% \n  select(job, class, starts_with(\"post\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"job\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"class\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"posterior.admin\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.bellydancer\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.politician\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"bellydancer\",\"2\":\"bellydancer\",\"3\":\"0.000\",\"4\":\"1.000\",\"5\":\"0.000\",\"_rn_\":\"1\"},{\"1\":\"bellydancer\",\"2\":\"bellydancer\",\"3\":\"0.000\",\"4\":\"1.000\",\"5\":\"0.000\",\"_rn_\":\"2\"},{\"1\":\"bellydancer\",\"2\":\"bellydancer\",\"3\":\"0.000\",\"4\":\"1.000\",\"5\":\"0.000\",\"_rn_\":\"3\"},{\"1\":\"bellydancer\",\"2\":\"bellydancer\",\"3\":\"0.000\",\"4\":\"1.000\",\"5\":\"0.000\",\"_rn_\":\"4\"},{\"1\":\"bellydancer\",\"2\":\"politician\",\"3\":\"0.000\",\"4\":\"0.001\",\"5\":\"0.999\",\"_rn_\":\"5\"},{\"1\":\"politician\",\"2\":\"politician\",\"3\":\"0.006\",\"4\":\"0.000\",\"5\":\"0.994\",\"_rn_\":\"6\"},{\"1\":\"politician\",\"2\":\"politician\",\"3\":\"0.001\",\"4\":\"0.000\",\"5\":\"0.999\",\"_rn_\":\"7\"},{\"1\":\"politician\",\"2\":\"politician\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"1.000\",\"_rn_\":\"8\"},{\"1\":\"politician\",\"2\":\"politician\",\"3\":\"0.000\",\"4\":\"0.009\",\"5\":\"0.991\",\"_rn_\":\"9\"},{\"1\":\"politician\",\"2\":\"politician\",\"3\":\"0.000\",\"4\":\"0.000\",\"5\":\"1.000\",\"_rn_\":\"10\"},{\"1\":\"admin\",\"2\":\"admin\",\"3\":\"1.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"_rn_\":\"11\"},{\"1\":\"admin\",\"2\":\"admin\",\"3\":\"1.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"_rn_\":\"12\"},{\"1\":\"admin\",\"2\":\"admin\",\"3\":\"1.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"_rn_\":\"13\"},{\"1\":\"admin\",\"2\":\"admin\",\"3\":\"1.000\",\"4\":\"0.000\",\"5\":\"0.000\",\"_rn_\":\"14\"},{\"1\":\"admin\",\"2\":\"admin\",\"3\":\"0.819\",\"4\":\"0.000\",\"5\":\"0.181\",\"_rn_\":\"15\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\\normalsize\n\n\n## Comments\n\n* Bellydancer was \"definitely\" a politician!\n\n* One of the administrators might have been a politician too.\n\n\n\n## Why did things get misclassified?\n\n\n\n:::: {.columns}\n\n::: {.column width=\"40%\"}\nGo back to plot of discriminant scores:\n\n- one bellydancer much closer to the politicians,\n\n- one administrator a bit closer to the politicians.\n\n:::\n\n::: {.column width=\"60%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](discrim_files/figure-revealjs/unnamed-chunk-5-1.png){width=960}\n:::\n:::\n\n\n\n:::\n\n::::\n\n\n## Example 4: remote-sensing data\n\n\n* View 25 crops from air, measure 4 variables `x1-x4`.\n\n* Go back and record what each crop was.\n\n* Can we use the 4 variables to distinguish crops?\n\n\n\n## The data\n\n\\footnotesize\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/remote-sensing.txt\"\ncrops <- read_table(my_url)\ncrops %>% print(n = 25)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 25 × 6\n   crop          x1    x2    x3    x4 cr   \n   <chr>      <dbl> <dbl> <dbl> <dbl> <chr>\n 1 Corn          16    27    31    33 r    \n 2 Corn          15    23    30    30 r    \n 3 Corn          16    27    27    26 r    \n 4 Corn          18    20    25    23 r    \n 5 Corn          15    15    31    32 r    \n 6 Corn          15    32    32    15 r    \n 7 Corn          12    15    16    73 r    \n 8 Soybeans      20    23    23    25 y    \n 9 Soybeans      24    24    25    32 y    \n10 Soybeans      21    25    23    24 y    \n11 Soybeans      27    45    24    12 y    \n12 Soybeans      12    13    15    42 y    \n13 Soybeans      22    32    31    43 y    \n14 Cotton        31    32    33    34 t    \n15 Cotton        29    24    26    28 t    \n16 Cotton        34    32    28    45 t    \n17 Cotton        26    25    23    24 t    \n18 Cotton        53    48    75    26 t    \n19 Cotton        34    35    25    78 t    \n20 Sugarbeets    22    23    25    42 g    \n21 Sugarbeets    25    25    24    26 g    \n22 Sugarbeets    34    25    16    52 g    \n23 Sugarbeets    54    23    21    54 g    \n24 Sugarbeets    25    43    32    15 g    \n25 Sugarbeets    26    54     2    54 g    \n```\n:::\n:::\n\n\\normalsize\n   \n\n## Discriminant analysis\n\n\\tiny\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncrops.1 <- lda(crop ~ x1 + x2 + x3 + x4, data = crops)\ncrops.1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\nlda(crop ~ x1 + x2 + x3 + x4, data = crops)\n\nPrior probabilities of groups:\n      Corn     Cotton   Soybeans Sugarbeets \n      0.28       0.24       0.24       0.24 \n\nGroup means:\n                 x1       x2       x3       x4\nCorn       15.28571 22.71429 27.42857 33.14286\nCotton     34.50000 32.66667 35.00000 39.16667\nSoybeans   21.00000 27.00000 23.50000 29.66667\nSugarbeets 31.00000 32.16667 20.00000 40.50000\n\nCoefficients of linear discriminants:\n           LD1          LD2           LD3\nx1  0.14077479  0.007780184 -0.0312610362\nx2  0.03006972  0.007318386  0.0085401510\nx3 -0.06363974 -0.099520895 -0.0005309869\nx4 -0.00677414 -0.035612707  0.0577718649\n\nProportion of trace:\n   LD1    LD2    LD3 \n0.8044 0.1832 0.0124 \n```\n:::\n:::\n\n\n\\normalsize\n\n## Assessing\n\n* 3 LDs (four variables, four groups).\n\n* 1st two important.\n\n\n* `LD1` mostly `x1` (minus)\n\n* `LD2` `x3` (minus)\n\n## Predictions\n\n\n* Thus:\n\n\\footnotesize\n\n::: {.cell}\n\n```{.r .cell-code}\np <- predict(crops.1)\ncrops.2 <- cbind(crops, p)\nwith(crops.2, table(obs = crop, pred = class))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            pred\nobs          Corn Cotton Soybeans Sugarbeets\n  Corn          6      0        1          0\n  Cotton        0      4        2          0\n  Soybeans      2      0        3          1\n  Sugarbeets    0      0        3          3\n```\n:::\n:::\n\n\\normalsize\n   \n\n* Not very good, eg. only half the Soybeans and Sugarbeets classified correctly.\n\n   \n\n\n## Plotting the LDs \n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(crops.2, aes(x = x.LD1, y = x.LD2, colour = crop)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](discrim_files/figure-revealjs/piacentini-1.png){width=960}\n:::\n:::\n\n\nCorn (red) mostly left, cotton (green) sort of right, soybeans and sugarbeets (blue and purple) mixed up.\n   \n\n\n## Biplot\n\n::: {.cell}\n\n```{.r .cell-code}\nggbiplot(crops.1, groups = crops$crop)\n```\n\n::: {.cell-output-display}\n![](discrim_files/figure-revealjs/bDiscrim-45-1.png){width=960}\n:::\n:::\n\n\n\n\n\n## Comments\n\n\n* Corn low on LD1 (left), hence low on `x1`\n\n* Cotton tends to be high on LD1 (high `x1`)\n\n- one cotton very low on LD2 (high `x3`?)\n\n* Rather mixed up.\n\n\n\n\n\n## Posterior probs (some)\n\n\\scriptsize  \n\n::: {.cell}\n\n```{.r .cell-code}\ncrops.2 %>% mutate(across(starts_with(\"posterior\"), \\(p) round(p, 3))) %>% \n  filter(crop != class) %>% \n  select(crop, class, starts_with(\"posterior\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"crop\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"class\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"posterior.Corn\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.Cotton\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.Soybeans\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"posterior.Sugarbeets\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Corn\",\"2\":\"Soybeans\",\"3\":\"0.443\",\"4\":\"0.034\",\"5\":\"0.494\",\"6\":\"0.029\",\"_rn_\":\"4\"},{\"1\":\"Soybeans\",\"2\":\"Sugarbeets\",\"3\":\"0.010\",\"4\":\"0.107\",\"5\":\"0.299\",\"6\":\"0.584\",\"_rn_\":\"11\"},{\"1\":\"Soybeans\",\"2\":\"Corn\",\"3\":\"0.684\",\"4\":\"0.009\",\"5\":\"0.296\",\"6\":\"0.011\",\"_rn_\":\"12\"},{\"1\":\"Soybeans\",\"2\":\"Corn\",\"3\":\"0.467\",\"4\":\"0.199\",\"5\":\"0.287\",\"6\":\"0.047\",\"_rn_\":\"13\"},{\"1\":\"Cotton\",\"2\":\"Soybeans\",\"3\":\"0.056\",\"4\":\"0.241\",\"5\":\"0.379\",\"6\":\"0.324\",\"_rn_\":\"15\"},{\"1\":\"Cotton\",\"2\":\"Soybeans\",\"3\":\"0.066\",\"4\":\"0.138\",\"5\":\"0.489\",\"6\":\"0.306\",\"_rn_\":\"17\"},{\"1\":\"Sugarbeets\",\"2\":\"Soybeans\",\"3\":\"0.381\",\"4\":\"0.146\",\"5\":\"0.395\",\"6\":\"0.078\",\"_rn_\":\"20\"},{\"1\":\"Sugarbeets\",\"2\":\"Soybeans\",\"3\":\"0.106\",\"4\":\"0.144\",\"5\":\"0.518\",\"6\":\"0.232\",\"_rn_\":\"21\"},{\"1\":\"Sugarbeets\",\"2\":\"Soybeans\",\"3\":\"0.088\",\"4\":\"0.207\",\"5\":\"0.489\",\"6\":\"0.216\",\"_rn_\":\"24\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n\n## Comments\n\n* These were the misclassified ones, but the posterior probability\nof being correct was not usually too low. \n\n* The correctly-classified ones are not very clear-cut either.\n\n\n\n\n## MANOVA\n\nBegan discriminant analysis as a followup to MANOVA. Do our variables\nsignificantly separate the crops?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresponse <- with(crops, cbind(x1, x2, x3, x4))\ncrops.manova <- manova(response ~ crop, data = crops)\nsummary(crops.manova)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          Df Pillai approx F num Df den Df  Pr(>F)  \ncrop       3 0.9113   2.1815     12     60 0.02416 *\nResiduals 21                                        \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Box's M test\n\nWe should also run Box's M test to check for equal variance of each variable across crops:\n\n\\small\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(BoxM(response, crops$crop))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       Box's M Test \n\nChi-Squared Value = 69.42634 , df = 30  and p-value: 5.79e-05 \n```\n:::\n:::\n\n\\normalsize\n\n- The P-value for the M test is smaller even than our guideline of 0.001. So we should not take the MANOVA seriously.\n\n- *Apparently* at least one of the crops differs (in means) from the others. So\nit is worth doing this analysis.\n\n- We did this the wrong way around, though!\n\n\n## The right way around\n\n\n* *First*, do a MANOVA to see whether any of the groups\ndiffer significantly on any of the variables.\n\n- Check that the MANOVA is believable by using Box's M test.\n\n* *If the MANOVA is significant*, do a discriminant\nanalysis in the hopes of understanding how the groups are different.\n\n* For remote-sensing data (without Clover):\n\n\n  * LD1 a fair bit more important than LD2 (definitely ignore LD3).\n\n  * LD1 depends mostly on `x1`, on which Cotton was high\nand Corn was low. \n\n\n* Discriminant analysis in MANOVA plays the same kind of role\nthat Tukey does in ANOVA.\n\n\n   \n\n\n\n",
    "supporting": [
      "discrim_files/figure-revealjs"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"discrim_files/libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"discrim_files/libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}