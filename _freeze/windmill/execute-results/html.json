{
  "hash": "9cf91f30620e00aed9d2b32994720aa9",
  "result": {
    "markdown": "---\ntitle: \"Case study: windmill\"\n---\n\n\n\n## The windmill data\n- Engineer: does amount of electricity generated by windmill depend on\nhow strongly wind blowing?\n- Measurements of wind speed and DC current generated at various\ntimes.\n- Assume the “various times” to be randomly selected — aim to\ngeneralize to “this windmill at all times”.\n- Research questions:\n  - Relationship between wind speed and current generated?\n  - If so, what kind of relationship?\n  - Can we model relationship to do predictions?\n  \n## Packages for this section\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(broom)\n```\n:::\n\n\n\n## Reading in the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \n  \"http://ritsokiguess.site/datafiles/windmill.csv\"\nwindmill <- read_csv(my_url)\nwindmill\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"wind_velocity\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"DC_output\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"5.00\",\"2\":\"1.582\"},{\"1\":\"6.00\",\"2\":\"1.822\"},{\"1\":\"3.40\",\"2\":\"1.057\"},{\"1\":\"2.70\",\"2\":\"0.500\"},{\"1\":\"10.00\",\"2\":\"2.236\"},{\"1\":\"9.70\",\"2\":\"2.386\"},{\"1\":\"9.55\",\"2\":\"2.294\"},{\"1\":\"3.05\",\"2\":\"0.558\"},{\"1\":\"8.15\",\"2\":\"2.166\"},{\"1\":\"6.20\",\"2\":\"1.866\"},{\"1\":\"2.90\",\"2\":\"0.653\"},{\"1\":\"6.35\",\"2\":\"1.930\"},{\"1\":\"4.60\",\"2\":\"1.562\"},{\"1\":\"5.80\",\"2\":\"1.737\"},{\"1\":\"7.40\",\"2\":\"2.088\"},{\"1\":\"3.60\",\"2\":\"1.137\"},{\"1\":\"7.85\",\"2\":\"2.179\"},{\"1\":\"8.80\",\"2\":\"2.112\"},{\"1\":\"7.00\",\"2\":\"1.800\"},{\"1\":\"5.45\",\"2\":\"1.501\"},{\"1\":\"9.10\",\"2\":\"2.303\"},{\"1\":\"10.20\",\"2\":\"2.310\"},{\"1\":\"4.10\",\"2\":\"1.194\"},{\"1\":\"3.95\",\"2\":\"1.144\"},{\"1\":\"2.45\",\"2\":\"0.123\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Strategy\n- Two quantitative variables, looking for relationship: regression\nmethods.\n- Start with picture (scatterplot).\n- Fit models and do model checking, fixing up things as necessary.\n- Scatterplot:\n  - 2 variables, `DC_output` and `wind_velocity`.\n  - First is output/response, other is input/explanatory.\n  - Put `DC_output` on vertical scale.\n- Add trend, but don’t want to assume linear:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(windmill, aes(y = DC_output, x = wind_velocity)) +\n  geom_point() + geom_smooth(se = F) \n```\n:::\n\n\n## Scatterplot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](windmill_files/figure-revealjs/windmill-5-1.png){width=960}\n:::\n:::\n\n\n## Comments\n- Definitely a relationship: as wind velocity increases, so does DC\noutput. (As you’d expect.)\n- Is relationship linear? To help judge, `geom_smooth` smooths\nscatterplot trend. (Trend called “loess”, “Locally weighted least\nsquares” which downweights outliers. Not constrained to be straight.)\n- Trend more or less linear for while, then curves downwards (levelling off?). Straight\nline not so good here.\n\n## Fit a straight line (and see what happens)\n\n\n\n\\scriptsize\n\n::: {.cell}\n\n```{.r .cell-code}\nDC.1 <- lm(DC_output ~ wind_velocity, data = windmill)\nsummary(DC.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = DC_output ~ wind_velocity, data = windmill)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.59869 -0.14099  0.06059  0.17262  0.32184 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    0.13088    0.12599   1.039     0.31    \nwind_velocity  0.24115    0.01905  12.659 7.55e-12 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2361 on 23 degrees of freedom\nMultiple R-squared:  0.8745,\tAdjusted R-squared:  0.869 \nF-statistic: 160.3 on 1 and 23 DF,  p-value: 7.546e-12\n```\n:::\n:::\n\n\\normalsize\n\n\n\n## Another way of looking at the output\n\n- The standard output tends to go off the bottom of the page rather easily. Package `broom` has these:\n\n\\scriptsize\n\n::: {.cell}\n\n```{.r .cell-code}\nglance(DC.1)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"r.squared\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"adj.r.squared\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sigma\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"logLik\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"AIC\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"BIC\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"deviance\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df.residual\"],\"name\":[11],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"nobs\"],\"name\":[12],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0.8744932\",\"2\":\"0.8690364\",\"3\":\"0.2360521\",\"4\":\"160.2571\",\"5\":\"7.545525e-12\",\"6\":\"1\",\"7\":\"1.66138\",\"8\":\"2.67724\",\"9\":\"6.333867\",\"10\":\"1.281573\",\"11\":\"23\",\"12\":\"25\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n\nshowing that the R-squared is 87%, and\n\n\\footnotesize\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(DC.1)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"0.1308751\",\"3\":\"0.1259894\",\"4\":\"1.038779\",\"5\":\"3.097053e-01\"},{\"1\":\"wind_velocity\",\"2\":\"0.2411489\",\"3\":\"0.0190492\",\"4\":\"12.659268\",\"5\":\"7.545525e-12\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n\nshowing the intercept and slope and their significance.\n\n## Comments\n- Strategy: `lm` actually fits the regression. Store results in a variable.\nThen look at the results, eg. via `summary` or `glance`/`tidy`. \n- My strategy for model names: base on response variable (or data frame name) and a number.\nAllows me to fit several models to same data and keep track of which\nis which.\n- Results actually pretty good: `wind.velocity` strongly significant,\nR-squared (87%) high.\n- How to check whether regression is appropriate? Look at the\nresiduals, observed minus predicted, plotted against fitted (predicted).\n- Plot using the regression object as “data frame” (in a couple of slides).\n\n## Scatterplot, but with line\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(windmill, aes(y = DC_output, x = wind_velocity)) +\n  geom_point() + geom_smooth(method=\"lm\", se = FALSE)\n```\n\n::: {.cell-output-display}\n![](windmill_files/figure-revealjs/windmill-11-1.png){width=960}\n:::\n:::\n\n\n\n## Plot of residuals against fitted values\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(DC.1, aes(y = .resid, x = .fitted)) + geom_point()\n```\n\n::: {.cell-output-display}\n![](windmill_files/figure-revealjs/windmill-13-1.png){width=960}\n:::\n:::\n\n\n## Comments on residual plot\n- Residual plot should be a random scatter of points.\n- Should be no pattern “left over” after fitting the regression.\n- Smooth trend should be more or less straight across at 0.\n- Here, have a curved trend on residual plot.\n- This means original relationship must have been a curve (as we saw\non original scatterplot).\n- Possible ways to fit a curve:\n  - Add a squared term in explanatory variable.\n  - Transform response variable (doesn’t work well here).\n  - See what science tells you about mathematical form of relationship,\nand try to apply.\n\n## Parabolas and fitting parabola model\n- A parabola has equation\n$$y = ax^2 + bx + c$$\nwith coefficients $a, b, c$. About the simplest function that is not a straight\nline.\n- Fit one using `lm` by adding $x^2$ to right side of model formula with +:\n\n::: {.cell}\n\n```{.r .cell-code}\nDC.2 <- lm(DC_output ~ wind_velocity + I(wind_velocity^2),\n  data = windmill\n)\n```\n:::\n\n\n- The `I()` necessary because `^` in model formula otherwise means\nsomething different (to do with interactions in ANOVA).\n- Call it *parabola model*.\n\n## Parabola model output\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(DC.2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"-1.15589824\",\"3\":\"0.174650028\",\"4\":\"-6.618368\",\"5\":\"1.178792e-06\"},{\"1\":\"wind_velocity\",\"2\":\"0.72293590\",\"3\":\"0.061425355\",\"4\":\"11.769340\",\"5\":\"5.766062e-11\"},{\"1\":\"I(wind_velocity^2)\",\"2\":\"-0.03812088\",\"3\":\"0.004796679\",\"4\":\"-7.947349\",\"5\":\"6.586005e-08\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\\scriptsize\n\n::: {.cell}\n\n```{.r .cell-code}\nglance(DC.2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"r.squared\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"adj.r.squared\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sigma\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"logLik\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"AIC\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"BIC\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"deviance\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df.residual\"],\"name\":[11],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"nobs\"],\"name\":[12],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0.9675771\",\"2\":\"0.9646295\",\"3\":\"0.1226741\",\"4\":\"328.266\",\"5\":\"4.162707e-17\",\"6\":\"2\",\"7\":\"18.58005\",\"8\":\"-29.1601\",\"9\":\"-24.2846\",\"10\":\"0.3310767\",\"11\":\"22\",\"12\":\"25\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n\n## Comments on output\n\n\n- R-squared has gone up a lot, from 87% (line) to 97% (parabola).\n- Coefficient of squared term strongly significant (P-value $6.59 \\times 10^{−8}$).\n- Adding squared term has definitely improved fit of model.\n- Parabola model better than linear one.\n- But...need to check residuals again.\n\n## Residual plot from parabola model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(DC.2, aes(y = .resid, x = .fitted)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](windmill_files/figure-revealjs/windmill-18-1.png){width=960}\n:::\n:::\n\n\n## Make scatterplot with fitted line and curve \n\n- Residual plot basically random. Good.\n- Scatterplot with fitted line and curve like this:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(windmill, aes(y = DC_output, x = wind_velocity)) +\n  geom_point() + geom_smooth(method = \"lm\", se = F) +\n  geom_line(data = DC.2, aes(y = .fitted))\n```\n:::\n\n\n## Comments\n\n- This plots: \n  - scatterplot (`geom_point`); \n  - straight line (via tweak to\n`geom_smooth`, which draws best-fitting line); \n  - fitted curve, using the\npredicted `DC_output` values, joined by lines (with points not shown).\n- Trick in the `geom_line` is use the predictions as the `y`-points to join\nby lines (from `DC.2`), instead of the original data points. Without the\n`data` and `aes` in the `geom_line`, original data points would be joined\nby lines.\n\n## Scatterplot with fitted line and curve\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](windmill_files/figure-revealjs/windmill-19-1.png){width=960}\n:::\n:::\n\n\nCurve clearly fits better than line. \n\n\n## Another approach to a curve\n- There is a problem with parabolas, which we’ll see later.\n- Ask engineer,  “what should happen\nas wind velocity increases?”:\n\n    - Upper limit on electricity generated, but otherwise, the larger the\n       wind velocity, the more electricity generated.\n\n- Mathematically, *asymptote*. Straight lines and parabolas\ndon’t have them, but eg. $y = 1/x$ does: as $x$ gets bigger, $y$\napproaches zero without reaching it.\n- What happens to $y = a + b(1/x)$ as $x$ gets large?\n  - $y$ gets closer and closer to $a$: that is, $a$ is asymptote.\n- Fit this, call it asymptote model.\n- Fitting the model here because we have math to justify it.\n  - Alternative, $y = a + be^{−x}$ , approaches asymptote faster.\n\n## How to fit asymptote model?\n- Define new explanatory variable to be $1/x$,\nand predict $y$ from it.\n- $x$ is velocity, distance over time.\n- So $1/x$ is time over distance. In walking world, if you walk 5 km/h,\ntake 12 minutes to walk 1 km, called your pace. So 1 over\n`wind_velocity` we call `wind_pace`.\n- Make a scatterplot first to check for straightness (next page).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwindmill %>% mutate(wind_pace = 1 / wind_velocity) -> windmill\nggplot(windmill, aes(y = DC_output, x = wind_pace)) +\n  geom_point() + geom_smooth(se = F)\n```\n:::\n\n\n- and run regression like this (output page after):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nDC.3 <- lm(DC_output ~ wind_pace, data = windmill)\n```\n:::\n\n\n## Scatterplot for wind_pace\n\nPretty straight. Blue actually smooth curve not line:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](windmill_files/figure-revealjs/windmill-20-1.png){width=960}\n:::\n:::\n\n\n\n\n\n## Regression output\n\n\\scriptsize\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglance(DC.3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"r.squared\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"adj.r.squared\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sigma\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"logLik\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"AIC\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"BIC\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"deviance\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df.residual\"],\"name\":[11],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"nobs\"],\"name\":[12],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0.9800249\",\"2\":\"0.9791564\",\"3\":\"0.09417136\",\"4\":\"1128.433\",\"5\":\"4.742548e-21\",\"6\":\"1\",\"7\":\"24.63479\",\"8\":\"-43.26957\",\"9\":\"-39.61294\",\"10\":\"0.2039696\",\"11\":\"23\",\"12\":\"25\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\\normalsize\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(DC.3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"2.978860\",\"3\":\"0.04490227\",\"4\":\"66.34096\",\"5\":\"8.917745e-28\"},{\"1\":\"wind_pace\",\"2\":\"-6.934547\",\"3\":\"0.20643355\",\"4\":\"-33.59215\",\"5\":\"4.742548e-21\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Comments\n- R-squared, 98%, even higher than for parabola model (97%).\n- Simpler model, only one explanatory variable (`wind.pace`) vs. 2 for\nparabola model (`wind.velocity` and its square).\n- `wind.pace` (unsurprisingly) strongly significant.\n- Looks good, but check residual plot (over). \n\n\n## Residual plot for asymptote model\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(DC.3, aes(y = .resid, x = .fitted)) + geom_point()\n```\n\n::: {.cell-output-display}\n![](windmill_files/figure-revealjs/resida-1.png){width=960}\n:::\n:::\n\n\n\n## Plotting trends on scatterplot\n- Residual plot not bad. But residuals go up to 0.10 and down to\n−0.20, suggesting possible skewness (not normal). I think it’s not\nperfect, but OK overall.\n- Next: plot scatterplot with all three fitted lines/curves on it (for\ncomparison), with legend saying which is which.\n- First make data frame containing what we need, taken from the right\nplaces:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nw2 <- tibble(\n  wind_velocity = windmill$wind_velocity,\n  DC_output = windmill$DC_output,\n  linear = fitted(DC.1),\n  parabola = fitted(DC.2),\n  asymptote = fitted(DC.3)\n)\n```\n:::\n\n\n## What’s in `w2`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nw2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"wind_velocity\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"DC_output\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"linear\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"parabola\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"asymptote\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"5.00\",\"2\":\"1.582\",\"3\":\"1.3366195\",\"4\":\"1.5057592\",\"5\":\"1.5919507\"},{\"1\":\"6.00\",\"2\":\"1.822\",\"3\":\"1.5777683\",\"4\":\"1.8093653\",\"5\":\"1.8231023\"},{\"1\":\"3.40\",\"2\":\"1.057\",\"3\":\"0.9507813\",\"4\":\"0.8614064\",\"5\":\"0.9392874\"},{\"1\":\"2.70\",\"2\":\"0.500\",\"3\":\"0.7819771\",\"4\":\"0.5181275\",\"5\":\"0.4105093\"},{\"1\":\"10.00\",\"2\":\"2.236\",\"3\":\"2.5423638\",\"4\":\"2.2613723\",\"5\":\"2.2854054\"},{\"1\":\"9.70\",\"2\":\"2.386\",\"3\":\"2.4700192\",\"4\":\"2.2697860\",\"5\":\"2.2639584\"},{\"1\":\"9.55\",\"2\":\"2.294\",\"3\":\"2.4338468\",\"4\":\"2.2714197\",\"5\":\"2.2527296\"},{\"1\":\"3.05\",\"2\":\"0.558\",\"3\":\"0.8663792\",\"4\":\"0.6944367\",\"5\":\"0.7052381\"},{\"1\":\"8.15\",\"2\":\"2.166\",\"3\":\"2.0962384\",\"4\":\"2.2039449\",\"5\":\"2.1279955\"},{\"1\":\"6.20\",\"2\":\"1.866\",\"3\":\"1.6259981\",\"4\":\"1.8609376\",\"5\":\"1.8603848\"},{\"1\":\"2.90\",\"2\":\"0.653\",\"3\":\"0.8302069\",\"4\":\"0.6200192\",\"5\":\"0.5876369\"},{\"1\":\"6.35\",\"2\":\"1.930\",\"3\":\"1.6621705\",\"4\":\"1.8976154\",\"5\":\"1.8868055\"},{\"1\":\"4.60\",\"2\":\"1.562\",\"3\":\"1.2401599\",\"4\":\"1.3629690\",\"5\":\"1.4713499\"},{\"1\":\"5.80\",\"2\":\"1.737\",\"3\":\"1.5295386\",\"4\":\"1.7547434\",\"5\":\"1.7832486\"},{\"1\":\"7.40\",\"2\":\"2.088\",\"3\":\"1.9153768\",\"4\":\"2.1063278\",\"5\":\"2.0417592\"},{\"1\":\"3.60\",\"2\":\"1.137\",\"3\":\"0.9990111\",\"4\":\"0.9526244\",\"5\":\"1.0525970\"},{\"1\":\"7.85\",\"2\":\"2.179\",\"3\":\"2.0238938\",\"4\":\"2.1700444\",\"5\":\"2.0954783\"},{\"1\":\"8.80\",\"2\":\"2.112\",\"3\":\"2.2529852\",\"4\":\"2.2538564\",\"5\":\"2.1908434\"},{\"1\":\"7.00\",\"2\":\"1.800\",\"3\":\"1.8189172\",\"4\":\"2.0367297\",\"5\":\"1.9882106\"},{\"1\":\"5.45\",\"2\":\"1.501\",\"3\":\"1.4451365\",\"4\":\"1.6518169\",\"5\":\"1.7064662\"},{\"1\":\"9.10\",\"2\":\"2.303\",\"3\":\"2.3253298\",\"4\":\"2.2660280\",\"5\":\"2.2168220\"},{\"1\":\"10.20\",\"2\":\"2.310\",\"3\":\"2.5905936\",\"4\":\"2.2519512\",\"5\":\"2.2990026\"},{\"1\":\"4.10\",\"2\":\"1.194\",\"3\":\"1.1195855\",\"4\":\"1.1673269\",\"5\":\"1.2875072\"},{\"1\":\"3.95\",\"2\":\"1.144\",\"3\":\"1.0834132\",\"4\":\"1.1049175\",\"5\":\"1.2232786\"},{\"1\":\"2.45\",\"2\":\"0.123\",\"3\":\"0.7216899\",\"4\":\"0.3864741\",\"5\":\"0.1484327\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Making the plot\n- `ggplot` likes to have one column of $x$’s to plot, and one column of\n$y$’s, with another column for distinguishing things.\n- But we have three columns of fitted values, that need to be combined\ninto one.\n- `pivot_longer`, then plot:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nw2 %>%\n  pivot_longer(linear:asymptote, names_to=\"model\", \n               values_to=\"fit\") %>%\n  ggplot(aes(x = wind_velocity, y = DC_output)) +\n  geom_point() +\n  geom_line(aes(y = fit, colour = model)) \n```\n:::\n\n\n## Scatterplot with fitted curves\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](windmill_files/figure-revealjs/windmill-25-1.png){width=960}\n:::\n:::\n\n\n## Comments\n- Predictions from curves are very similar.\n- Predictions from asymptote model as good, and from simpler model\n(one $x$ not two), so prefer those.\n- Go back to asymptote model summary.\n\n## Asymptote model summary\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(DC.3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"2.978860\",\"3\":\"0.04490227\",\"4\":\"66.34096\",\"5\":\"8.917745e-28\"},{\"1\":\"wind_pace\",\"2\":\"-6.934547\",\"3\":\"0.20643355\",\"4\":\"-33.59215\",\"5\":\"4.742548e-21\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Comments\n- Intercept in this model about 3.\n- Intercept of asymptote model is the asymptote (upper limit of\n`DC.output`).\n- Not close to asymptote yet.\n- Therefore, from this model, wind could get stronger and would\ngenerate appreciably more electricity.\n- This is extrapolation! Would like more data from times when\n`wind.velocity` higher.\n- Slope −7. Why negative?\n  - As wind.velocity increases, wind.pace goes down, and DC.output goes up. Check.\n- Actual slope number hard to interpret.\n\n## Checking back in with research questions\n- Is there a relationship between wind speed and current generated?\n  - Yes.\n- If so, what kind of relationship is it?\n  - One with an asymptote.\n- Can we model the relationship, in such a way that we can do\npredictions?\n  - Yes, see model DC.3 and plot of fitted curve.\n- Good. Job done.\n\n## Job done, kinda\n- Just because the parabola model and asymptote model agree over the\nrange of the data, doesn’t necessarily mean they agree everywhere.\n- Extend range of wind.velocity to 1 to 16 (steps of 0.5), and\npredict DC.output according to the two models:\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwv <- seq(1, 16, 0.5)\nwv\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1]  1.0  1.5  2.0  2.5  3.0  3.5  4.0  4.5  5.0  5.5  6.0  6.5  7.0\n[14]  7.5  8.0  8.5  9.0  9.5 10.0 10.5 11.0 11.5 12.0 12.5 13.0 13.5\n[27] 14.0 14.5 15.0 15.5 16.0\n```\n:::\n:::\n\n\n- R has `predict`, which requires what to predict for, as data frame.\nThe data frame has to contain values, with matching names, for all\nexplanatory variables in regression(s).\n\n## Setting up data frame to predict from\n\n- Linear model had just `wind_velocity`.\n- Parabola model had that as well (squared one will be calculated)\n- Asymptote model had just `wind_pace` (reciprocal of velocity).\n- So create data frame called `wv_new` with those in:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwv_new <- tibble(wind_velocity = wv, wind_pace = 1 / wv)\n```\n:::\n\n\n## `wv_new`\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwv_new\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"wind_velocity\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"wind_pace\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1.0\",\"2\":\"1.00000000\"},{\"1\":\"1.5\",\"2\":\"0.66666667\"},{\"1\":\"2.0\",\"2\":\"0.50000000\"},{\"1\":\"2.5\",\"2\":\"0.40000000\"},{\"1\":\"3.0\",\"2\":\"0.33333333\"},{\"1\":\"3.5\",\"2\":\"0.28571429\"},{\"1\":\"4.0\",\"2\":\"0.25000000\"},{\"1\":\"4.5\",\"2\":\"0.22222222\"},{\"1\":\"5.0\",\"2\":\"0.20000000\"},{\"1\":\"5.5\",\"2\":\"0.18181818\"},{\"1\":\"6.0\",\"2\":\"0.16666667\"},{\"1\":\"6.5\",\"2\":\"0.15384615\"},{\"1\":\"7.0\",\"2\":\"0.14285714\"},{\"1\":\"7.5\",\"2\":\"0.13333333\"},{\"1\":\"8.0\",\"2\":\"0.12500000\"},{\"1\":\"8.5\",\"2\":\"0.11764706\"},{\"1\":\"9.0\",\"2\":\"0.11111111\"},{\"1\":\"9.5\",\"2\":\"0.10526316\"},{\"1\":\"10.0\",\"2\":\"0.10000000\"},{\"1\":\"10.5\",\"2\":\"0.09523810\"},{\"1\":\"11.0\",\"2\":\"0.09090909\"},{\"1\":\"11.5\",\"2\":\"0.08695652\"},{\"1\":\"12.0\",\"2\":\"0.08333333\"},{\"1\":\"12.5\",\"2\":\"0.08000000\"},{\"1\":\"13.0\",\"2\":\"0.07692308\"},{\"1\":\"13.5\",\"2\":\"0.07407407\"},{\"1\":\"14.0\",\"2\":\"0.07142857\"},{\"1\":\"14.5\",\"2\":\"0.06896552\"},{\"1\":\"15.0\",\"2\":\"0.06666667\"},{\"1\":\"15.5\",\"2\":\"0.06451613\"},{\"1\":\"16.0\",\"2\":\"0.06250000\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Doing predictions, one for each model\n- Use same names as before:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlinear <- predict(DC.1, wv_new)\nparabola <- predict(DC.2, wv_new)\nasymptote <- predict(DC.3, wv_new)\n```\n:::\n\n- Put it all into a data frame for plotting, along with original data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_fits <- tibble(\n  wind_velocity = wv_new$wind_velocity,\n  linear, parabola, asymptote\n)\n```\n:::\n\n\n## `my_fits`\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_fits\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"wind_velocity\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"linear\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"parabola\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"asymptote\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1.0\",\"2\":\"0.3720240\",\"3\":\"-0.4710832\",\"4\":\"-3.9556872\"},{\"1\":\"1.5\",\"2\":\"0.4925984\",\"3\":\"-0.1572664\",\"4\":\"-1.6441714\"},{\"1\":\"2.0\",\"2\":\"0.6131729\",\"3\":\"0.1374900\",\"4\":\"-0.4884135\"},{\"1\":\"2.5\",\"2\":\"0.7337473\",\"3\":\"0.4131860\",\"4\":\"0.2050412\"},{\"1\":\"3.0\",\"2\":\"0.8543217\",\"3\":\"0.6698215\",\"4\":\"0.6673444\"},{\"1\":\"3.5\",\"2\":\"0.9748962\",\"3\":\"0.9073966\",\"4\":\"0.9975609\"},{\"1\":\"4.0\",\"2\":\"1.0954706\",\"3\":\"1.1259112\",\"4\":\"1.2452233\"},{\"1\":\"4.5\",\"2\":\"1.2160450\",\"3\":\"1.3253654\",\"4\":\"1.4378497\"},{\"1\":\"5.0\",\"2\":\"1.3366195\",\"3\":\"1.5057592\",\"4\":\"1.5919507\"},{\"1\":\"5.5\",\"2\":\"1.4571939\",\"3\":\"1.6670925\",\"4\":\"1.7180334\"},{\"1\":\"6.0\",\"2\":\"1.5777683\",\"3\":\"1.8093653\",\"4\":\"1.8231023\"},{\"1\":\"6.5\",\"2\":\"1.6983428\",\"3\":\"1.9325778\",\"4\":\"1.9120067\"},{\"1\":\"7.0\",\"2\":\"1.8189172\",\"3\":\"2.0367297\",\"4\":\"1.9882106\"},{\"1\":\"7.5\",\"2\":\"1.9394917\",\"3\":\"2.1218213\",\"4\":\"2.0542539\"},{\"1\":\"8.0\",\"2\":\"2.0600661\",\"3\":\"2.1878524\",\"4\":\"2.1120418\"},{\"1\":\"8.5\",\"2\":\"2.1806405\",\"3\":\"2.2348230\",\"4\":\"2.1630311\"},{\"1\":\"9.0\",\"2\":\"2.3012150\",\"3\":\"2.2627333\",\"4\":\"2.2083549\"},{\"1\":\"9.5\",\"2\":\"2.4217894\",\"3\":\"2.2715830\",\"4\":\"2.2489078\"},{\"1\":\"10.0\",\"2\":\"2.5423638\",\"3\":\"2.2613723\",\"4\":\"2.2854054\"},{\"1\":\"10.5\",\"2\":\"2.6629383\",\"3\":\"2.2321012\",\"4\":\"2.3184271\"},{\"1\":\"11.0\",\"2\":\"2.7835127\",\"3\":\"2.1837697\",\"4\":\"2.3484468\"},{\"1\":\"11.5\",\"2\":\"2.9040871\",\"3\":\"2.1163777\",\"4\":\"2.3758561\"},{\"1\":\"12.0\",\"2\":\"3.0246616\",\"3\":\"2.0299252\",\"4\":\"2.4009812\"},{\"1\":\"12.5\",\"2\":\"3.1452360\",\"3\":\"1.9244124\",\"4\":\"2.4240964\"},{\"1\":\"13.0\",\"2\":\"3.2658104\",\"3\":\"1.7998390\",\"4\":\"2.4454335\"},{\"1\":\"13.5\",\"2\":\"3.3863849\",\"3\":\"1.6562053\",\"4\":\"2.4651900\"},{\"1\":\"14.0\",\"2\":\"3.5069593\",\"3\":\"1.4935111\",\"4\":\"2.4835354\"},{\"1\":\"14.5\",\"2\":\"3.6275337\",\"3\":\"1.3117564\",\"4\":\"2.5006155\"},{\"1\":\"15.0\",\"2\":\"3.7481082\",\"3\":\"1.1109413\",\"4\":\"2.5165570\"},{\"1\":\"15.5\",\"2\":\"3.8686826\",\"3\":\"0.8910658\",\"4\":\"2.5314700\"},{\"1\":\"16.0\",\"2\":\"3.9892570\",\"3\":\"0.6521298\",\"4\":\"2.5454510\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n## Making a plot 1/2\n\n- To make a plot, we use the same trick as last time to get all three\npredictions on a plot with a legend (saving result to add to later):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_fits %>%\n    pivot_longer(\n    linear:asymptote,\n    names_to=\"model\", \n    values_to=\"fit\"\n  ) %>%\n  ggplot(aes(\n    y = fit, x = wind_velocity,\n    colour = model\n  )) + geom_line() -> g\n```\n:::\n\n\n## Making a plot 2/2\n\n- The observed wind velocities were in this range:\n\n::: {.cell}\n\n```{.r .cell-code}\n(vels <- range(windmill$wind_velocity))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1]  2.45 10.20\n```\n:::\n:::\n\n\n- `DC.output` between 0 and 3 from asymptote model. Add rectangle to\ngraph around where the data were:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng + geom_rect(\n  xmin = vels[1], xmax = vels[2], ymin = 0, ymax = 3,\n  alpha=0, colour = \"black\"\n)\n```\n:::\n\n\n## The plot\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](windmill_files/figure-revealjs/windmill-35-1.png){width=960}\n:::\n:::\n\n\n## Comments (1)\n- Over range of data, two models agree with each other well.\n- Outside range of data, they disagree violently!\n- For larger `wind.velocity`, asymptote model behaves reasonably,\nparabola model does not.\n- What happens as `wind.velocity` goes to zero? Should find\n`DC.output` goes to zero as well. Does it?\n\n## Comments (2)\n\n- For parabola model:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(DC.2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"-1.15589824\",\"3\":\"0.174650028\",\"4\":\"-6.618368\",\"5\":\"1.178792e-06\"},{\"1\":\"wind_velocity\",\"2\":\"0.72293590\",\"3\":\"0.061425355\",\"4\":\"11.769340\",\"5\":\"5.766062e-11\"},{\"1\":\"I(wind_velocity^2)\",\"2\":\"-0.03812088\",\"3\":\"0.004796679\",\"4\":\"-7.947349\",\"5\":\"6.586005e-08\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n- Nope, goes to −1.16 (intercept), actually significantly different from\nzero.\n\n## Comments (3): asymptote model\n\n\\small\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(DC.3)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"2.978860\",\"3\":\"0.04490227\",\"4\":\"66.34096\",\"5\":\"8.917745e-28\"},{\"1\":\"wind_pace\",\"2\":\"-6.934547\",\"3\":\"0.20643355\",\"4\":\"-33.59215\",\"5\":\"4.742548e-21\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n\n- As `wind.velocity` heads to 0, wind.pace heads to $+\\infty$, so\nDC.output heads to $−\\infty$! \n- Also need more data for small `wind.velocity` to understand\nrelationship. (Is there a lower asymptote?)\n- Best we can do now is to predict `DC.output` to be zero for small\n`wind.velocity`.\n- Assumes a “threshold” wind velocity below which no electricity\ngenerated at all.\n\n## Summary\n- Often, in data analysis, there is no completely satisfactory conclusion,\nas here.\n- Have to settle for model that works OK, with restrictions.\n- Always something else you can try.\n- At some point you have to say “I stop.”\n\n\n\n",
    "supporting": [
      "windmill_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"windmill_files/libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"windmill_files/libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}