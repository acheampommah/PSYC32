{
  "hash": "d00d4260f0342837f54c858773a0870d",
  "result": {
    "markdown": "---\ntitle: \"Logistic Regression\"\n---\n\n\n\n## Logistic regression\n\n\n* When response variable is measured/counted, regression can work well.\n\n* But what if response is yes/no, lived/died, success/failure?\n\n* Model *probability* of success.\n\n* Probability must be between 0 and 1; need method that ensures this.\n\n* *Logistic regression* does this. In R, is a\n*generalized linear model* with binomial \"family\": \n\n::: {.cell}\n\n```{.r .cell-code}\nglm(y ~ x, family=\"binomial\")\n```\n:::\n\n\n\n* Begin with simplest case.\n\n\n\n## Packages\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MASS)\nlibrary(tidyverse)\nlibrary(marginaleffects)\nlibrary(broom)\nlibrary(nnet)\nlibrary(conflicted)\nconflict_prefer(\"select\", \"dplyr\")\nconflict_prefer(\"filter\", \"dplyr\")\nconflict_prefer(\"rename\", \"dplyr\")\nconflict_prefer(\"summarize\", \"dplyr\")\n```\n:::\n\n\n   \n\n\n## The rats, part 1\n\n\n* Rats given dose of some poison; either live or die:\n\n\\small\n```\ndose status\n0 lived\n1 died\n2 lived\n3 lived\n4 died\n5 died\n```\n\n\\normalsize\n\n## Read in: \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/rat.txt\"\nrats <- read_delim(my_url, \" \")\nrats\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"dose\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"status\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"0\",\"2\":\"lived\"},{\"1\":\"1\",\"2\":\"died\"},{\"1\":\"2\",\"2\":\"lived\"},{\"1\":\"3\",\"2\":\"lived\"},{\"1\":\"4\",\"2\":\"died\"},{\"1\":\"5\",\"2\":\"died\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n \n\n\n## Basic logistic regression\n\n\n* Make response into a factor first:\n\n\\small\n\n::: {.cell}\n\n```{.r .cell-code}\nrats2 <- rats %>% mutate(status = factor(status))\n```\n:::\n\n\\normalsize\n   \n\n\n* then fit model:\n\n\\small\n\n::: {.cell}\n\n```{.r .cell-code}\nstatus.1 <- glm(status ~ dose, family = \"binomial\", data = rats2)\n```\n:::\n\n\\normalsize\n   \n\n   \n\n\n## Output\n\n\\scriptsize\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(status.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = status ~ dose, family = \"binomial\", data = rats2)\n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)\n(Intercept)   1.6841     1.7979   0.937    0.349\ndose         -0.6736     0.6140  -1.097    0.273\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 8.3178  on 5  degrees of freedom\nResidual deviance: 6.7728  on 4  degrees of freedom\nAIC: 10.773\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n:::\n\n\\normalsize\n\n\n## Interpreting the output\n\n\n* Like (multiple) regression, get\ntests of significance of individual $x$'s\n\n* Here not significant (only 6 observations).\n\n* \"Slope\" for dose is negative, meaning that as dose increases, probability of event modelled (survival) decreases.\n\n\n\n\n\n## Output part 2: predicted survival probs\n\n\\small\n\n::: {.cell}\n\n```{.r .cell-code}\ncbind(predictions(status.1)) %>% \n  select(dose, estimate)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"dose\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0\",\"2\":\"0.8434490\"},{\"1\":\"1\",\"2\":\"0.7331122\"},{\"1\":\"2\",\"2\":\"0.5834187\"},{\"1\":\"3\",\"2\":\"0.4165813\"},{\"1\":\"4\",\"2\":\"0.2668878\"},{\"1\":\"5\",\"2\":\"0.1565510\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize \n\n## On a graph\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_cap(status.1, condition = \"dose\")\n```\n\n::: {.cell-output-display}\n![](logistic_files/figure-revealjs/unnamed-chunk-1-1.png){width=960}\n:::\n:::\n\n\n\n## The rats, more\n\n\n* More realistic: more rats at each dose (say 10).\n\n* Listing each rat on one line makes a big data file.\n\n* Use format below: dose, number of survivals, number of deaths.\n\n```\n\ndose lived died\n0    10    0\n1     7    3 \n2     6    4 \n3     4    6 \n4     2    8 \n5     1    9  \n\n```\n\n\n* 6 lines of data correspond to 60 actual rats.\n\n* Saved in `rat2.txt`.\n\n\n\n## These data\n\n\\footnotesize\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/rat2.txt\"\nrat2 <- read_delim(my_url, \" \")\nrat2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"dose\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"lived\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"died\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0\",\"2\":\"10\",\"3\":\"0\"},{\"1\":\"1\",\"2\":\"7\",\"3\":\"3\"},{\"1\":\"2\",\"2\":\"6\",\"3\":\"4\"},{\"1\":\"3\",\"2\":\"4\",\"3\":\"6\"},{\"1\":\"4\",\"2\":\"2\",\"3\":\"8\"},{\"1\":\"5\",\"2\":\"1\",\"3\":\"9\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n\n\n## Create response matrix:\n\n- Each row contains *multiple* observations.\n- Create *two-column* response:\n  - \\#survivals in first column, \n  - \\#deaths in second.\n\n\n\\footnotesize\n\n::: {.cell}\n\n```{.r .cell-code}\nresponse <- with(rat2, cbind(lived, died))\nresponse\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     lived died\n[1,]    10    0\n[2,]     7    3\n[3,]     6    4\n[4,]     4    6\n[5,]     2    8\n[6,]     1    9\n```\n:::\n:::\n\n\\normalsize\n\n- Response is R `matrix`:\n\n\\scriptsize\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(response)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"matrix\" \"array\" \n```\n:::\n:::\n\n\\normalsize\n\n     \n## Fit logistic regression\n\n- using response you just made:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrat2.1 <- glm(response ~ dose,\n  family = \"binomial\",\n  data = rat2\n)\n```\n:::\n\n\n\n\n\n## Output\n\n\\scriptsize\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(rat2.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = response ~ dose, family = \"binomial\", data = rat2)\n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)   2.3619     0.6719   3.515 0.000439 ***\ndose         -0.9448     0.2351  -4.018 5.87e-05 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 27.530  on 5  degrees of freedom\nResidual deviance:  2.474  on 4  degrees of freedom\nAIC: 18.94\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n:::\n\n\\normalsize\n\n\n## Predicted survival probs\n\n::: {.cell}\n\n```{.r .cell-code}\nnew <- datagrid(model = rat2.1, dose = 0:5)\ncbind(predictions(rat2.1, newdata = new))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"rowid\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.low\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.high\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"dose\"],\"name\":[6],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"0.9138762\",\"3\":\"0.0004389651\",\"4\":\"0.73983042\",\"5\":\"0.9753671\",\"6\":\"0\"},{\"1\":\"2\",\"2\":\"0.8048905\",\"3\":\"0.0031438277\",\"4\":\"0.61695841\",\"5\":\"0.9135390\",\"6\":\"1\"},{\"1\":\"3\",\"2\":\"0.6159474\",\"3\":\"0.1721141940\",\"4\":\"0.44876099\",\"5\":\"0.7595916\",\"6\":\"2\"},{\"1\":\"4\",\"2\":\"0.3840526\",\"3\":\"0.1721142921\",\"4\":\"0.24040837\",\"5\":\"0.5512390\",\"6\":\"3\"},{\"1\":\"5\",\"2\":\"0.1951095\",\"3\":\"0.0031438384\",\"4\":\"0.08646093\",\"5\":\"0.3830417\",\"6\":\"4\"},{\"1\":\"6\",\"2\":\"0.0861238\",\"3\":\"0.0004389668\",\"4\":\"0.02463288\",\"5\":\"0.2601697\",\"6\":\"5\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n \n\n## On a picture\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncbind(predictions(rat2.1, newdata = new)) %>% \n  select(estimate, conf.low, conf.high, dose) %>% \n  ggplot(aes(x = dose, y = estimate, \n             ymin = conf.low, ymax = conf.high)) + \n    geom_line() + geom_ribbon(alpha = 0.3)\n```\n\n::: {.cell-output-display}\n![](logistic_files/figure-revealjs/unnamed-chunk-2-1.png){width=960}\n:::\n:::\n\n\n\n## Comments\n\n\n\n* Significant effect of dose. \n\n* Effect of larger dose is to *decrease* survival probability\n(\"slope\" negative; also see in decreasing predictions.)\n\n* Confidence intervals around prediction narrower (more data).\n\n## Multiple logistic regression\n\n\n* With more than one $x$, works much like multiple regression.\n\n* Example: study of patients with blood poisoning severe enough to warrant surgery. Relate survival to other potential risk factors.\n\n* Variables, 1=present, 0=absent:\n\n\n  * survival (death from sepsis=1), response\n  * shock\n  * malnutrition\n  * alcoholism\n  * age (as numerical variable)\n  * bowel infarction\n\n\n* See what relates to death.\n\n\n\n## Read in data\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \n  \"http://ritsokiguess.site/datafiles/sepsis.txt\"\nsepsis <- read_delim(my_url, \" \")\n```\n:::\n\n \n## Make sure categoricals really are\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsepsis %>% \n  mutate(across(-age, \\(x) factor(x))) -> sepsis\n```\n:::\n\n\n\n## The data (some)\n\n::: {.cell}\n\n```{.r .cell-code}\nsepsis\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"death\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"shock\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"malnut\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"alcohol\"],\"name\":[4],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"age\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"bowelinf\"],\"name\":[6],\"type\":[\"fct\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"56\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"80\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"61\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"26\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"53\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"87\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"21\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"69\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"57\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"76\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"66\",\"6\":\"1\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"48\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"18\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"46\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"22\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"33\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"38\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"27\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"1\",\"4\":\"0\",\"5\":\"60\",\"6\":\"1\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"31\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"59\",\"6\":\"1\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"29\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\",\"5\":\"60\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\",\"5\":\"63\",\"6\":\"1\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"80\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"23\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"71\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"87\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"1\",\"4\":\"0\",\"5\":\"70\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"22\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"17\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"49\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\",\"5\":\"50\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"51\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"1\",\"5\":\"37\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"76\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"60\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"0\",\"4\":\"0\",\"5\":\"78\",\"6\":\"1\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"1\",\"5\":\"60\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"1\",\"4\":\"0\",\"5\":\"57\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"28\",\"6\":\"1\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"94\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"43\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"70\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"70\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"26\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"19\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"80\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"66\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"55\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"36\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"28\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"59\",\"6\":\"1\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"50\",\"6\":\"1\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"20\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"74\",\"6\":\"1\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"54\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"68\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"25\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"27\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"77\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"54\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"43\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"27\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"1\",\"4\":\"1\",\"5\":\"66\",\"6\":\"1\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"1\",\"5\":\"47\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"37\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"36\",\"6\":\"1\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"1\",\"4\":\"0\",\"5\":\"76\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"33\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"40\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"90\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"45\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"75\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"70\",\"6\":\"1\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"36\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"57\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"22\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"33\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"75\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"22\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"80\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"85\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"90\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"71\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"51\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"1\",\"4\":\"1\",\"5\":\"67\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"0\",\"5\":\"77\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"20\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"52\",\"6\":\"1\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"0\",\"4\":\"1\",\"5\":\"60\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"29\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"30\",\"6\":\"1\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"20\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"36\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"1\",\"5\":\"54\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"65\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"47\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"22\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"69\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"1\",\"4\":\"1\",\"5\":\"68\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"1\",\"5\":\"49\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"25\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"1\",\"3\":\"1\",\"4\":\"0\",\"5\":\"44\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"56\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"1\",\"4\":\"1\",\"5\":\"42\",\"6\":\"0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n   \n\n\n## Fit model\n\n::: {.cell}\n\n```{.r .cell-code}\nsepsis.1 <- glm(death ~ shock + malnut + alcohol + age +\n  bowelinf,\nfamily = \"binomial\",\ndata = sepsis\n)\n```\n:::\n\n\n   \n\n\n## Output part 1\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(sepsis.1)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"-9.75390560\",\"3\":\"2.54169523\",\"4\":\"-3.837559\",\"5\":\"0.0001242633\"},{\"1\":\"shock1\",\"2\":\"3.67386585\",\"3\":\"1.16481138\",\"4\":\"3.154044\",\"5\":\"0.0016102504\"},{\"1\":\"malnut1\",\"2\":\"1.21658106\",\"3\":\"0.72822359\",\"4\":\"1.670615\",\"5\":\"0.0947978002\"},{\"1\":\"alcohol1\",\"2\":\"3.35488462\",\"3\":\"0.98210260\",\"4\":\"3.416023\",\"5\":\"0.0006354299\"},{\"1\":\"age\",\"2\":\"0.09215268\",\"3\":\"0.03032368\",\"4\":\"3.038968\",\"5\":\"0.0023739015\"},{\"1\":\"bowelinf1\",\"2\":\"2.79758637\",\"3\":\"1.16397170\",\"4\":\"2.403483\",\"5\":\"0.0162397151\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n \n\n\n\n* All P-values fairly small\n\n* but `malnut` not significant: remove.\n\n\n\n## Removing `malnut`\n\n::: {.cell}\n\n```{.r .cell-code}\nsepsis.2 <- update(sepsis.1, . ~ . - malnut)\ntidy(sepsis.2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"-8.89458992\",\"3\":\"2.31689479\",\"4\":\"-3.839013\",\"5\":\"0.0001235297\"},{\"1\":\"shock1\",\"2\":\"3.70119321\",\"3\":\"1.10353465\",\"4\":\"3.353944\",\"5\":\"0.0007966854\"},{\"1\":\"alcohol1\",\"2\":\"3.18590397\",\"3\":\"0.91724569\",\"4\":\"3.473338\",\"5\":\"0.0005140283\"},{\"1\":\"age\",\"2\":\"0.08983175\",\"3\":\"0.02921528\",\"4\":\"3.074821\",\"5\":\"0.0021062897\"},{\"1\":\"bowelinf1\",\"2\":\"2.38646847\",\"3\":\"1.07226618\",\"4\":\"2.225631\",\"5\":\"0.0260389310\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n \n\n\n\n* Everything significant now.\n\n\n\n## Comments\n\n\n* Most of the original $x$'s helped predict death. Only `malnut` seemed not to add anything.\n\n* Removed `malnut` and tried again.\n\n* Everything remaining is significant (though `bowelinf`\nactually became *less* significant).\n\n* All coefficients are *positive*, so having any of the risk\nfactors (or being older)\n*increases* risk of death.  \n\n\n## Predictions from model without \"malnut\"\n\n\n* A few (rows of original dataframe) chosen \"at random\":\n\n\\tiny\n\n::: {.cell}\n\n```{.r .cell-code}\nsepsis %>% slice(c(4, 1, 2, 11, 32)) -> new\nnew\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"death\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"shock\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"malnut\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"alcohol\"],\"name\":[4],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"age\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"bowelinf\"],\"name\":[6],\"type\":[\"fct\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"26\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"56\",\"6\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"80\",\"6\":\"0\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"66\",\"6\":\"1\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"0\",\"4\":\"1\",\"5\":\"49\",\"6\":\"0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ncbind(predictions(sepsis.2, newdata = new)) %>% \n  select(estimate, conf.low, conf.high, shock:bowelinf)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"estimate\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.low\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"conf.high\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shock\"],\"name\":[4],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"malnut\"],\"name\":[5],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"alcohol\"],\"name\":[6],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"age\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"bowelinf\"],\"name\":[8],\"type\":[\"fct\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"0.001415347\",\"2\":\"6.272642e-05\",\"3\":\"0.03103047\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"26\",\"8\":\"0\"},{\"1\":\"0.020552383\",\"2\":\"4.102504e-03\",\"3\":\"0.09656596\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"56\",\"8\":\"0\"},{\"1\":\"0.153416834\",\"2\":\"5.606838e-02\",\"3\":\"0.35603441\",\"4\":\"0\",\"5\":\"0\",\"6\":\"0\",\"7\":\"80\",\"8\":\"0\"},{\"1\":\"0.931290137\",\"2\":\"5.490986e-01\",\"3\":\"0.99341482\",\"4\":\"0\",\"5\":\"0\",\"6\":\"1\",\"7\":\"66\",\"8\":\"1\"},{\"1\":\"0.213000997\",\"2\":\"7.639063e-02\",\"3\":\"0.46967947\",\"4\":\"0\",\"5\":\"0\",\"6\":\"1\",\"7\":\"49\",\"8\":\"0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n\n\n## Comments \n\n* Survival chances pretty good if no risk factors, though decreasing with age.\n\n* Having more than one risk factor reduces survival chances dramatically.\n\n* Usually good job of predicting survival; sometimes death predicted to survive.\n\n## Another way to assess effects\n\nof `age`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnew <- datagrid(model = sepsis.2, age = seq(30, 70, 10))\nnew\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"death\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"shock\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"alcohol\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"bowelinf\"],\"name\":[4],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"age\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"30\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"40\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"50\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"60\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"70\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n## Assessing age effect \n\n\n::: {.cell}\n\n```{.r .cell-code}\ncbind(predictions(sepsis.2, newdata = new)) %>% \n  select(estimate, shock:age)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"estimate\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"shock\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"alcohol\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"bowelinf\"],\"name\":[4],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"age\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0.002026053\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"30\"},{\"1\":\"0.004960283\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"40\"},{\"1\":\"0.012092515\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"50\"},{\"1\":\"0.029179226\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"60\"},{\"1\":\"0.068729752\",\"2\":\"0\",\"3\":\"0\",\"4\":\"0\",\"5\":\"70\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Assessing shock effect\n\n\\footnotesize\n\n::: {.cell}\n\n```{.r .cell-code}\nnew <- datagrid(shock = c(0, 1), model = sepsis.2)\nnew\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"death\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"alcohol\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"age\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"bowelinf\"],\"name\":[4],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"shock\"],\"name\":[5],\"type\":[\"fct\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"0\",\"2\":\"0\",\"3\":\"51.28302\",\"4\":\"0\",\"5\":\"0\"},{\"1\":\"0\",\"2\":\"0\",\"3\":\"51.28302\",\"4\":\"0\",\"5\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ncbind(predictions(sepsis.2, newdata = new)) %>% \n  select(estimate, death:shock)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"estimate\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"death\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"alcohol\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"age\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"bowelinf\"],\"name\":[5],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"shock\"],\"name\":[6],\"type\":[\"fct\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"0.01354973\",\"2\":\"0\",\"3\":\"0\",\"4\":\"51.28302\",\"5\":\"0\",\"6\":\"0\"},{\"1\":\"0.35742607\",\"2\":\"0\",\"3\":\"0\",\"4\":\"51.28302\",\"5\":\"0\",\"6\":\"1\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n\n## Assessing proportionality of odds for age\n\n\n* An assumption we made is that log-odds of survival depends\nlinearly on age.\n\n* Hard to get your head around, but \nbasic idea is that survival chances go continuously up (or down)\nwith age, instead of (for example) going up and then down.\n\n* In this case, seems reasonable, but should check:\n\n\n## Residuals vs.\\ age\n\n::: {.cell}\n\n```{.r .cell-code}\nsepsis.2 %>% augment(sepsis) %>% \n  ggplot(aes(x = age, y = .resid)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](logistic_files/figure-revealjs/virtusentella-1.png){width=960}\n:::\n:::\n\n \n## Comments\n\n* No apparent problems overall.\n\n* Confusing \"line\" across: no risk factors, survived. \n\n\n\n## Probability and odds\n\n* For probability $p$, odds is $p/(1-p)$:\n\n\n  \\begin{tabular}{rrrl}\n      \\hline\n      Prob.\\ & Odds & log-odds & in words\\\\\n      \\hline\n      0.5 & $0.5/0.5=1/1=1.00$ & $0.00$ &  ``even money''\\\\\n      0.1 & $0.1/0.9=1/9=0.11$ & $-2.20$ & ``9 to 1''\\\\\n      0.4 & $0.4/0.6=1/1.5=0.67$ & $-0.41$ & ``1.5 to 1''\\\\\n      0.8 & $0.8/0.2=4/1=4.00$ & $1.39$ & ``4 to 1 on''\\\\\n      \\hline\n    \\end{tabular}\n\n\n* Gamblers use odds: if you win at 9 to 1 odds, get original\nstake back plus 9 times the stake.\n\n* Probability has to be between 0 and 1\n\n* Odds between 0 and infinity\n\n* *Log*-odds can be anything: any log-odds corresponds to\nvalid probability.\n\n\n\n## Odds ratio\n\n\n* Suppose 90 of 100 men drank wine last week, but only 20 of 100 women.\n\n* Prob of man drinking wine $90/100=0.9$, woman $20/100=0.2$.\n\n* Odds of man drinking wine $0.9/0.1=9$, woman $0.2/0.8=0.25$.\n\n* Ratio of odds is $9/0.25=36$.\n\n* Way of quantifying difference between men and women: ``odds of\ndrinking wine 36 times larger for males than females''. \n\n\n\n## Sepsis data again\n\n\n* Recall prediction of probability of death from risk factors:\n\n::: {.cell}\n\n```{.r .cell-code}\nsepsis.2.tidy <- tidy(sepsis.2)\nsepsis.2.tidy\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"estimate\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std.error\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"statistic\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"-8.89458992\",\"3\":\"2.31689479\",\"4\":\"-3.839013\",\"5\":\"0.0001235297\"},{\"1\":\"shock1\",\"2\":\"3.70119321\",\"3\":\"1.10353465\",\"4\":\"3.353944\",\"5\":\"0.0007966854\"},{\"1\":\"alcohol1\",\"2\":\"3.18590397\",\"3\":\"0.91724569\",\"4\":\"3.473338\",\"5\":\"0.0005140283\"},{\"1\":\"age\",\"2\":\"0.08983175\",\"3\":\"0.02921528\",\"4\":\"3.074821\",\"5\":\"0.0021062897\"},{\"1\":\"bowelinf1\",\"2\":\"2.38646847\",\"3\":\"1.07226618\",\"4\":\"2.225631\",\"5\":\"0.0260389310\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n     \n\n\n* Slopes in column `estimate`.\n\n\n\n## Multiplying the odds\n\n\n* Can interpret slopes by taking \"exp\" of them. We ignore intercept.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsepsis.2.tidy %>% \n  mutate(exp_coeff=exp(estimate)) %>% \n  select(term, exp_coeff)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"exp_coeff\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"1.371288e-04\"},{\"1\":\"shock1\",\"2\":\"4.049560e+01\"},{\"1\":\"alcohol1\",\"2\":\"2.418914e+01\"},{\"1\":\"age\",\"2\":\"1.093990e+00\"},{\"1\":\"bowelinf1\",\"2\":\"1.087502e+01\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Interpretation\n\n\\small\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"term\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"exp_coeff\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"(Intercept)\",\"2\":\"1.371288e-04\"},{\"1\":\"shock1\",\"2\":\"4.049560e+01\"},{\"1\":\"alcohol1\",\"2\":\"2.418914e+01\"},{\"1\":\"age\",\"2\":\"1.093990e+00\"},{\"1\":\"bowelinf1\",\"2\":\"1.087502e+01\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n\n\n* These say \"how much do you *multiply* odds of death by\nfor increase of 1 in corresponding risk factor?\" Or, what is odds\nratio for that factor being 1 (present) vs.\\ 0 (absent)?\n\n* Eg.\\ being alcoholic vs.\\ not increases odds of death by 24 times\n\n* One year older multiplies odds by about 1.1 times. Over 40 years,\nabout  $1.09^{40}=31$ times. \n\n\n\n## Odds ratio and relative risk\n\n\n* **Relative risk** is ratio of probabilities.\n\n* Above: 90 of 100 men (0.9) drank wine, 20 of 100 women (0.2).\n\n* Relative risk 0.9/0.2=4.5. (odds ratio was 36).\n\n* When probabilities small, relative risk and odds ratio similar.\n\n* Eg.\\ prob of man having disease 0.02, woman 0.01.\n\n* Relative risk $0.02/0.01=2$.\n\n## Odds ratio vs.\\ relative risk\n\n- Odds for men and for women:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(od1 <- 0.02 / 0.98) # men\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.02040816\n```\n:::\n\n```{.r .cell-code}\n(od2 <- 0.01 / 0.99) # women\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.01010101\n```\n:::\n:::\n\n\n-  Odds ratio \n\n\n::: {.cell}\n\n```{.r .cell-code}\nod1 / od2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.020408\n```\n:::\n:::\n\n\n\n- Very close to relative risk of 2.\n\n\n## More than 2 response categories\n\n\n* With 2 response categories, model the probability of one, and prob of other is one minus that. So doesn't matter which category you model.\n\n* With more than 2 categories, have to think more carefully about the categories: are they\n\n\n* *ordered*: you can put them in a natural order (like low, medium, high)\n\n* *nominal*: ordering the categories doesn't make sense (like red, green, blue).\n\n\n* R handles both kinds of response; learn how.\n\n\n\n## Ordinal response: the miners\n\n\n* \nModel probability of being in given category *or lower*.\n\n* Example: coal-miners often suffer disease pneumoconiosis. Likelihood of disease believed to be greater \namong miners who have worked longer. \n\n* Severity of disease measured on categorical scale: none,\nmoderate, severe.\n\n## Miners data\n\n* Data are frequencies:\n\n```\nExposure None Moderate Severe\n5.8       98      0       0\n15.0      51      2       1\n21.5      34      6       3\n27.5      35      5       8\n33.5      32     10       9\n39.5      23      7       8\n46.0      12      6      10\n51.5       4      2       5\n```\n\n\n\n\n## Reading the data\n\nData in aligned columns with more than one space between, so: \n\n\\small\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/miners-tab.txt\"\nfreqs <- read_table(my_url)\n```\n:::\n\n\\normalsize\n\n\n## The data\n\n::: {.cell}\n\n```{.r .cell-code}\nfreqs\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Exposure\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"None\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Moderate\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Severe\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"5.8\",\"2\":\"98\",\"3\":\"0\",\"4\":\"0\"},{\"1\":\"15.0\",\"2\":\"51\",\"3\":\"2\",\"4\":\"1\"},{\"1\":\"21.5\",\"2\":\"34\",\"3\":\"6\",\"4\":\"3\"},{\"1\":\"27.5\",\"2\":\"35\",\"3\":\"5\",\"4\":\"8\"},{\"1\":\"33.5\",\"2\":\"32\",\"3\":\"10\",\"4\":\"9\"},{\"1\":\"39.5\",\"2\":\"23\",\"3\":\"7\",\"4\":\"8\"},{\"1\":\"46.0\",\"2\":\"12\",\"3\":\"6\",\"4\":\"10\"},{\"1\":\"51.5\",\"2\":\"4\",\"3\":\"2\",\"4\":\"5\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n   \n\n\n## Tidying \n\n::: {.cell}\n\n```{.r .cell-code}\nfreqs %>%\n  pivot_longer(-Exposure, names_to = \"Severity\", values_to = \"Freq\") %>%\n  mutate(Severity = fct_inorder(Severity)) -> miners\n```\n:::\n\n\n   \n\n\n## Result\n\n\\tiny\n\n::: {.cell}\n\n```{.r .cell-code}\nminers\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Exposure\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Severity\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"Freq\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"5.8\",\"2\":\"None\",\"3\":\"98\"},{\"1\":\"5.8\",\"2\":\"Moderate\",\"3\":\"0\"},{\"1\":\"5.8\",\"2\":\"Severe\",\"3\":\"0\"},{\"1\":\"15.0\",\"2\":\"None\",\"3\":\"51\"},{\"1\":\"15.0\",\"2\":\"Moderate\",\"3\":\"2\"},{\"1\":\"15.0\",\"2\":\"Severe\",\"3\":\"1\"},{\"1\":\"21.5\",\"2\":\"None\",\"3\":\"34\"},{\"1\":\"21.5\",\"2\":\"Moderate\",\"3\":\"6\"},{\"1\":\"21.5\",\"2\":\"Severe\",\"3\":\"3\"},{\"1\":\"27.5\",\"2\":\"None\",\"3\":\"35\"},{\"1\":\"27.5\",\"2\":\"Moderate\",\"3\":\"5\"},{\"1\":\"27.5\",\"2\":\"Severe\",\"3\":\"8\"},{\"1\":\"33.5\",\"2\":\"None\",\"3\":\"32\"},{\"1\":\"33.5\",\"2\":\"Moderate\",\"3\":\"10\"},{\"1\":\"33.5\",\"2\":\"Severe\",\"3\":\"9\"},{\"1\":\"39.5\",\"2\":\"None\",\"3\":\"23\"},{\"1\":\"39.5\",\"2\":\"Moderate\",\"3\":\"7\"},{\"1\":\"39.5\",\"2\":\"Severe\",\"3\":\"8\"},{\"1\":\"46.0\",\"2\":\"None\",\"3\":\"12\"},{\"1\":\"46.0\",\"2\":\"Moderate\",\"3\":\"6\"},{\"1\":\"46.0\",\"2\":\"Severe\",\"3\":\"10\"},{\"1\":\"51.5\",\"2\":\"None\",\"3\":\"4\"},{\"1\":\"51.5\",\"2\":\"Moderate\",\"3\":\"2\"},{\"1\":\"51.5\",\"2\":\"Severe\",\"3\":\"5\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n     \n\n\n## Plot proportions against exposure\n\n\\small\n\n::: {.cell}\n\n```{.r .cell-code}\nminers %>% \n  group_by(Exposure) %>% \n  mutate(proportion = Freq / sum(Freq)) -> prop\nggplot(prop, aes(x = Exposure, y = proportion,\n                   colour = Severity)) + \n  geom_point() + geom_smooth(se = F)\n```\n\n::: {.cell-output-display}\n![](logistic_files/figure-revealjs/bLogistic-28-1.png){width=960}\n:::\n:::\n\n\\normalsize\n\n\n## Reminder of data setup\n\\footnotesize\n\n::: {.cell}\n\n```{.r .cell-code}\nminers\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Exposure\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Severity\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"Freq\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"5.8\",\"2\":\"None\",\"3\":\"98\"},{\"1\":\"5.8\",\"2\":\"Moderate\",\"3\":\"0\"},{\"1\":\"5.8\",\"2\":\"Severe\",\"3\":\"0\"},{\"1\":\"15.0\",\"2\":\"None\",\"3\":\"51\"},{\"1\":\"15.0\",\"2\":\"Moderate\",\"3\":\"2\"},{\"1\":\"15.0\",\"2\":\"Severe\",\"3\":\"1\"},{\"1\":\"21.5\",\"2\":\"None\",\"3\":\"34\"},{\"1\":\"21.5\",\"2\":\"Moderate\",\"3\":\"6\"},{\"1\":\"21.5\",\"2\":\"Severe\",\"3\":\"3\"},{\"1\":\"27.5\",\"2\":\"None\",\"3\":\"35\"},{\"1\":\"27.5\",\"2\":\"Moderate\",\"3\":\"5\"},{\"1\":\"27.5\",\"2\":\"Severe\",\"3\":\"8\"},{\"1\":\"33.5\",\"2\":\"None\",\"3\":\"32\"},{\"1\":\"33.5\",\"2\":\"Moderate\",\"3\":\"10\"},{\"1\":\"33.5\",\"2\":\"Severe\",\"3\":\"9\"},{\"1\":\"39.5\",\"2\":\"None\",\"3\":\"23\"},{\"1\":\"39.5\",\"2\":\"Moderate\",\"3\":\"7\"},{\"1\":\"39.5\",\"2\":\"Severe\",\"3\":\"8\"},{\"1\":\"46.0\",\"2\":\"None\",\"3\":\"12\"},{\"1\":\"46.0\",\"2\":\"Moderate\",\"3\":\"6\"},{\"1\":\"46.0\",\"2\":\"Severe\",\"3\":\"10\"},{\"1\":\"51.5\",\"2\":\"None\",\"3\":\"4\"},{\"1\":\"51.5\",\"2\":\"Moderate\",\"3\":\"2\"},{\"1\":\"51.5\",\"2\":\"Severe\",\"3\":\"5\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n   \n\\normalsize\n\n\n\n## Fitting ordered logistic model\n\nUse function `polr` from package `MASS`. Like `glm`.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsev.1 <- polr(Severity ~ Exposure,\n  weights = Freq,\n  data = miners\n)\n```\n:::\n\n \n\n\n## Output: not very illuminating\n\n\n\\scriptsize\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsev.1 <- polr(Severity ~ Exposure,\n  weights = Freq,\n  data = miners,\n  Hess = TRUE\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(sev.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\npolr(formula = Severity ~ Exposure, data = miners, weights = Freq, \n    Hess = TRUE)\n\nCoefficients:\n          Value Std. Error t value\nExposure 0.0959    0.01194   8.034\n\nIntercepts:\n                Value   Std. Error t value\nNone|Moderate    3.9558  0.4097     9.6558\nModerate|Severe  4.8690  0.4411    11.0383\n\nResidual Deviance: 416.9188 \nAIC: 422.9188 \n```\n:::\n:::\n\n\\normalsize\n   \n\n## Does exposure have an effect?\nFit model without `Exposure`, and compare\nusing `anova`. Note `1` for model with just intercept:\n\n\n::: {.cell}\n\n:::\n\n\n \n\n\\small\n\n::: {.cell}\n\n```{.r .cell-code}\nsev.0 <- polr(Severity ~ 1, weights = Freq, data = miners)\nanova(sev.0, sev.1)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Model\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Resid. df\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Resid. Dev\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Test\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"   Df\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"LR stat.\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(Chi)\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"369\",\"3\":\"505.1621\",\"4\":\"\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\"},{\"1\":\"Exposure\",\"2\":\"368\",\"3\":\"416.9188\",\"4\":\"1 vs 2\",\"5\":\"1\",\"6\":\"88.24324\",\"7\":\"0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n\nExposure definitely has effect on severity of disease. \n\n\n## Another way\n\n\n* What (if anything) can we drop from model with `exposure`?\n\n::: {.cell}\n\n```{.r .cell-code}\ndrop1(sev.1, test = \"Chisq\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Df\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"AIC\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"LRT\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(>Chi)\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"NA\",\"2\":\"422.9188\",\"3\":\"NA\",\"4\":\"NA\",\"_rn_\":\"<none>\"},{\"1\":\"1\",\"2\":\"509.1621\",\"3\":\"88.24324\",\"4\":\"5.788085e-21\",\"_rn_\":\"Exposure\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n     \n\n\n* Nothing. Exposure definitely has effect.\n\n\n\n## Predicted probabilities 1/2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfreqs %>% select(Exposure) -> new\nnew\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Exposure\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"5.8\"},{\"1\":\"15.0\"},{\"1\":\"21.5\"},{\"1\":\"27.5\"},{\"1\":\"33.5\"},{\"1\":\"39.5\"},{\"1\":\"46.0\"},{\"1\":\"51.5\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n## Predicted probabilities 2/2\n\n\\small\n\n::: {.cell}\n\n```{.r .cell-code}\ncbind(predictions(sev.1, newdata = new)) %>%\n  select(group, estimate, Exposure) %>% \n  pivot_wider(names_from = group, values_from = estimate)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Exposure\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"None\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Moderate\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Severe\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"5.8\",\"2\":\"0.9676920\",\"3\":\"0.01908912\",\"4\":\"0.01321885\"},{\"1\":\"15.0\",\"2\":\"0.9253445\",\"3\":\"0.04329931\",\"4\":\"0.03135614\"},{\"1\":\"21.5\",\"2\":\"0.8692003\",\"3\":\"0.07385858\",\"4\":\"0.05694115\"},{\"1\":\"27.5\",\"2\":\"0.7889290\",\"3\":\"0.11413004\",\"4\":\"0.09694093\"},{\"1\":\"33.5\",\"2\":\"0.6776641\",\"3\":\"0.16207145\",\"4\":\"0.16026444\"},{\"1\":\"39.5\",\"2\":\"0.5418105\",\"3\":\"0.20484198\",\"4\":\"0.25334756\"},{\"1\":\"46.0\",\"2\":\"0.3879962\",\"3\":\"0.22441555\",\"4\":\"0.38758828\"},{\"1\":\"51.5\",\"2\":\"0.2722543\",\"3\":\"0.21025011\",\"4\":\"0.51749563\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n\n## Plot of predicted probabilities\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_cap(model = sev.1, condition = c(\"Exposure\", \"group\"),\n         type = \"probs\") +\n  geom_point(data = prop, aes(x = Exposure, y = proportion, \n                              colour = Severity)) -> ggg\n```\n:::\n\n\n## The graph\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggg\n```\n\n::: {.cell-output-display}\n![](logistic_files/figure-revealjs/unnamed-chunk-11-1.png){width=960}\n:::\n:::\n\n\n\n## Comments\n\n\n* Model appears to match data well enough.\n\n- As exposure goes up, prob of None\ngoes down, Severe goes up (sharply for high exposure).\n\n- So more exposure means worse disease.\n\n\n## Unordered responses\n\n\n* With unordered (nominal) responses, can use *generalized logit*.\n\n* Example: 735 people, record age and sex (male 0, female 1), which of 3 brands of some product preferred.\n\n* Data in `mlogit.csv` separated by commas (so\n`read_csv` will work):\n\n::: {.cell}\n\n```{.r .cell-code}\nmy_url <- \"http://ritsokiguess.site/datafiles/mlogit.csv\"\nbrandpref <- read_csv(my_url)\n```\n:::\n\n \n\n\n\n\n## The data (some)\n\n::: {.cell}\n\n```{.r .cell-code}\nbrandpref\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"brand\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sex\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"age\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"0\",\"3\":\"24\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"26\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"26\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"27\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"27\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"27\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"27\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"27\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"27\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"27\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"27\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"27\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"28\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"28\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"28\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"28\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"29\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"29\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"29\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"29\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"29\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"29\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"30\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"30\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"30\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"30\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"30\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"30\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"30\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"30\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"30\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"31\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"31\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"31\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"33\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"35\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"35\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"35\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"37\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"37\"},{\"1\":\"1\",\"2\":\"0\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"37\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"37\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"37\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"37\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"37\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"37\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"38\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"38\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"38\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"38\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"38\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"38\"},{\"1\":\"2\",\"2\":\"0\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"38\"},{\"1\":\"2\",\"2\":\"1\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"0\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"1\",\"3\":\"38\"},{\"1\":\"1\",\"2\":\"1\",\"3\":\"38\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n   \n\n\n## Bashing into shape\n\n\n* `sex` and `brand` not meaningful as numbers, so\nturn into factors:\n\n::: {.cell}\n\n```{.r .cell-code}\nbrandpref %>%\n  mutate(sex = ifelse(sex == 1, \"female\", \"male\"), \n         sex = factor(sex),\n         brand = factor(brand)\n         ) -> brandpref\n```\n:::\n\n \n \n## Fitting model \n\n* We use `multinom` from package `nnet`. Works\nlike `polr`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbrands.1 <- multinom(brand ~ age + sex, data = brandpref)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# weights:  12 (6 variable)\ninitial  value 807.480032 \niter  10 value 702.990572\nfinal  value 702.970704 \nconverged\n```\n:::\n:::\n\n \n\n\n## Can we drop anything?\n\n\n* Unfortunately `drop1` seems not to work:\n\n::: {.cell}\n\n```{.r .cell-code}\ndrop1(brands.1, test = \"Chisq\", trace = 0)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntrying - age \n```\n:::\n\n::: {.cell-output .cell-output-error}\n```\nError in if (trace) {: argument is not interpretable as logical\n```\n:::\n:::\n\n\n* So, fall back on fitting model without what you want to test, and\ncomparing using `anova`.    \n\n\n\n## Do age/sex help predict brand? 1/3\n\nFit models without each of age and sex:\n\n::: {.cell}\n\n```{.r .cell-code}\nbrands.2 <- multinom(brand ~ age, data = brandpref)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# weights:  9 (4 variable)\ninitial  value 807.480032 \niter  10 value 706.796323\niter  10 value 706.796322\nfinal  value 706.796322 \nconverged\n```\n:::\n\n```{.r .cell-code}\nbrands.3 <- multinom(brand ~ sex, data = brandpref)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# weights:  9 (4 variable)\ninitial  value 807.480032 \nfinal  value 791.861266 \nconverged\n```\n:::\n:::\n\n \n\n\n## Do age/sex help predict brand? 2/3\n\n\\scriptsize\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(brands.2, brands.1)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Model\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Resid. df\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Resid. Dev\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Test\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"   Df\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"LR stat.\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(Chi)\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"age\",\"2\":\"1466\",\"3\":\"1413.593\",\"4\":\"\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\"},{\"1\":\"age + sex\",\"2\":\"1464\",\"3\":\"1405.941\",\"4\":\"1 vs 2\",\"5\":\"2\",\"6\":\"7.651236\",\"7\":\"0.02180496\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nanova(brands.3, brands.1)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Model\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Resid. df\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Resid. Dev\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Test\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"   Df\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"LR stat.\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(Chi)\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"sex\",\"2\":\"1466\",\"3\":\"1583.723\",\"4\":\"\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\"},{\"1\":\"age + sex\",\"2\":\"1464\",\"3\":\"1405.941\",\"4\":\"1 vs 2\",\"5\":\"2\",\"6\":\"177.7811\",\"7\":\"0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n\n\n## Do age/sex help predict brand? 3/3\n\n\n* `age` definitely significant (second `anova`)\n\n* `sex` significant also (first `anova`), though P-value less dramatic\n\n* Keep both.\n- Expect to see a large effect of `age`, and a smaller one of `sex`.\n\n\n\n\n## Another way to build model\n\n\n* Start from model with everything and run `step`:\n\n\n::: {.cell}\n\n:::\n\n\n\n\\footnotesize\n\n::: {.cell}\n\n```{.r .cell-code}\nstep(brands.1, trace = 0)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntrying - age \ntrying - sex \n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\nmultinom(formula = brand ~ age + sex)\n\nCoefficients:\n  (Intercept)       age    sexmale\n2   -11.25127 0.3682202 -0.5237736\n3   -22.25571 0.6859149 -0.4658215\n\nResidual Deviance: 1405.941 \nAIC: 1417.941 \n```\n:::\n:::\n\n\\normalsize\n     \n\n* Final model contains both `age` and `sex` so neither\ncould be removed.\n\n\n## Making predictions\n\nFind age 5-number summary, and the two sexes:\n\n\\small\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(brandpref)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n brand       sex           age      \n 1:207   female:466   Min.   :24.0  \n 2:307   male  :269   1st Qu.:32.0  \n 3:221                Median :32.0  \n                      Mean   :32.9  \n                      3rd Qu.:34.0  \n                      Max.   :38.0  \n```\n:::\n:::\n\n\nSpace the ages out a bit for prediction (see over).\n\n\\normalsize\n\n## Combinations\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnew <- datagrid(age = c(24, 30, 33, 35, 38), \n                sex = c(\"female\", \"male\"), model = brands.1)\nnew\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"brand\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"age\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sex\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"2\",\"2\":\"24\",\"3\":\"female\"},{\"1\":\"2\",\"2\":\"24\",\"3\":\"male\"},{\"1\":\"2\",\"2\":\"30\",\"3\":\"female\"},{\"1\":\"2\",\"2\":\"30\",\"3\":\"male\"},{\"1\":\"2\",\"2\":\"33\",\"3\":\"female\"},{\"1\":\"2\",\"2\":\"33\",\"3\":\"male\"},{\"1\":\"2\",\"2\":\"35\",\"3\":\"female\"},{\"1\":\"2\",\"2\":\"35\",\"3\":\"male\"},{\"1\":\"2\",\"2\":\"38\",\"3\":\"female\"},{\"1\":\"2\",\"2\":\"38\",\"3\":\"male\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## The predictions\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncbind(predictions(brands.1, newdata = new)) %>%\n  select(group, estimate, age, sex) %>% \n  pivot_wider(names_from = group, values_from = estimate)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"age\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sex\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"1\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"3\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"24\",\"2\":\"female\",\"3\":\"0.91532807\",\"4\":\"0.08188336\",\"5\":\"0.002788568\"},{\"1\":\"24\",\"2\":\"male\",\"3\":\"0.94796046\",\"4\":\"0.05022698\",\"5\":\"0.001812554\"},{\"1\":\"30\",\"2\":\"female\",\"3\":\"0.49959594\",\"4\":\"0.40713072\",\"5\":\"0.093273340\"},{\"1\":\"30\",\"2\":\"male\",\"3\":\"0.62506374\",\"4\":\"0.30169442\",\"5\":\"0.073241835\"},{\"1\":\"33\",\"2\":\"female\",\"3\":\"0.20320598\",\"4\":\"0.49980374\",\"5\":\"0.296990276\"},{\"1\":\"33\",\"2\":\"male\",\"3\":\"0.29637970\",\"4\":\"0.43175707\",\"5\":\"0.271863230\"},{\"1\":\"35\",\"2\":\"female\",\"3\":\"0.08404090\",\"4\":\"0.43170366\",\"5\":\"0.484255439\"},{\"1\":\"35\",\"2\":\"male\",\"3\":\"0.13056744\",\"4\":\"0.39724453\",\"5\":\"0.472188037\"},{\"1\":\"38\",\"2\":\"female\",\"3\":\"0.01623068\",\"4\":\"0.25164012\",\"5\":\"0.732129199\"},{\"1\":\"38\",\"2\":\"male\",\"3\":\"0.02597862\",\"4\":\"0.23855424\",\"5\":\"0.735467140\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n## Comments\n\n* Young males prefer brand 1, \nbut older males prefer brand 3.\n\n* Females similar, but like brand 1 less and\nbrand 2 more.\n\n- A clear `brand` effect, but the `sex` effect is less clear. \n\n## Making a plot\n\n- `plot_cap` doesn't quite work\n- so don't draw, edit, *then* make graph:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_cap(brands.1, condition = c(\"age\", \"brand\", \"sex\"), \n         type = \"probs\", draw = FALSE)  %>% \n  ggplot(aes(x = age, y = estimate, colour = group, \n             linetype = sex)) +\n  geom_line() -> g\n```\n:::\n\n\n## The graph\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng\n```\n\n::: {.cell-output-display}\n![](logistic_files/figure-revealjs/unnamed-chunk-16-1.png){width=960}\n:::\n:::\n\n  \n\n## Digesting the plot\n\n\n* Brand vs.\\ age: younger people (of both genders) prefer brand\n1, but older people (of both genders) prefer brand 3. (Explains\nsignificant age effect.)\n\n* Brand vs.\\ sex: females (solid) like brand 1 less than males\n(dashed), like brand 2 more (for all ages). \n\n* Not much brand difference between genders (solid and dashed\nlines of same colours close), but enough to be significant.\n\n* Model didn't include interaction, so modelled effect of gender\non brand same for each age, modelled effect of age same for each\ngender. (See also later.) \n\n\n## Alternative data format\n\nSummarize all people of same brand preference, same sex, same age on one line of data file with frequency on end:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbrandpref\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"brand\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"sex\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"age\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"male\",\"3\":\"24\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"26\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"26\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"27\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"27\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"27\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"27\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"27\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"27\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"27\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"27\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"27\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"28\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"28\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"28\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"28\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"28\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"29\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"29\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"29\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"29\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"29\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"29\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"29\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"30\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"30\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"30\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"30\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"30\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"30\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"30\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"30\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"30\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"30\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"31\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"31\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"31\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"31\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"32\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"32\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"33\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"33\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"34\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"35\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"35\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"35\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"35\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"36\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"37\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"37\"},{\"1\":\"1\",\"2\":\"male\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"37\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"37\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"37\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"37\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"37\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"37\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"37\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"38\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"38\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"38\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"38\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"38\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"38\"},{\"1\":\"2\",\"2\":\"male\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"38\"},{\"1\":\"2\",\"2\":\"female\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"male\",\"3\":\"38\"},{\"1\":\"3\",\"2\":\"female\",\"3\":\"38\"},{\"1\":\"1\",\"2\":\"female\",\"3\":\"38\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n```\n1 0 24 1\n1 0 26 2\n1 0 27 4\n1 0 28 4\n1 0 29 7\n1 0 30 3\n...\n```\n\nWhole data set in 65 lines not 735! But how?\n\n\n## Getting alternative data format\n\n::: {.cell}\n\n```{.r .cell-code}\nbrandpref %>%\n  group_by(age, sex, brand) %>%\n  summarize(Freq = n()) %>%\n  ungroup() -> b\nb\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"age\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sex\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"brand\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"Freq\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"24\",\"2\":\"male\",\"3\":\"1\",\"4\":\"1\"},{\"1\":\"26\",\"2\":\"male\",\"3\":\"1\",\"4\":\"2\"},{\"1\":\"27\",\"2\":\"female\",\"3\":\"1\",\"4\":\"4\"},{\"1\":\"27\",\"2\":\"female\",\"3\":\"3\",\"4\":\"1\"},{\"1\":\"27\",\"2\":\"male\",\"3\":\"1\",\"4\":\"4\"},{\"1\":\"28\",\"2\":\"female\",\"3\":\"1\",\"4\":\"6\"},{\"1\":\"28\",\"2\":\"female\",\"3\":\"2\",\"4\":\"2\"},{\"1\":\"28\",\"2\":\"female\",\"3\":\"3\",\"4\":\"1\"},{\"1\":\"28\",\"2\":\"male\",\"3\":\"1\",\"4\":\"4\"},{\"1\":\"28\",\"2\":\"male\",\"3\":\"3\",\"4\":\"2\"},{\"1\":\"29\",\"2\":\"female\",\"3\":\"1\",\"4\":\"7\"},{\"1\":\"29\",\"2\":\"female\",\"3\":\"2\",\"4\":\"4\"},{\"1\":\"29\",\"2\":\"male\",\"3\":\"1\",\"4\":\"7\"},{\"1\":\"29\",\"2\":\"male\",\"3\":\"2\",\"4\":\"1\"},{\"1\":\"30\",\"2\":\"female\",\"3\":\"1\",\"4\":\"10\"},{\"1\":\"30\",\"2\":\"female\",\"3\":\"2\",\"4\":\"4\"},{\"1\":\"30\",\"2\":\"female\",\"3\":\"3\",\"4\":\"3\"},{\"1\":\"30\",\"2\":\"male\",\"3\":\"1\",\"4\":\"3\"},{\"1\":\"30\",\"2\":\"male\",\"3\":\"2\",\"4\":\"2\"},{\"1\":\"30\",\"2\":\"male\",\"3\":\"3\",\"4\":\"1\"},{\"1\":\"31\",\"2\":\"female\",\"3\":\"1\",\"4\":\"9\"},{\"1\":\"31\",\"2\":\"female\",\"3\":\"2\",\"4\":\"9\"},{\"1\":\"31\",\"2\":\"female\",\"3\":\"3\",\"4\":\"5\"},{\"1\":\"31\",\"2\":\"male\",\"3\":\"1\",\"4\":\"10\"},{\"1\":\"31\",\"2\":\"male\",\"3\":\"2\",\"4\":\"5\"},{\"1\":\"31\",\"2\":\"male\",\"3\":\"3\",\"4\":\"2\"},{\"1\":\"32\",\"2\":\"female\",\"3\":\"1\",\"4\":\"62\"},{\"1\":\"32\",\"2\":\"female\",\"3\":\"2\",\"4\":\"117\"},{\"1\":\"32\",\"2\":\"female\",\"3\":\"3\",\"4\":\"36\"},{\"1\":\"32\",\"2\":\"male\",\"3\":\"1\",\"4\":\"48\"},{\"1\":\"32\",\"2\":\"male\",\"3\":\"2\",\"4\":\"51\"},{\"1\":\"32\",\"2\":\"male\",\"3\":\"3\",\"4\":\"19\"},{\"1\":\"33\",\"2\":\"female\",\"3\":\"1\",\"4\":\"3\"},{\"1\":\"33\",\"2\":\"female\",\"3\":\"2\",\"4\":\"23\"},{\"1\":\"33\",\"2\":\"female\",\"3\":\"3\",\"4\":\"10\"},{\"1\":\"33\",\"2\":\"male\",\"3\":\"1\",\"4\":\"4\"},{\"1\":\"33\",\"2\":\"male\",\"3\":\"2\",\"4\":\"9\"},{\"1\":\"33\",\"2\":\"male\",\"3\":\"3\",\"4\":\"6\"},{\"1\":\"34\",\"2\":\"female\",\"3\":\"1\",\"4\":\"6\"},{\"1\":\"34\",\"2\":\"female\",\"3\":\"2\",\"4\":\"16\"},{\"1\":\"34\",\"2\":\"female\",\"3\":\"3\",\"4\":\"18\"},{\"1\":\"34\",\"2\":\"male\",\"3\":\"1\",\"4\":\"4\"},{\"1\":\"34\",\"2\":\"male\",\"3\":\"2\",\"4\":\"13\"},{\"1\":\"34\",\"2\":\"male\",\"3\":\"3\",\"4\":\"7\"},{\"1\":\"35\",\"2\":\"female\",\"3\":\"1\",\"4\":\"1\"},{\"1\":\"35\",\"2\":\"female\",\"3\":\"2\",\"4\":\"6\"},{\"1\":\"35\",\"2\":\"female\",\"3\":\"3\",\"4\":\"17\"},{\"1\":\"35\",\"2\":\"male\",\"3\":\"2\",\"4\":\"2\"},{\"1\":\"35\",\"2\":\"male\",\"3\":\"3\",\"4\":\"9\"},{\"1\":\"36\",\"2\":\"female\",\"3\":\"1\",\"4\":\"6\"},{\"1\":\"36\",\"2\":\"female\",\"3\":\"2\",\"4\":\"19\"},{\"1\":\"36\",\"2\":\"female\",\"3\":\"3\",\"4\":\"30\"},{\"1\":\"36\",\"2\":\"male\",\"3\":\"1\",\"4\":\"4\"},{\"1\":\"36\",\"2\":\"male\",\"3\":\"2\",\"4\":\"10\"},{\"1\":\"36\",\"2\":\"male\",\"3\":\"3\",\"4\":\"16\"},{\"1\":\"37\",\"2\":\"female\",\"3\":\"2\",\"4\":\"5\"},{\"1\":\"37\",\"2\":\"female\",\"3\":\"3\",\"4\":\"12\"},{\"1\":\"37\",\"2\":\"male\",\"3\":\"1\",\"4\":\"1\"},{\"1\":\"37\",\"2\":\"male\",\"3\":\"2\",\"4\":\"1\"},{\"1\":\"37\",\"2\":\"male\",\"3\":\"3\",\"4\":\"3\"},{\"1\":\"38\",\"2\":\"female\",\"3\":\"1\",\"4\":\"1\"},{\"1\":\"38\",\"2\":\"female\",\"3\":\"2\",\"4\":\"3\"},{\"1\":\"38\",\"2\":\"female\",\"3\":\"3\",\"4\":\"10\"},{\"1\":\"38\",\"2\":\"male\",\"3\":\"2\",\"4\":\"5\"},{\"1\":\"38\",\"2\":\"male\",\"3\":\"3\",\"4\":\"13\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n   \n\n## Fitting models, almost the same\n\n\n* Just have to remember `weights` to incorporate\nfrequencies.\n\n* Otherwise `multinom` assumes you have just 1 obs\non each line!\n\n* Again turn (numerical) `sex` and `brand` into factors:\n\n\\footnotesize\n\n::: {.cell}\n\n```{.r .cell-code}\nb %>%\n  mutate(sex = factor(sex)) %>%\n  mutate(brand = factor(brand)) -> bf\nb.1 <- multinom(brand ~ age + sex, data = bf, weights = Freq)\nb.2 <- multinom(brand ~ age, data = bf, weights = Freq)\n```\n:::\n\n\\normalsize\n\n\n\n## P-value for `sex` identical\n\n\\footnotesize\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(b.2, b.1)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Model\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Resid. df\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Resid. Dev\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Test\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"   Df\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"LR stat.\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(Chi)\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"age\",\"2\":\"126\",\"3\":\"1413.593\",\"4\":\"\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\"},{\"1\":\"age + sex\",\"2\":\"124\",\"3\":\"1405.941\",\"4\":\"1 vs 2\",\"5\":\"2\",\"6\":\"7.651236\",\"7\":\"0.02180496\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\\normalsize\n\nSame P-value as before, so we haven't changed anything important.\n\n\n\n\n## Trying interaction between age and gender\n\n\n::: {.cell}\n\n:::\n\n\n   \n\\scriptsize\n\n::: {.cell}\n\n```{.r .cell-code}\nbrands.4 <- update(brands.1, . ~ . + age:sex)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# weights:  15 (8 variable)\ninitial  value 807.480032 \niter  10 value 703.191146\niter  20 value 702.572260\niter  30 value 702.570900\niter  30 value 702.570893\niter  30 value 702.570893\nfinal  value 702.570893 \nconverged\n```\n:::\n\n```{.r .cell-code}\nanova(brands.1, brands.4)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"Model\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"Resid. df\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Resid. Dev\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Test\"],\"name\":[4],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"   Df\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"LR stat.\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Pr(Chi)\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"age + sex\",\"2\":\"1464\",\"3\":\"1405.941\",\"4\":\"\",\"5\":\"NA\",\"6\":\"NA\",\"7\":\"NA\"},{\"1\":\"age + sex + age:sex\",\"2\":\"1462\",\"3\":\"1405.142\",\"4\":\"1 vs 2\",\"5\":\"2\",\"6\":\"0.7996223\",\"7\":\"0.6704466\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n   \n\\normalsize\n\n* No evidence that effect of age on brand preference differs for\nthe two genders.\n\n## Make graph again\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_cap(brands.4, condition = c(\"age\", \"brand\", \"sex\"), \n         type = \"probs\", draw = FALSE)  %>% \n  ggplot(aes(x = age, y = estimate, colour = group, \n             linetype = sex)) +\n  geom_line() -> g4\n```\n:::\n\n\n\n## Not much difference in the graph\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng4\n```\n\n::: {.cell-output-display}\n![](logistic_files/figure-revealjs/unnamed-chunk-19-1.png){width=960}\n:::\n:::\n\n\n## Compare model without interaction\n\n\n::: {.cell}\n\n```{.r .cell-code}\ng\n```\n\n::: {.cell-output-display}\n![](logistic_files/figure-revealjs/unnamed-chunk-20-1.png){width=960}\n:::\n:::\n",
    "supporting": [
      "logistic_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"logistic_files/libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"logistic_files/libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}